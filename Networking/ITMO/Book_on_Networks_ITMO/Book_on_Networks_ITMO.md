<h1 id="muc-luc">Mục lục</h1>

## [Phần I: Cơ bản về mạng truyền dữ liệu](#phan-i-co-ban-ve-mang-truyen-du-lieu)
- [Chương 1: Sự phát triển của mạng máy tính](#chuong-1-su-phat-trien-cua-mang-may-tinh)
- [Chương 2: Các nguyên tắc chung trong xây dựng mạng](#chuong-2-cac-nguyen-tac-chung-trong-xay-dung-mang)
- [Chương 3: Chuyển mạch kênh và chuyển mạch gói](#chuong-3-chuyen-mach-kenh-va-chuyen-mach-goi)
- [Chương 4: Chuẩn hóa và phân loại mạng](#chuong-4-chuan-hoa-va-phan-loai-mang)
- [Chương 5: Các đặc tính mạng và chất lượng dịch vụ](#chuong-5-cac-dac-tinh-mang-va-chat-luong-dich-vu)
- [Câu hỏi cho Phần I](#cau-hoi-cho-phan-i)

## [Phần II: Công nghệ tầng vật lý](#phan-ii-cong-nghe-tang-vat-ly)
- [Chương 6: Đường truyền](#chuong-6-duong-truyen)
- [Chương 7: Mã hóa và ghép kênh dữ liệu](#chuong-7-ma-hoa-va-ghep-kenh-du-lieu)
- [Chương 8: Công nghệ mạng sơ cấp PDH và SDH](#chuong-8-cong-nghe-mang-so-cap-pdh-va-sdh)
- [Chương 9: Công nghệ mạng sơ cấp DWDM và OTN](#chuong-9-cong-nghe-mang-so-cap-dwdm-va-otn)
- [Câu hỏi cho Phần II](#cau-hoi-cho-phan-ii)

## [Phần III: Công nghệ Ethernet](#phan-iii-cong-nghe-ethernet)
- [Chương 10: Ethernet trong mạng cục bộ](#chuong-10-ethernet-trong-mang-cuc-bo)
- [Chương 11: Khả năng chịu lỗi và mạng cục bộ ảo](#chuong-11-kha-nang-chiu-loi-va-mang-cuc-bo-ao)
- [Chương 12: Ethernet cấp nhà mạng](#chuong-12-ethernet-cap-nha-mang)
- [Câu hỏi cho Phần III](#cau-hoi-cho-phan-iii)

## [Phần IV: Mạng TCP/IP](#phan-iv-mang-tcpip)
- [Chương 13: Định tuyến trong giao thức TCP/IP](#chuong-13-dinh-tuyen-trong-giao-thuc-tcpip)
- [Chương 14: Giao thức tương tác mạng IP](#chuong-14-giao-thuc-tuong-tac-mang-ip)
- [Chương 15: Giao thức tầng vận chuyển TCP và UDP](#chuong-15-giao-thuc-tang-van-chuyen-tcp-va-udp)
- [Chương 16: Công nghệ ảo hóa và SDN](#chuong-16-cong-nghe-ao-hoa-va-sdn)
- [Chương 17: IPv6 như sự phát triển của ngăn xếp TCP/IP](#chuong-17-ipv6-nhu-su-phat-trien-cua-ngan-xep-tcpip)
- [Câu hỏi cho Phần IV](#cau-hoi-cho-phan-iv)

## [Phần V: Mạng máy tính toàn cầu](#phan-v-mang-may-tinh-toan-cau)
- [Chương 18: Tổ chức và dịch vụ mạng toàn cầu](#chuong-18-to-chuc-va-dich-vu-mang-toan-cau)
- [Chương 19: Công nghệ truyền tải mạng toàn cầu](#chuong-19-cong-nghe-truyen-tai-mang-toan-cau)
- [Chương 20: Công nghệ MPLS](#chuong-20-cong-nghe-mpls)
- [Câu hỏi cho Phần V](#cau-hoi-cho-phan-v)

## [Phần VI: Truyền dữ liệu không dây](#phan-vi-truyen-du-lieu-khong-day)
- [Chương 21: Công nghệ tầng vật lý của mạng không dây](#chuong-21-cong-nghe-tang-vat-ly-cua-mang-khong-day)
- [Chương 22: Mạng cục bộ và cá nhân không dây](#chuong-22-mang-cuc-bo-va-ca-nhan-khong-day)
- [Chương 23: Mạng viễn thông di động](#chuong-23-mang-vien-thong-di-dong)
- [Câu hỏi cho Phần VI](#cau-hoi-cho-phan-vi)

## [Phần VII: Dịch vụ thông tin mạng](#phan-vii-dich-vu-thong-tin-mang)
- [Chương 24: Dịch vụ thông tin của mạng IP](#chuong-24-dich-vu-thong-tin-cua-mang-ip)
- [Chương 25: Dịch vụ quản lý mạng](#chuong-25-dich-vu-quan-ly-mang)
- [Câu hỏi cho Phần VII](#cau-hoi-cho-phan-vii)

## [Phần VIII: Bảo mật mạng máy tính](#phan-viii-bao-mat-mang-may-tinh)
- [Chương 26: Khái niệm và nguyên tắc cơ bản về bảo mật thông tin](#chuong-26-khai-niem-va-nguyen-tac-co-ban-ve-bao-mat-thong-tin)
- [Chương 27: Công nghệ xác thực, ủy quyền và quản lý truy cập](#chuong-27-cong-nghe-xac-thuc-uy-quyen-va-quan-ly-truy-cap)
- [Chương 28: Công nghệ bảo mật dựa trên phân tích lưu lượng](#chuong-28-cong-nghe-bao-mat-dua-tren-phan-tich-luu-luong)
- [Chương 29: Tấn công vào hạ tầng truyền tải](#chuong-29-tan-cong-vao-ha-tang-truyen-tai)
- [Chương 30: Bảo mật mã phần mềm và dịch vụ mạng](#chuong-30-bao-mat-ma-phan-mem-va-dich-vu-mang)
- [Câu hỏi cho Phần VIII](#cau-hoi-cho-phan-viii)

---

# Nội dung

<h2 id="phan-i-co-ban-ve-mang-truyen-du-lieu">Phần I: Cơ bản về mạng truyền dữ liệu</h2>

[Quay lại Mục lục](#muc-luc)

- [x] Chương 1: Sự phát triển của mạng máy tính
- [x] Chương 2: Các nguyên tắc chung trong xây dựng mạng
- [x] Chương 3: Chuyển mạch kênh và chuyển mạch gói
- [x] Chương 4: Chuẩn hóa và phân loại mạng
- [x] Chương 5: Các đặc tính mạng và chất lượng dịch vụ

---

**Quá trình nhận thức luôn phát triển theo hình xoắn ốc.** Chúng ta không thể ngay lập tức hiểu và nhận thức một hiện tượng phức tạp. Chúng ta cần xem xét nó từ nhiều góc độ khác nhau, một cách tổng thể và từng phần, một cách cô lập và trong sự tương tác với các hiện tượng khác. Bằng cách tích lũy kiến thức dần dần, đôi lúc quay trở lại với những gì đã dường như được hiểu rõ, và với mỗi vòng xoắn mới, chúng ta ngày càng thấu hiểu sâu sắc hơn về bản chất của hiện tượng đó. Một cách tiếp cận tốt là bắt đầu bằng việc nghiên cứu các nguyên tắc chung của một lĩnh vực kiến thức nào đó, sau đó mới đi sâu vào các phương pháp, công nghệ hoặc cấu trúc cụ thể. Phần đầu tiên của cuốn sách này được xây dựng như "vòng xoắn đầu tiên" trong việc nghiên cứu các mạng máy tính.

Việc nghiên cứu các nguyên tắc chung trong xây dựng mạng máy tính sẽ giúp bạn dễ dàng nắm bắt các công nghệ mạng cụ thể trong tương lai. Tuy nhiên, câu nói nổi tiếng "Kiến thức về một số nguyên tắc giải phóng bạn khỏi việc ghi nhớ nhiều sự kiện" không nên được hiểu theo nghĩa đen — một chuyên gia giỏi, tất nhiên, cần biết nhiều chi tiết và sự kiện. Tuy nhiên, kiến thức về các nguyên tắc sẽ cho phép hệ thống hóa các dữ liệu riêng lẻ này, liên kết chúng thành một hệ thống mạch lạc và do đó sử dụng chúng một cách có ý thức và hiệu quả hơn. Tất nhiên, việc nghiên cứu các nguyên tắc trước khi tìm hiểu các công nghệ mạng không phải là nhiệm vụ dễ dàng, đặc biệt là đối với những độc giả có tư duy thực tế. Ngoài ra, luôn có nguy cơ hiểu sai một nguyên tắc chung nào đó nếu không được kiểm nghiệm qua thực tiễn. Vì vậy, chúng tôi yêu cầu độc giả tạm thời tin tưởng vào những khẳng định trong cuốn sách này, bởi vì chúng sẽ đáng giá; đồng thời, chúng tôi cũng khuyến khích bạn khi học các phần tiếp theo, hãy dành thời gian để liên hệ với các câu hỏi lý thuyết và kiểm tra lại chính mình, cũng như hiểu những gì bạn đã học lần đầu.

Phần này, cùng với cả cuốn sách, bắt đầu bằng chương giới thiệu về sự phát triển của mạng máy tính. Lịch sử của bất kỳ ngành khoa học nào không chỉ đánh thức sự tò mò tự nhiên mà còn cho phép hiểu rõ hơn bản chất của những thành tựu chính trong lĩnh vực đó, nhận thức xu hướng phát triển và đánh giá triển vọng của những lĩnh vực và hướng nghiên cứu mới.

Trong hai chương tiếp theo, các khái niệm cơ bản của mạng máy tính được xem xét — chuyển mạch, định tuyến, ghép kênh, địa chỉ hóa. Các phương pháp truyền dữ liệu qua các gói — truyền datagram, truyền qua thiết lập kết nối logic và kỹ thuật kênh ảo được nghiên cứu.

Một chủ đề quan trọng của phần này được trình bày trong chương thứ tư, liên quan đến chuẩn hóa kiến trúc mạng máy tính, nền tảng tư tưởng mà mô hình tương tác hệ thống mở (OSI) dựa trên.

Chương cuối cùng của phần này dành riêng cho các đặc tính của mạng và vấn đề chất lượng dịch vụ. Vai trò mới của mạng máy tính như là cơ sở cho việc tạo ra thế hệ tiếp theo của các mạng công cộng, cung cấp nhiều loại dịch vụ thông tin và truyền tải dữ liệu, cũng như lưu lượng âm thanh và video, đã dẫn đến sự thâm nhập của các phương pháp đảm bảo chất lượng dịch vụ vào hầu hết các công nghệ truyền thông. Do đó, các khái niệm về chất lượng dịch vụ, vốn từ lâu đã được coi là một hướng bổ trợ trong ngành mạng, hiện đã trở thành một trong những nguyên tắc cơ bản của xây dựng mạng máy tính.

--- 
<h3 id="chuong-1-su-phat-trien-cua-mang-may-tinh">CHƯƠNG 1: Sự phát triển của mạng máy tính</h3>

#### 1.1 Hai nguồn gốc của mạng máy tính

Mạng máy tính, mà cuốn sách này đề cập đến, không phải là loại mạng duy nhất được tạo ra bởi nền văn minh nhân loại. Thậm chí, các hệ thống dẫn nước của La Mã cổ đại cũng có thể được coi là một trong những ví dụ lâu đời nhất về mạng lưới, bao phủ các khu vực rộng lớn và phục vụ nhiều người dùng. Một ví dụ khác, ít mang tính trực quan hơn, là mạng điện. Trong đó, ta có thể dễ dàng tìm thấy sự tương đồng với các thành phần của bất kỳ mạng máy tính nào: nguồn tài nguyên thông tin tương ứng với các nhà máy điện, các tuyến truyền tải cao áp tương ứng với các đường dây điện cao thế, mạng truy cập tương ứng với các trạm biến áp, và các thiết bị đầu cuối của khách hàng tương ứng với các thiết bị chiếu sáng và gia dụng.

**Mạng máy tính**, còn được gọi là **mạng truyền dữ liệu**, là kết quả logic của sự phát triển từ hai ngành khoa học công nghệ quan trọng của nền văn minh hiện đại: **kỹ thuật tính toán** và **công nghệ viễn thông**.

Một mặt, mạng máy tính là một nhóm các máy tính được kết nối với nhau để giải quyết một tập hợp các nhiệm vụ liên quan, trao đổi dữ liệu tự động theo chế độ hoạt động nhất định. Mặt khác, mạng máy tính có thể được xem như một phương tiện truyền tải thông tin ở quy mô lớn, sử dụng các kỹ thuật mã hóa và ghép kênh dữ liệu, được ứng dụng rộng rãi trong các hệ thống viễn thông, chẳng hạn như mạng điện thoại (xem Hình 1.1).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.1.png" alt="Hình 1.1. Sự tiến hóa của mạng máy tính tại giao điểm của công nghệ tính toán và công nghệ viễn thông." width="500">
</p>
<p align="center"><b>Hình 1.1. Sự tiến hóa của mạng máy tính tại giao điểm của công nghệ tính toán và công nghệ viễn thông.</b></p>

---

#### 1.2 Những mạng máy tính đầu tiên

##### 1.2.1 Hệ thống xử lý theo gói

Hãy bắt đầu với nguồn gốc tính toán của mạng máy tính. Những máy tính đầu tiên vào những năm 1950 — lớn, cồng kềnh và đắt đỏ — được thiết kế dành cho một số ít người dùng được chọn. Thường thì những "con quái vật" này chiếm cả tòa nhà và đảm nhiệm các nhiệm vụ khổng lồ. Những máy tính như vậy không được thiết kế cho công việc tương tác với người dùng mà được sử dụng trong chế độ **xử lý theo gói**.

**Hệ thống xử lý theo gói**, thông thường, được xây dựng dựa trên nền tảng mainframe — một máy tính mạnh mẽ và đáng tin cậy với mục đích sử dụng đa năng. Người dùng chuẩn bị trước thẻ lệnh (punch card), chứa dữ liệu và các lệnh của chương trình, rồi gửi chúng đến trung tâm tính toán (Hình 1.2). Các nhiệm vụ từ nhiều người dùng được nhóm lại thành một gói, sau đó được xử lý. Người vận hành máy mainframe đưa các thẻ lệnh của gói vào máy tính, thực hiện việc phân phối nhiệm vụ giữa các bộ xử lý và thiết bị nhập/xuất để tối ưu hóa hiệu suất tính toán. Kết quả thường được gửi lại cho người dùng trong vòng vài ngày, thường là với độ trễ ít nhất một ngày làm việc. Điều này đồng nghĩa với việc "tăng tốc" chỉ có thể đạt được tối thiểu trong chu kỳ xử lý hàng ngày.

Tất nhiên, đối với những người dùng yêu cầu chế độ làm việc tương tác, việc xử lý theo lô này không phù hợp. Tuy nhiên, ở các giai đoạn ban đầu, phương pháp này giúp tiết kiệm đáng kể chi phí và đạt hiệu quả tính toán từ những cỗ máy đắt tiền — bộ xử lý và các thiết bị nhập/xuất được sử dụng một cách tối đa và hiệu quả cao nhất nhờ cách tiếp cận này.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.2.png" alt="Hình 1.2. Hệ thống tập trung dựa trên máy tính trung tâm (mainframe)." width="900">
</p>
<p align="center"><b>Hình 1.2. Hệ thống tập trung dựa trên máy tính trung tâm (mainframe).</b></p>

---

##### 1.2.2 Hệ thống đa thiết bị đầu cuối — hình mẫu của mạng

Với sự giảm giá của bộ xử lý vào đầu những năm 1960, xuất hiện các phương pháp tổ chức mới cho quá trình tính toán, cho phép quan tâm đến lợi ích của người dùng. Các hệ thống tương tác đa thiết bị đầu cuối với chia sẻ thời gian (Hình 1.3) bắt đầu phát triển. Trong các hệ thống này, mỗi người dùng nhận được một thiết bị đầu cuối riêng, thông qua đó họ có thể tương tác với máy tính. Số lượng người dùng làm việc đồng thời với máy tính được xác định bởi khả năng của nó: thời gian phản hồi của hệ thống tính toán phải đủ ngắn để người dùng không cảm thấy quá rõ ràng sự làm việc song song của những người dùng khác với cùng một máy tính.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.3.png" alt="Hình 1.3. Hệ thống đa thiết bị đầu cuối — hình mẫu của mạng tính toán" width="800">
</p>


Các thiết bị đầu cuối, khi ra khỏi phạm vi của trung tâm tính toán, đã được phân tán khắp toàn bộ doanh nghiệp. Và mặc dù khả năng tính toán vẫn hoàn toàn tập trung, một số chức năng — chẳng hạn như nhập và xuất dữ liệu — đã trở nên phân tán. Những hệ thống đa thiết bị đầu cuối tập trung này bề ngoài rất giống với các mạng tính toán cục bộ. Thực tế, người dùng bình thường cảm nhận công việc với thiết bị đầu cuối của máy tính mainframe gần giống như hiện nay họ làm việc với máy tính cá nhân kết nối với mạng. Người dùng có thể truy cập các tệp chung và thiết bị ngoại vi, trong khi vẫn duy trì ảo giác hoàn toàn về việc sở hữu riêng một máy tính, vì họ có thể chạy chương trình mong muốn bất kỳ lúc nào và gần như ngay lập tức nhận được kết quả (mặc dù một số tính toán phức tạp có thể mất nhiều thời gian và người dùng thậm chí tin rằng các phép tính này được thực hiện ngay trong thiết bị của họ).

**Các hệ thống đa thiết bị đầu cuối, hoạt động trong chế độ chia sẻ thời gian, đã trở thành hình mẫu cho các mạng tính toán cục bộ.**

Tuy nhiên, để xuất hiện các mạng cục bộ, cần phải đi qua một chặng đường dài nữa, vì các hệ thống đa thiết bị đầu cuối, mặc dù có các đặc điểm bề ngoài giống hệ thống phân tán, vẫn hỗ trợ xử lý dữ liệu tập trung.

Hơn nữa, nhu cầu của các doanh nghiệp trong việc tạo ra các mạng cục bộ vào thời điểm đó vẫn chưa trưởng thành — trong một tòa nhà đơn lẻ, thường không có gì để kết nối thành một mạng, vì chi phí cao của công nghệ tính toán khiến các doanh nghiệp không thể mua được nhiều máy tính. Trong thời kỳ này, quy luật gọi là **quy luật Grosch** được áp dụng, phản ánh thực tế về cấp độ công nghệ đã đạt được. Theo quy luật này, **hiệu suất của một máy tính tỷ lệ thuận với bình phương chi phí của nó**. Điều này dẫn đến việc, với cùng một số tiền, việc mua một máy tính mạnh mẽ sẽ có lợi hơn so với hai máy tính yếu hơn — tổng công suất của hai máy tính yếu sẽ thấp hơn nhiều so với công suất của máy tính đắt tiền hơn.

---

##### 1.2.3 Những mạng toàn cầu đầu tiên

Nhu cầu kết nối nhiều máy tính đặt cách xa nhau đã trở nên cấp thiết vào thời điểm đó. Mọi thứ bắt đầu bằng việc giải quyết một nhiệm vụ đơn giản hơn — truy cập từ xa đến một máy tính từ các thiết bị đầu cuối đặt cách xa hàng trăm, thậm chí hàng ngàn, km. Các thiết bị đầu cuối được kết nối với máy tính qua mạng điện thoại bằng modem, cho phép nhiều người dùng truy cập từ xa vào tài nguyên được chia sẻ của các siêu máy tính mạnh mẽ. Sau đó, xuất hiện các hệ thống mà bên cạnh các kết nối từ xa kiểu **thiết bị đầu cuối – máy tính**, còn được thực hiện các kết nối từ xa kiểu **máy tính – máy tính**.

Các máy tính phân tán về mặt địa lý có khả năng trao đổi dữ liệu **một cách tự động**, điều này thực sự là đặc điểm cơ bản của bất kỳ mạng tính toán nào.

Dựa trên cơ chế này, trong các mạng đầu tiên, đã xuất hiện các dịch vụ trao đổi tệp, đồng bộ hóa cơ sở dữ liệu, thư điện tử và nhiều thứ khác, giờ đây trở thành các dịch vụ mạng truyền thống.


**Vì vậy, theo thứ tự thời gian, mạng toàn cầu (Wide Area Network, WAN) là những mạng đầu tiên, kết nối các máy tính phân tán về mặt địa lý, có thể đặt ở các thành phố và quốc gia khác nhau.**


Chính khi xây dựng các mạng toàn cầu, nhiều ý tưởng quan trọng đã được đề xuất và phát triển, trở thành nền tảng của các mạng tính toán hiện đại. Ví dụ, việc xây dựng các giao thức truyền thông, khái niệm chuyển mạch gói và định tuyến gói đã được định hình.

Mạng toàn cầu kế thừa rất nhiều từ các hệ thống lâu đời và phổ biến hơn — **điện thoại**. Đổi mới công nghệ chính mà các mạng toàn cầu đầu tiên mang lại là việc từ bỏ **nguyên tắc chuyển mạch kênh**, vốn được sử dụng thành công trong mạng điện thoại trong nhiều thập kỷ.

Những thử nghiệm thực tế và mô phỏng toán học đã chỉ ra rằng các mạng hoạt động theo **nguyên tắc chuyển mạch gói** — nơi dữ liệu được chia thành các phần nhỏ gọi là gói, tự di chuyển qua mạng dựa vào địa chỉ đích trong tiêu đề gói — hiệu quả hơn rất nhiều, ngay cả khi dữ liệu bị gián đoạn và có độ trễ đáng kể.

Do việc lắp đặt các đường truyền chất lượng cao cho khoảng cách xa rất đắt đỏ, trong các mạng toàn cầu đầu tiên, các kênh liên lạc hiện có, vốn được thiết kế ban đầu cho các mục đích khác, đã được sử dụng. Ví dụ, trong nhiều năm, các mạng toàn cầu được xây dựng trên các kênh điện thoại tần số âm thanh, đủ khả năng cung cấp đồng thời một cuộc gọi thoại trên kênh analog. Tuy nhiên, tốc độ truyền dữ liệu của các kênh như vậy rất thấp (chỉ vài kilobit/giây), và phạm vi dịch vụ trong các mạng như vậy bị giới hạn bởi việc trao đổi tệp và thư điện tử. Bên cạnh tốc độ thấp, các kênh này còn có nhược điểm khác — chúng làm méo tín hiệu truyền đi. Các giao thức của mạng toàn cầu, được xây dựng trên các kênh liên lạc chất lượng thấp, khác biệt bởi các thủ tục kiểm soát phức tạp và khôi phục dữ liệu. Một ví dụ điển hình của những mạng như vậy là mạng dựa trên giao thức **X.25**, được phát triển vào đầu những năm 1970.

---

**Ghi chú**

Khi viết chương này, các tác giả đã đối mặt với một vấn đề nan giải: không thể kể câu chuyện về ngành này mà không nhắc đến các công nghệ và khái niệm cụ thể. Tuy nhiên, cũng không thể giải thích ngay lập tức các công nghệ và khái niệm đó, vì người đọc khi đọc những trang đầu tiên có thể chưa sẵn sàng tiếp thu các giải thích này. Các tác giả đã chọn giải pháp thỏa hiệp, để lại việc giải thích chi tiết nhiều thuật ngữ cho tương lai, để ở giai đoạn đầu của việc nghiên cứu mạng máy tính, người đọc có cơ hội hình dung được bức tranh tiến hóa của mạng máy tính trong toàn bộ sự phong phú của nó.

---

Vào năm 1969, Bộ Quốc phòng Hoa Kỳ đã khởi xướng công việc kết nối một mạng duy nhất gồm các siêu máy tính phục vụ quốc phòng và nghiên cứu khoa học. Mạng này, được gọi là **ARPANET**, đã trở thành điểm khởi đầu để tạo ra mạng toàn cầu đầu tiên và nổi tiếng nhất hiện nay — **Internet**.

Mạng **ARPANET** kết nối các máy tính khác loại, hoạt động dưới sự quản lý của các hệ điều hành (OS) khác nhau, cùng với các mô-đun bổ sung để triển khai các giao thức truyền thông chung cho tất cả các máy tính trong mạng. Các hệ điều hành của các máy tính này có thể được coi là **hệ điều hành mạng đầu tiên**.

Hệ điều hành mạng không chỉ phân bổ người dùng giữa nhiều máy tính (như trong các hệ thống đa thiết bị đầu cuối) mà còn tổ chức lưu trữ và xử lý dữ liệu phân tán. Bất kỳ hệ điều hành mạng nào, một mặt, thực hiện tất cả các chức năng của một hệ điều hành cục bộ, và mặt khác, có các phương tiện bổ sung để tương tác với các hệ điều hành của các máy tính khác. Các mô-đun chương trình thực hiện các chức năng mạng đã được phát triển dần dần, khi các công nghệ mạng tiến bộ, giúp các máy tính giải quyết các nhiệm vụ mới yêu cầu xử lý mạng.

Sự phát triển của mạng máy tính toàn cầu theo nhiều cách gắn liền với sự tiến bộ của mạng điện thoại. Kể từ những năm 1960, mạng điện thoại đã dần chuyển sang **truyền giọng nói ở dạng số hóa**. Điều này dẫn đến sự xuất hiện của các kênh kỹ thuật số tốc độ cao kết nối các tổng đài điện thoại tự động (ATC), cho phép truyền đồng thời hàng chục và hàng trăm cuộc gọi.

Đến nay, các mạng toàn cầu về sự đa dạng và chất lượng dịch vụ đã bắt kịp các mạng cục bộ, vốn từng dẫn đầu trong lĩnh vực này trong một thời gian dài, mặc dù chúng ra đời muộn hơn nhiều.

---

##### 1.2.4 Những mạng cục bộ đầu tiên

Một sự kiện quan trọng, ảnh hưởng đến sự phát triển của mạng máy tính, đã xảy ra vào đầu những năm 1970. Kết quả của đột phá công nghệ trong sản xuất linh kiện máy tính đã xuất hiện **các vi mạch tích hợp lớn** (Large Scale Integration - LSI). Chi phí tương đối thấp và khả năng chức năng tốt của chúng đã dẫn đến sự ra đời của **máy tính mini**, những máy tính này trở thành đối thủ thực sự của các máy mainframe. Quy luật thực nghiệm của Grosch không còn phù hợp với thực tế, vì mười máy tính mini, với cùng chi phí như một máy mainframe, có thể giải quyết một số nhiệm vụ (thường là các nhiệm vụ có thể được xử lý song song) nhanh hơn. 

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.4.png" alt="Hình 1.4. Sử dụng độc lập nhiều máy tính mini trong một doanh nghiệp" width="800">
</p>


Ngay cả những bộ phận nhỏ của doanh nghiệp cũng có cơ hội sở hữu máy tính riêng. Máy tính mini giải quyết các nhiệm vụ quản lý thiết bị công nghệ, kho bãi và các nhiệm vụ khác ở cấp độ bộ phận của doanh nghiệp. Nhờ đó, xuất hiện khái niệm phân bổ tài nguyên máy tính trên toàn doanh nghiệp. Tuy nhiên, trong tình trạng này, tất cả các máy tính của một tổ chức vẫn tiếp tục hoạt động **độc lập** (Hình 1.4).

Theo thời gian, nhu cầu của người dùng đối với công nghệ tính toán tăng lên. Việc làm việc cách ly trên máy tính riêng của họ không còn đáp ứng được nhu cầu nữa; họ mong muốn được trao đổi dữ liệu một cách tự động với người dùng máy tính từ các bộ phận khác. Câu trả lời cho nhu cầu này là sự ra đời của **những mạng tính toán cục bộ đầu tiên** (Hình 1.5).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.5.png" alt="Hình 1.5. Các loại kết nối khác nhau trong mạng cục bộ đầu tiên" width="800">
</p>


**Mạng cục bộ (Local Area Network, LAN)**

Mạng cục bộ là sự kết hợp của các máy tính trong một khu vực nhỏ, thường có bán kính không vượt quá 1–2 km, mặc dù trong một số trường hợp mạng cục bộ có thể lớn hơn, ví dụ như vài chục km. Thông thường, mạng cục bộ đại diện cho một hệ thống truyền thông thuộc sở hữu của một tổ chức.


Ban đầu, để kết nối các máy tính với nhau, người ta đã sử dụng các **công nghệ mạng không chuẩn hóa**.

**Công nghệ mạng** — là một tập hợp các phương tiện phần mềm và phần cứng (như trình điều khiển, card mạng, cáp và đầu nối), cũng như các cơ chế truyền dữ liệu qua các đường truyền, đủ để xây dựng một mạng tính toán.

Nhiều loại thiết bị ghép nối, sử dụng các cách riêng để truyền dữ liệu trên các kênh, các loại cáp khác nhau, v.v., chỉ có thể kết nối với các kiểu máy tính cụ thể. Ví dụ, các máy PDP-11 của DEC, máy mainframe IBM 360, hoặc máy tính mini của HP với vi máy tính LSI-11. Tình trạng này tạo ra rất nhiều công việc cho sinh viên — nhiều đồ án và luận văn bắt đầu bằng cụm từ **“Thiết kế thiết bị ghép nối…”**.

**Vào giữa những năm 1980**, tình hình trong mạng cục bộ đã thay đổi đáng kể. Các **công nghệ mạng chuẩn hóa** để kết nối máy tính đã được xác lập — Ethernet, Arcnet, Token Ring, và sau đó là FDDI.

Một động lực mạnh mẽ cho sự xuất hiện của mạng cục bộ là sự phát triển của **máy tính cá nhân**. Những máy tính này trở thành phần tử lý tưởng để xây dựng mạng. Một mặt, chúng đủ mạnh để xử lý các phần mềm mạng, mặt khác, chúng yêu cầu sự kết nối để bù đắp thiếu sót về sức mạnh tính toán. Máy tính cá nhân không chỉ đóng vai trò như máy khách mà còn như trung tâm lưu trữ và xử lý dữ liệu, thay thế vai trò quen thuộc của các máy tính mini và mainframe.

Các công nghệ mạng chuẩn hóa đã biến việc xây dựng mạng cục bộ từ một nhiệm vụ kỹ thuật phức tạp trở thành một công việc thường nhật. Để xây dựng mạng, chỉ cần có cáp tiêu chuẩn, card mạng, và phần mềm như Novell NetWare.

**Vào cuối những năm 1990**, Ethernet đã khẳng định vị thế là công nghệ hàng đầu trong mạng cục bộ. Các chuẩn Ethernet bao gồm tốc độ truyền dữ liệu 10 Mbps, Fast Ethernet (100 Mbps), và Gigabit Ethernet (1000 Mbps).

Thuật toán hoạt động đơn giản của Ethernet làm giảm chi phí thiết bị, và dải tốc độ rộng cho phép doanh nghiệp linh hoạt trong việc xây dựng mạng phù hợp với nhu cầu và mục tiêu của họ.

---

#### 1.3 Hội tụ mạng
##### 1.3.1 Hội tụ giữa mạng cục bộ và mạng toàn cầu


Vào cuối những năm 80, sự khác biệt giữa mạng cục bộ và mạng toàn cầu được thể hiện rất rõ ràng.

- **Phạm vi và chất lượng đường truyền:** Mạng máy tính cục bộ về bản chất không khác nhiều so với mạng toàn cầu về khoảng cách nhỏ giữa các nút mạng. Điều này về cơ bản cho phép sử dụng các đường truyền chất lượng cao trong mạng cục bộ. Trong mạng toàn cầu những năm 80, chủ yếu sử dụng đường dây điện thoại tốc độ thấp, truyền thông tin rời rạc từ máy tính với mức méo tín hiệu tương đối cao.

- **Độ phức tạp của phương pháp truyền dữ liệu:** Trong điều kiện độ tin cậy thấp của kênh vật lý trong mạng toàn cầu, các phương pháp truyền dữ liệu và thiết bị tương ứng phức tạp hơn so với mạng cục bộ.

- **Tốc độ truyền dữ liệu:** Tốc độ trong mạng cục bộ (10, 16 và 100 Mbit/s) vào thời điểm đó cao hơn đáng kể so với mạng toàn cầu (2,4 Kbit/s đến 2 Mbit/s).

- **Sự đa dạng dịch vụ:** Tốc độ truyền dữ liệu cao trong mạng cục bộ cho phép cung cấp một loạt các dịch vụ — trước hết, là các phương pháp khác nhau để chia sẻ tệp, truy cập vào đĩa của máy tính khác, chia sẻ thiết bị như máy in, modem, máy fax, truy cập vào cơ sở dữ liệu chung, email và nhiều dịch vụ khác. Trong khi đó, mạng toàn cầu chủ yếu chỉ cung cấp các dịch vụ thư tín và tập tin dưới dạng đơn giản (dễ sử dụng nhất cho người dùng).

Dần dần, sự khác biệt giữa mạng cục bộ và mạng toàn cầu bắt đầu bị xóa nhòa. Các mạng cục bộ trước đây được cách ly bắt đầu kết nối với nhau thông qua việc sử dụng mạng toàn cầu như một môi trường liên kết. Việc tích hợp mạng cục bộ và mạng toàn cầu dẫn đến sự phát triển đáng kể trong công nghệ mạng tương ứng.

Việc hội tụ trong các phương pháp truyền dữ liệu chủ yếu xảy ra do việc sử dụng các công nghệ truyền dẫn dữ liệu chung — cáp quang — và các phương pháp mã hóa dữ liệu thống nhất — mã hóa số (digital coding). Cáp quang đảm bảo truyền tải tốc độ cao trên khoảng cách xa với độ tin cậy cao. Vì vậy, các mạng không chỉ được xây dựng dựa trên nguyên lý số hóa tín hiệu mà còn kết hợp với đường truyền số hóa tốc độ cao trong mạng toàn cầu.

Chất lượng cao của các kênh số đã thay đổi yêu cầu đối với các giao thức của mạng máy tính toàn cầu. Thay vì các quy trình đảm bảo độ tin cậy, các quy trình đảm bảo tốc độ truyền tải trung bình được đảm bảo đến người dùng đã trở thành ưu tiên hàng đầu, cùng với các cơ chế xử lý ưu tiên cho các gói tin đặc biệt nhạy cảm với độ trễ, chẳng hạn như thoại.

Những thay đổi này đã được phản ánh trong các công nghệ mạng toàn cầu của những năm 90, như Frame Relay và ATM. Trong các công nghệ này, người ta giả định rằng việc méo tín hiệu bit xảy ra rất hiếm, đến mức các gói tin lỗi tốt hơn là bị hủy bỏ hoàn toàn, và tất cả các vấn đề liên quan đến việc mất gói tin được giao phó cho phần mềm ở cấp độ cao hơn, phần mềm này không thuộc về mạng Frame Relay và ATM.

Sự đóng góp lớn vào việc hội tụ giữa mạng cục bộ và mạng toàn cầu là sự thống trị của giao thức IP. Giao thức này có thể hoạt động trên bất kỳ công nghệ mạng cục bộ và toàn cầu nào (Ethernet, MPLS, Token Ring, ATM, Frame Relay), kết hợp các phân đoạn mạng khác nhau thành một mạng hợp nhất.

Bắt đầu từ những năm 90, các mạng toàn cầu dựa trên kênh số tốc độ cao đã mở rộng đáng kể phạm vi dịch vụ được cung cấp và dần dần hội tụ với mạng cục bộ. Các dịch vụ mới xuất hiện liên quan đến việc cung cấp thông tin dung lượng lớn cho người dùng trong thời gian thực – hình ảnh, video, thoại, hay nói chung là thông tin đa phương tiện. Một ví dụ điển hình là dịch vụ thông tin siêu văn bản World Wide Web (dịch vụ web), trở thành nhà cung cấp thông tin chính trên Internet. Tính tương tác của nó đã tạo cơ hội cho nhiều dịch vụ tương tự trong mạng cục bộ, buộc các nhà phát triển ứng dụng cho mạng cục bộ phải tích hợp các dịch vụ này vào mạng toàn cầu. Quá trình tích hợp công nghệ từ mạng toàn cầu Internet vào mạng cục bộ đã trở nên phổ biến đến mức xuất hiện thuật ngữ riêng - công nghệ intranet ("intra" - bên trong).

Các công nghệ mạng mới đã xuất hiện, hoạt động đồng thời hiệu quả trong cả mạng cục bộ và toàn cầu. Công nghệ đầu tiên là ATM, cho phép kết hợp hiệu quả các loại lưu lượng truy cập khác nhau vào một mạng. Tuy nhiên, hệ thống mạng đa năng thực sự là công nghệ Ethernet. Sau đó, Ethernet đã được mở rộng với khả năng mới và cải tiến tốc độ, công nghệ này được gọi là Carrier Ethernet, tức là Ethernet cấp nhà mạng, và chủ yếu được sử dụng trên các tuyến mạng toàn cầu và đường trục.

Kết quả là vào đầu thế kỷ XXI, việc đơn giản hóa cấu trúc mạng cục bộ và toàn cầu đã trở nên phổ biến – hầu hết các phân đoạn mạng đều hoạt động dựa trên giao thức Ethernet, được tích hợp vào mạng thông qua giao thức IP.

Một dấu hiệu khác của sự hội tụ giữa mạng cục bộ và mạng toàn cầu là sự xuất hiện của các mạng nằm ở vị trí trung gian giữa hai loại mạng này, được gọi là **mạng đô thị** hoặc **mạng MAN** (Metropolitan Area Network), được thiết kế để phục vụ trên lãnh thổ của một thành phố lớn.

Các mạng này sử dụng các đường truyền số, thường là cáp quang, với tốc độ trên đường trục đạt 10 Gbit/s trở lên. Chúng cung cấp giải pháp kinh tế để kết nối các mạng cục bộ với nhau cũng như kết nối ra mạng toàn cầu. Ban đầu, các mạng MAN chỉ được thiết kế để truyền dữ liệu, nhưng hiện nay danh mục dịch vụ mà chúng cung cấp đã được mở rộng đáng kể. Đặc biệt, chúng hỗ trợ hội nghị truyền hình và truyền tải tích hợp dữ liệu thoại và văn bản. Các mạng MAN hiện đại nổi bật với sự đa dạng của các dịch vụ được cung cấp, cho phép khách hàng của chúng kết hợp các thiết bị liên lạc khác nhau, bao gồm cả tổng đài điện thoại văn phòng (ATC).


---

##### 1.3.2 Hội tụ giữa mạng máy tính và mạng viễn thông

Bắt đầu từ những năm 1980, đã có những nỗ lực tạo ra các mạng phổ quát, được gọi là **mạng đa dịch vụ**, có khả năng cung cấp các dịch vụ cho cả mạng máy tính và mạng viễn thông.

Mạng viễn thông bao gồm mạng phát thanh, điện thoại và truyền hình. Điều quan trọng kết nối chúng với mạng máy tính là, xét về khía cạnh tài nguyên, chúng cung cấp thông tin cho khách hàng. Tuy nhiên, có sự khác biệt đặc thù liên quan đến dạng thức mà thông tin được trình bày trong mạng máy tính và mạng viễn thông. Ban đầu, mạng máy tính được phát triển để truyền dữ liệu chữ và số, thường được gọi đơn giản là **dữ liệu**, trong khi mạng viễn thông được tạo ra để truyền thoại và video. Vì vậy, mạng viễn thông đã được xây dựng cho việc truyền tải **thông tin liên lạc**, và mạng máy tính ban đầu chỉ dành cho việc truyền tải **dữ liệu**.

Ngày nay, chúng ta chứng kiến sự hội tụ giữa mạng viễn thông và mạng máy tính, quá trình này đang diễn ra theo nhiều hướng.

Trước hết, có thể quan sát thấy **sự hội tụ về các loại dịch vụ** được cung cấp cho khách hàng. Nỗ lực đầu tiên trong việc tạo ra mạng đa dịch vụ, có khả năng cung cấp các dịch vụ khác nhau, bao gồm cả dịch vụ điện thoại và truyền dữ liệu, đã dẫn đến sự xuất hiện vào những năm 1980 của công nghệ **mạng số tích hợp dịch vụ** (Integrated Services Digital Network, ISDN). Tuy nhiên, trong thực tế, mạng ISDN vẫn là mạng điện thoại, và vai trò của mạng đa dịch vụ toàn cầu thế hệ mới đã thuộc về **Internet**.

Internet đã chuyển đổi từ một mạng được thiết kế chỉ để cung cấp một số lượng nhỏ dịch vụ truyền dữ liệu – với các dịch vụ chính là truyền tệp và trao đổi email – thành một mạng thực sự đa dịch vụ. Ngày nay, Internet cung cấp cả các dịch vụ viễn thông truyền thống, bao gồm tin nhắn tức thời, thoại và hội nghị video. Rõ ràng là vai trò đa dịch vụ của Internet sẽ ngày càng tăng lên trong tương lai.

Một ví dụ rõ ràng về hội tụ mạng là sự xuất hiện của **smartphone** – các thiết bị đầu cuối cá nhân, kết hợp các tính năng của máy tính và điện thoại. Nền tảng của sự hội tụ này là công nghệ **mạng di động**. Trong mạng này, để truyền tải các tín hiệu dịch vụ (được gọi là tín hiệu điều khiển), các giao thức chuyển mạch gói, tương tự như trong mạng máy tính, được áp dụng, còn để truyền tải trực tiếp giọng nói giữa các thuê bao, một kênh truyền thống riêng biệt được chuyển mạch.

**Sự hội tụ công nghệ** đang diễn ra theo nhiều hướng. Trước hết, điều này liên quan đến việc sử dụng truyền tải số, cụ thể là truyền tải gói, để đồng thời truyền tải dữ liệu và thoại. Điều này cho phép xây dựng các hệ thống truyền thông tổng hợp dựa trên các kênh kỹ thuật số, được sử dụng bởi cả các mạng máy tính và viễn thông. Trong mạng điện thoại số hiện đại, các giao thức truyền tải gói được áp dụng để truyền tải tín hiệu điều khiển, trong khi việc truyền tải trực tiếp giọng nói giữa các thuê bao vẫn sử dụng một kênh truyền thống được chuyển mạch.
Dưới đây là bản dịch đầy đủ và chính xác nội dung từ hình ảnh sang tiếng Việt:

Ngày nay, các phương pháp chuyển mạch gói dần thay thế các phương pháp chuyển mạch kênh truyền thống trong mạng điện thoại, ngay cả khi truyền tải giọng nói. Xu hướng này có lý do rõ ràng — dựa trên phương pháp chuyển mạch gói, có thể sử dụng hiệu quả hơn khả năng thông lượng của kênh truyền và thiết bị chuyển mạch. Ví dụ, trong cuộc trò chuyện điện thoại, các khoảng dừng có thể chiếm tới 40% tổng thời gian kết nối, nhưng chỉ có chuyển mạch gói mới cho phép “cắt bỏ” các khoảng dừng và sử dụng băng thông dư thừa của kênh để truyền tải lưu lượng đến các thuê bao khác. Một lý do khác dẫn đến việc chuyển sang sử dụng chuyển mạch gói là sự phổ biến của Internet — một mạng lưới được xây dựng dựa trên công nghệ này.

Việc áp dụng công nghệ chuyển mạch gói để truyền tải hợp nhất qua các mạng hỗ trợ nhiều loại lưu lượng — giọng nói, video và văn bản — đã khiến việc phát triển các phương pháp mới để đảm bảo **chất lượng dịch vụ** (Quality of Service, QoS) trở nên cần thiết. Các phương pháp QoS được thiết kế để giảm thiểu mức độ trễ cho lưu lượng nhạy cảm, chẳng hạn như giọng nói, đồng thời đảm bảo tốc độ trung bình và sự truyền tải ổn định của dữ liệu.

Tuy nhiên, không đúng khi nói rằng các phương pháp chuyển mạch kênh đã lỗi thời và không còn tương lai. Trong chu kỳ phát triển mới, chúng đang tìm thấy ứng dụng trong các công nghệ mới, chẳng hạn như công nghệ mạng lõi, được sử dụng làm cơ sở cho cả mạng máy tính và mạng điện thoại: **Mạng vận chuyển quang** (Optical Transport Networks, OTN) và **Đa phân chia bước sóng dày đặc** (Dense Wavelength Division Multiplexing, DWDM).

Một biểu hiện khác của sự hội tụ công nghệ là việc sử dụng giao thức IP trong các mạng viễn thông, vốn trước đây chỉ được sử dụng trong mạng máy tính. Ví dụ, giao thức này hiện được áp dụng trong các mạng viễn thông di động thế hệ thứ 3, 4 và 5 (3G, 4G, 5G).

Các mạng máy tính cũng đã áp dụng các phương pháp từ mạng viễn thông để nâng cao độ tin cậy. Trong mạng viễn thông, nơi mỗi kết nối được yêu cầu mức độ tin cậy rất cao, các phương pháp truyền tải thông tin dự phòng đã được sử dụng rộng rãi.

Cân nhắc quá trình hội tụ đang diễn ra, có thể kết luận rằng các khái niệm về "mạng viễn thông" và "mạng máy tính" trong tương lai sẽ được hợp nhất — tức là ám chỉ một mạng hợp nhất duy nhất.
Dưới đây là bản dịch đầy đủ nội dung từ hình ảnh sang tiếng Việt:


#### 1.4 Internet như một yếu tố phát triển công nghệ mạng

Internet là đỉnh cao của sự tiến hóa trong các mạng viễn thông, là hệ thống kỹ thuật phát triển nhanh nhất trong lịch sử loài người. Internet liên tục phát triển cả về quy mô lẫn chất lượng, bắt đầu từ những năm 80, và theo dự báo của các chuyên gia, quá trình này sẽ tiếp tục trong tương lai.

**"Quy mô"** của Internet có thể được đánh giá theo nhiều cách khác nhau, thường sử dụng các chỉ số như số lượng thiết bị đầu cuối được kết nối với Internet, số lượng người dùng, khối lượng lưu lượng truyền tải trong một đơn vị thời gian.

Sự phát triển chất lượng của Internet được thể hiện ở sự xuất hiện ngày càng nhiều dịch vụ mới, ví dụ như các phiên bản Internet của điện thoại và truyền hình, cũng như các loại thiết bị đầu cuối mới. Vì vậy, ngoài các "máy tính thuần túy", ngày nay Internet đã kết nối với nhiều loại thiết bị tích hợp "máy tính" – bao gồm điện thoại thông minh, máy tính bảng, thiết bị gia dụng, ô tô, và danh sách này vẫn sẽ tiếp tục mở rộng trong thời gian dài.

Hãy bắt đầu bằng cách xem xét sự phát triển về số lượng của Internet.

Hình 1.6 minh họa biểu đồ tăng trưởng số lượng người dùng Internet trong 50 năm tồn tại của mạng này. Vào đầu năm 2019, con số này đã đạt 4,388 tỷ người, tương đương với 57% dân số toàn cầu.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/1.6.png" alt="Hình 1.6. Sự tăng trưởng số lượng người dùng và lưu lượng truy cập Internet." width="800">
</p>

Số lượng thiết bị đầu cuối thực hiện chức năng của máy chủ (không bao gồm các thiết bị của người dùng) đã tăng trưởng với tốc độ tương tự: vào năm 1980 có khoảng 1.000 máy chủ được kết nối với Internet, năm 1991 – hơn 1 triệu, vào đầu những năm 2000 – khoảng 100 triệu, và cuối cùng, vào năm 2018 – hơn 1 tỷ. Tính cả các thiết bị người dùng (máy tính để bàn, máy tính xách tay, máy tính bảng và điện thoại di động), tổng số thiết bị đầu cuối được kết nối với Internet vào năm 2018 là khoảng 23 tỷ.

Sự bùng nổ tuyệt đối được ghi nhận trong tăng trưởng khối lượng lưu lượng (số byte được truyền qua các tuyến chính của Internet trong một tháng):

- **1990** – 1 TB (1 terabyte = $$10^{12}$$ byte, hoặc 1.000 gigabyte);
- **1996** – 2.000 TB;
- **2000** – 84 PB (1 petabyte = 1.000 terabyte);
- **2008** – 10 EB (1 exabyte = 1.000 petabyte);
- **2013** – 50 EB;
- **2018** – 129 EB.

Vào giữa những năm 1990, lưu lượng mạng tăng trưởng đặc biệt nhanh, gấp đôi mỗi năm, thể hiện sự phát triển theo cấp số nhân. Sau đó, tốc độ tăng trưởng chậm lại đôi chút, nhưng trong 5 năm qua, tổng khối lượng lưu lượng truyền tải vẫn tăng gấp 2,6 lần.

Rõ ràng là Internet sẽ không thể phát triển nhanh đến vậy nếu nó không thay đổi về chất lượng và chỉ dừng lại như một công cụ để truyền tải tệp và trao đổi thư điện tử. Các dịch vụ mới và các loại thiết bị đầu cuối mới đã và đang làm cho Internet trở nên hấp dẫn hơn với số lượng lớn người dùng phổ thông, những người mà trước đây hiếm khi nghĩ đến việc sử dụng máy tính trong cuộc sống hàng ngày.

Nếu chúng ta xem xét các thiết bị đầu cuối kết nối Internet, chúng ta sẽ thấy rằng ngày nay phần lớn chúng không phải là máy tính để bàn cá nhân truyền thống, mà là **các thiết bị di động** — máy tính bảng và điện thoại thông minh. Ngày càng có nhiều thiết bị đầu cuối hơn được kết nối Internet, bao gồm cả những thiết bị có tích hợp máy tính. Những thiết bị này thường không dễ thấy, chẳng hạn như máy tính bảng và điện thoại thông minh, nhưng chúng được nhúng bên trong các hệ thống và thiết bị quen thuộc, chẳng hạn như hệ thống sưởi, camera quan sát, đồng hồ thông minh hoặc các hệ thống điều khiển ô tô. Những máy tính này khởi xướng và trao đổi dữ liệu giữa chính chúng hoặc với các trung tâm điều khiển từ xa qua Internet, thực chất là không yêu cầu người dùng trực tiếp tham gia. Những thiết bị này đã làm phát sinh một thuật ngữ mới – **Internet vạn vật** (Internet of Things, IoT), hỗ trợ sự khác biệt rõ ràng giữa Internet thiết bị và Internet của con người.

Kết quả là, nếu vào năm 2013 hơn một nửa lưu lượng Internet (67%) được tạo ra bởi các máy tính cá nhân, thì đến năm 2018, vị trí dẫn đầu đã nhường chỗ cho các thiết bị di động và các máy tính nhúng, chiếm tổng cộng 53% lưu lượng.

Tỷ lệ các loại ứng dụng tạo ra lưu lượng cũng thay đổi đáng kể. Chẳng hạn, vào những năm 1990 và đầu những năm 2000, phần lớn lưu lượng ứng dụng đến từ việc truyền tải các tệp dữ liệu (tệp email, trang web, nhạc và phim). Nhưng đến năm 2010, vị trí dẫn đầu về lưu lượng đã thuộc về các ứng dụng truyền tải video theo thời gian thực (chẳng hạn như truyền hình Internet, phát phim trực tuyến theo yêu cầu hoặc hội nghị truyền hình).

Một bước tiến mới trong sự phát triển của Internet là sự xuất hiện của **điện toán đám mây**, cho phép giảm tải máy tính cá nhân và chuyển việc lưu trữ dữ liệu cũng như thực hiện các tính toán sang các máy chủ từ xa, được kết nối với máy tính của người dùng thông qua mạng. Điện toán đám mây đã trở thành một trong những yếu tố chính thúc đẩy lưu lượng Internet, vì người dùng dịch vụ này liên tục truy cập các máy chủ bên ngoài của nhà cung cấp để thực hiện các tính toán và các thao tác khác với dữ liệu, thay vì xử lý chúng tại chỗ trên máy tính cá nhân hoặc các máy chủ nội bộ của doanh nghiệp.

**Sự thay đổi về khối lượng và tính chất của lưu lượng** do sự xuất hiện của các thiết bị đầu cuối mới, các ứng dụng và dịch vụ mới trên Internet đã tạo ra những thách thức mới cho các nhà phát triển công nghệ mạng, vì các yêu cầu đối với các đặc tính của mạng trong các ứng dụng này khác biệt đáng kể so với yêu cầu của các ứng dụng truyền tải tệp dữ liệu.

Ví dụ, các phương tiện không người lái hiện đang trong giai đoạn thử nghiệm và sẽ sớm trở thành hiện thực trong cuộc sống hàng ngày. Internet là một phần không thể thiếu của hệ thống điều khiển các phương tiện này, hỗ trợ trao đổi thông tin theo thời gian thực giữa máy tính trên xe và các ứng dụng từ xa, giải quyết các nhiệm vụ phức tạp có thể bao gồm cả các yếu tố trí tuệ nhân tạo, vượt ngoài khả năng của máy tính trên xe với các tài nguyên hạn chế. Rõ ràng rằng trong trường hợp này, thời gian phản hồi của mạng và độ tin cậy là các thông số quan trọng, nếu không, chiếc xe có thể trở thành một vật thể nguy hiểm trên đường. Các yêu cầu mới đối với khả năng phản hồi của mạng có thể đòi hỏi không chỉ sự phát triển của các công nghệ mạng tốc độ cao, mà còn là việc thay đổi kiến trúc của nó, chuyển các trung tâm xử lý đến gần với rìa mạng Internet hơn.

Sự tăng trưởng vượt bậc và tính linh hoạt của Internet (trên nhiều khía cạnh) đã và đang có tác động lớn đến công nghệ mạng máy tính, buộc chúng phải không ngừng thay đổi và cải tiến để thích nghi với các yêu cầu mới từ người dùng về cả chất lượng và số lượng.

---
<h3 id="chuong-2-cac-nguyen-tac-chung-trong-xay-dung-mang">CHƯƠNG 2: Các nguyên tắc chung trong xây dựng mạng</h3>

#### 2.1 Mạng đơn giản nhất với hai máy tính

##### 2.1.2 Chia sẻ tài nguyên

Về mặt lịch sử, mục tiêu chính của việc kết nối các máy tính vào mạng là **chia sẻ tài nguyên**: người dùng của các máy tính được kết nối mạng, hoặc các ứng dụng chạy trên các máy tính này, có khả năng truy cập tự động vào các tài nguyên khác nhau từ các máy tính khác trong mạng, bao gồm:

- Các thiết bị ngoại vi, chẳng hạn như ổ đĩa, máy in, máy vẽ, máy quét, v.v.;
- Dữ liệu được lưu trữ trong bộ nhớ trong hoặc trên các thiết bị lưu trữ ngoài;
- Sức mạnh tính toán (bằng cách chạy các chương trình "của mình" trên máy tính "khác").

Để cung cấp cho người dùng của các máy tính khác nhau khả năng chia sẻ tài nguyên mạng, các máy tính cần được trang bị một số phương tiện mạng bổ sung.

Xem xét một mạng đơn giản nhất, bao gồm hai máy tính, trong đó một máy tính được kết nối với máy in (hình 2.1). Những phương tiện bổ sung nào cần được trang bị trong cả hai máy tính để đảm bảo rằng máy in có thể hoạt động không chỉ với người dùng của máy tính **B**, mà còn với người dùng của máy tính **A**?

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.1.png" alt="Hình 2.1. Mạng cơ bản nhất" width="800">
</p>


##### 2.1.2 Giao diện mạng

Để kết nối các thiết bị với nhau, trước tiên chúng phải được trang bị các giao diện bên ngoài.

**Giao diện** – theo nghĩa rộng – là ranh giới logic và/hoặc vật lý được xác định một cách chính thức giữa các đối tượng riêng biệt, nơi diễn ra trao đổi thông tin. Giao diện xác định các tham số, quy trình và đặc tính của sự tương tác giữa các đối tượng.

---

**Ghi chú**

Ngoài **giao diện bên ngoài**, các thiết bị điện tử có thể sử dụng các **giao diện bên trong**, xác định ranh giới logic và vật lý giữa các mô-đun thành phần của chúng, như bộ nhớ trong, bộ xử lý, v.v.

Có sự phân biệt giữa **giao diện vật lý** và **giao diện logic**:

- **Giao diện vật lý** (còn được gọi là **cổng**) được xác định bởi tập hợp các kết nối điện và các đặc tính tín hiệu. Thông thường, nó là một bộ đầu nối, mỗi đầu nối trong đó có một nhiệm vụ nhất định, ví dụ, nhóm đầu nối để truyền dữ liệu, đầu nối đồng bộ hóa dữ liệu, v.v. Một cặp đầu nối được kết nối bằng **cáp**, bao gồm một tập hợp dây dẫn, mỗi dây kết nối các đầu nối tương ứng. Trong trường hợp này, người ta nói đến việc tạo ra một **đường dây** hoặc **kênh truyền** giữa hai thiết bị.

- **Giao diện logic** (còn được gọi là **giao thức**) là một tập hợp các thông điệp thông tin ở định dạng cụ thể, được trao đổi giữa hai thiết bị hoặc hai chương trình, cùng với tập hợp các quy tắc xác định logic của việc trao đổi các thông điệp này.

Trong hình 2.2, chúng ta thấy hai loại giao diện: giao diện **máy tính – máy tính** và **máy tính – thiết bị ngoại vi**.

- **Giao diện máy tính – máy tính** cho phép hai máy tính trao đổi thông tin. Ở mỗi phía, giao diện này được thực hiện bằng một cặp:
  - Mô-đun phần cứng, được gọi là **bộ điều hợp mạng** hoặc **card giao diện mạng** (NIC), trong tiếng Anh là **Network Interface Card**;
  - **Trình điều khiển card giao diện mạng** – một chương trình đặc biệt quản lý hoạt động của card giao diện mạng.

- **Giao diện máy tính – thiết bị ngoại vi** (trong trường hợp này, giao diện máy tính – máy in) cho phép máy tính kiểm soát hoạt động của thiết bị ngoại vi (PU). Giao diện này được thực hiện:
  - Từ phía máy tính – qua giao diện card và trình điều khiển PU (máy in), thông qua card giao diện mạng và trình điều khiển;
  - Từ phía PU – qua bộ điều khiển PU (máy in), thường bao gồm phần cứng xử lý, nhận **dữ liệu** (ví dụ: byte thông tin cần in lên giấy) và **lệnh** (các chỉ thị kiểm soát hoạt động điện cơ của thiết bị ngoại vi, ví dụ: nạp giấy vào máy in hoặc di chuyển đầu từ tính trên đĩa).
  
<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.2.png" alt="Hình 2.2. Sử dụng chung máy in trong mạng máy tính." width="800">
</p>

---

##### 2.1.3 Kết nối máy tính với thiết bị ngoại vi

Để hiểu cách giải quyết nhiệm vụ tổ chức truy cập ứng dụng, được thực thi trên máy tính **A**, vào thiết bị ngoại vi (PU) qua mạng, trước tiên hãy xem cách quản lý thiết bị này từ một ứng dụng được chạy trên máy tính **B**, nơi PU được kết nối trực tiếp (xem Hình 2.2).

1. Giả sử ứng dụng trên máy tính **B** cần thực hiện việc in một số dữ liệu. Để làm điều này, ứng dụng gửi một yêu cầu thực hiện thao tác nhập/xuất đến **hệ điều hành** (thông thường, trình điều khiển không thể được khởi chạy trực tiếp từ ứng dụng). Yêu cầu này chỉ rõ địa chỉ dữ liệu cần in (địa chỉ bộ đệm của bộ nhớ trong) và thông tin về thiết bị ngoại vi nào cần thực hiện thao tác này.

2. Sau khi nhận yêu cầu, hệ điều hành khởi chạy chương trình – **trình điều khiển máy in**. Từ thời điểm này, mọi hành động liên quan đến thực thi thao tác nhập/xuất từ phía máy tính chỉ được thực hiện bởi trình điều khiển máy in, hoạt động dưới sự điều khiển của mô-đun phần cứng – **card giao diện máy in**, mà không cần sự tham gia của ứng dụng hay hệ điều hành.

3. Trình điều khiển máy in thực hiện các lệnh, gửi chúng đến bộ điều khiển của máy in, chẳng hạn như "In ký tự", "Chuyển dòng", "Trả con trỏ về đầu". Trình điều khiển tạo ra và gửi một loạt các mã lệnh theo thứ tự cụ thể, cũng như dữ liệu, ví dụ, các byte cần in ra giấy, đến bộ điều khiển máy in, điều này sẽ thực hiện việc in ấn.

4. **Card giao diện** thực hiện công việc ở mức thấp, không đi sâu vào chi tiết liên quan đến logic quản lý thiết bị, ý nghĩa của dữ liệu và lệnh được truyền bởi trình điều khiển, coi chúng như một luồng byte đồng nhất. Sau khi nhận được từng byte từ trình điều khiển, card giao diện chỉ đơn giản là tuần tự truyền các bit vào đường truyền, biểu diễn từng bit bằng tín hiệu điện.

   Để bộ điều khiển máy in hiểu rằng việc truyền dữ liệu bắt đầu, trước khi truyền bit đầu tiên, card giao diện tạo ra **tín hiệu khởi đầu** với một hình thức cụ thể, và sau khi truyền bit thông tin cuối cùng, nó tạo ra **tín hiệu kết thúc**. Các tín hiệu này đồng bộ hóa quá trình truyền byte. Bộ điều khiển, khi nhận ra tín hiệu khởi đầu, bắt đầu nhận các bit thông tin, hình thành chúng thành byte trong bộ đệm nhận của mình. Ngoài các bit thông tin, card cũng có thể truyền bit kiểm tra chẵn lẻ để tăng độ tin cậy của trao đổi. Nếu quá trình truyền diễn ra chính xác, một cờ tương ứng sẽ được thiết lập trong bộ đệm của máy in.

5. Khi nhận được từng byte, bộ điều khiển diễn giải nó và thực hiện thao tác in tương ứng. Sau khi hoàn tất việc in toàn bộ ký tự của tài liệu, trình điều khiển máy in thông báo cho hệ điều hành về việc hoàn thành yêu cầu, và hệ điều hành, đến lượt mình, thông báo cho ứng dụng về sự kiện này.
   
---

##### 2.1.4 Trao đổi dữ liệu giữa hai máy tính

Các cơ chế tương tác giữa các máy tính trong mạng được vay mượn rất nhiều từ các sơ đồ tương tác giữa máy tính và thiết bị ngoại vi. Trong trường hợp đơn giản nhất, kết nối giữa hai máy tính có thể được thực hiện bằng các phương tiện tương tự như kết nối giữa máy tính và thiết bị ngoại vi, với sự khác biệt là trong trường hợp này, cả hai bên đều đóng vai trò tích cực.

Các ứng dụng **A** và **B** (xem Hình 2.2) quản lý quá trình truyền dữ liệu bằng cách trao đổi **thông điệp**. Để các ứng dụng có thể "hiểu" thông tin nhận được từ nhau, các lập trình viên phát triển các ứng dụng này phải quy định nghiêm ngặt định dạng và trình tự các thông điệp mà các ứng dụng sẽ trao đổi trong quá trình thực hiện thao tác này. Ví dụ, họ có thể quy ước rằng bất kỳ thao tác trao đổi dữ liệu nào cũng bắt đầu bằng việc gửi một thông điệp yêu cầu thông tin về trạng thái của ứng dụng **B**; sau đó, thông điệp tiếp theo sẽ chứa các nhận dạng của máy tính và người dùng đang thực hiện yêu cầu; thông điệp cuối cùng có thể là dấu hiệu kết thúc thao tác trao đổi dữ liệu, v.v. Bằng cách này, một **giao thức tương tác ứng dụng** được xác định để thực hiện các thao tác kiểu này.

Tương tự như cách gửi dữ liệu đến máy in yêu cầu phải truyền thêm một số thông tin phụ – dưới dạng các lệnh điều khiển máy in, thì khi truyền dữ liệu từ một máy tính đến máy tính khác cũng cần kèm theo các thông tin bổ sung dưới dạng các thông điệp giao thức mà các ứng dụng trao đổi với nhau.

Lưu ý rằng để triển khai giao thức, vào thời điểm cần thiết phải trao đổi dữ liệu, cả hai ứng dụng trên cả hai máy tính (**A** và **B**) phải sẵn sàng: một bên gửi thông điệp, còn bên kia phải sẵn sàng nhận thông điệp và xử lý phản hồi từ nó.

Việc truyền bất kỳ dữ liệu nào (các thông điệp giao thức cũng như dữ liệu thực tế, cấu thành thao tác trao đổi) luôn được thực hiện theo cùng một quy trình.

Ở phía máy tính **A**, ứng dụng, theo logic của giao thức, đặt vào bộ đệm của bộ nhớ trong (RAM) một thông điệp tiếp theo hoặc dữ liệu của riêng nó và gửi yêu cầu tới hệ điều hành để thực hiện thao tác trao đổi dữ liệu giữa các máy tính. Hệ điều hành khởi chạy trình điều khiển card mạng, trình điều khiển này tải byte từ bộ đệm RAM vào bộ đệm của card giao diện mạng, sau đó kích hoạt hoạt động của nó. Card giao diện mạng tuần tự truyền các bit vào đường truyền, bổ sung mỗi byte mới bằng các bit khởi đầu và kết thúc.

Ở phía máy tính **B**, card giao diện mạng nhận các bit từ giao diện bên ngoài, đặt chúng vào bộ đệm của nó. Sau khi nhận được bit kết thúc, card giao diện mạng thiết lập cờ hoàn tất tiếp nhận byte và thực hiện kiểm tra tính chính xác của việc tiếp nhận, chẳng hạn như kiểm tra bit chẵn lẻ. Việc tiếp nhận byte chính xác được ghi lại bởi trình điều khiển card giao diện mạng của máy tính **B**. Trình điều khiển sao chép byte nhận được từ bộ đệm của card giao diện mạng vào bộ đệm RAM đã được dành riêng của máy tính **B**. Ứng dụng **B** trích xuất dữ liệu từ bộ đệm và diễn giải chúng theo logic của giao thức, như một thông điệp hoặc dữ liệu. Nếu theo giao thức, ứng dụng **B** phải gửi lại phản hồi tới ứng dụng **A**, thì quy trình đối xứng sẽ được thực hiện.

Bằng cách kết nối hai máy tính hoạt động độc lập cả về mặt điện và thông tin, chúng ta đã có được một **mạng máy tính đơn giản nhất**.

---

##### 2.1.5 Truy cập thiết bị ngoại vi qua mạng

Vậy, chúng ta đã có trong tay một cơ chế cho phép các ứng dụng trên các máy tính khác nhau trao đổi dữ liệu. Và mặc dù ứng dụng **A** (xem Hình 2.2) vẫn không thể trực tiếp điều khiển máy in được kết nối với máy tính **B**, nhưng giờ đây nó có thể sử dụng các phương tiện trao đổi dữ liệu giữa các máy tính để gửi tới ứng dụng **B** một “yêu cầu” thực hiện thao tác cần thiết. Ứng dụng **A** cần “giải thích” cho ứng dụng **B** thao tác nào cần thực hiện, với dữ liệu nào, trên thiết bị nào có sẵn, và ở dạng nào (ví dụ: in văn bản). Trong quá trình in, có thể xảy ra các tình huống mà ứng dụng **B** cần thông báo cho ứng dụng **A**, chẳng hạn như về việc thiếu giấy trong máy in. Do đó, để giải quyết nhiệm vụ đặt ra – truy cập vào máy in qua mạng – cần phát triển một giao thức tương tác đặc biệt giữa các ứng dụng **A** và **B**.

Bây giờ, hãy xem cách tất cả các thành phần của mạng máy tính đơn giản này làm việc cùng nhau khi giải quyết nhiệm vụ sử dụng chung máy in.

1. Theo giao thức đã thiết lập, ứng dụng **A** tạo thông điệp yêu cầu gửi tới ứng dụng **B**, đặt thông điệp này vào bộ đệm RAM của máy tính **A** và gửi yêu cầu đến hệ điều hành, chỉ rõ thông tin cần thiết.

2. Hệ điều hành khởi chạy trình điều khiển card giao diện mạng, cung cấp cho nó địa chỉ của bộ đệm RAM nơi lưu trữ thông điệp.

3. Trình điều khiển và card giao diện mạng của máy tính **A**, tương tác với trình điều khiển và card giao diện mạng của máy tính **B**, truyền thông điệp từng byte vào bộ đệm RAM của máy tính **B**.

4. Ứng dụng **B** trích xuất thông điệp từ bộ đệm, diễn giải nó theo giao thức và thực hiện các hành động cần thiết. Trong số các hành động đó có thể bao gồm yêu cầu tới hệ điều hành để thực hiện các thao tác nhất định với máy in được kết nối cục bộ.

5. Hệ điều hành khởi chạy trình điều khiển máy in, trình điều khiển này phối hợp với card giao diện và bộ điều khiển máy in để thực hiện thao tác in cần thiết.

Ngay ở giai đoạn ban đầu này, khi xem xét kết nối giữa máy tính và thiết bị ngoại vi, chúng ta đã gặp phải các khái niệm "mạng" quan trọng: giao diện và giao thức, trình điều khiển và card giao diện, cũng như các vấn đề đặc trưng của mạng máy tính: sự tương thích giao diện, đồng bộ hóa các quy trình không đồng bộ, đảm bảo tính chính xác của việc truyền dữ liệu.

---

#### 2.2 Phần mềm mạng

Chúng ta vừa xem xét trường hợp sử dụng chung máy in trong một mạng đơn giản, chỉ bao gồm hai máy tính. Tuy nhiên, ngay ở giai đoạn ban đầu này, chúng ta đã có thể rút ra một số kết luận liên quan đến cấu trúc phần mềm mạng: các dịch vụ mạng, hệ điều hành mạng và các ứng dụng mạng.

---

##### 2.2.1 Dịch vụ và dịch vụ mạng

Nhu cầu truy cập vào một máy in từ xa có thể phát sinh từ người dùng của nhiều ứng dụng khác nhau: trình soạn thảo văn bản, trình chỉnh sửa đồ họa, hệ quản trị cơ sở dữ liệu (DBMS). Rõ ràng, việc nhân đôi các chức năng chung để tổ chức in ấn từ xa trong từng ứng dụng này là không cần thiết.

Một cách tiếp cận hiệu quả hơn là tách các chức năng này ra khỏi các ứng dụng và thực hiện chúng dưới dạng các cặp mô-đun chương trình chuyên dụng – **khách hàng in** và **máy chủ in** (Hình 2.3), với các chức năng được thực hiện tương ứng bởi các ứng dụng **A** và **B**. Giờ đây, cặp khách hàng – máy chủ này có thể được sử dụng bởi bất kỳ ứng dụng nào, được thực thi trên máy tính **A**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.3.png" alt="Hình 2.3. Sử dụng chung máy in trong mạng máy tính với sự hỗ trợ của dịch vụ in ấn mạng." width="800">
</p>

Khái quát hóa cách tiếp cận này áp dụng cho các loại tài nguyên chia sẻ khác, chúng ta đưa ra các định nghĩa sau:

- **Khách hàng - Client** – là một mô-đun được thiết kế để tạo và gửi các thông điệp yêu cầu tới các tài nguyên trên máy tính từ xa từ các ứng dụng khác nhau, và sau đó nhận kết quả từ mạng và chuyển chúng tới các ứng dụng tương ứng.

- **Máy chủ** – là một mô-đun luôn sẵn sàng chờ nhận các yêu cầu từ mạng từ các khách hàng, và khi nhận được yêu cầu, cố gắng xử lý nó, thường với sự tham gia của hệ điều hành cục bộ. Một máy chủ có thể xử lý các yêu cầu từ nhiều khách hàng cùng lúc hoặc theo thứ tự.

Một cặp khách hàng – máy chủ, cung cấp quyền truy cập tới một loại tài nguyên cụ thể của máy tính qua mạng, tạo thành một **dịch vụ mạng**.


Mỗi dịch vụ liên kết với một loại tài nguyên mạng cụ thể. Chẳng hạn, như trong Hình 2.3, các mô-đun khách hàng và máy chủ, thực hiện truy cập từ xa tới máy in, tạo thành dịch vụ mạng in.

Trong số các dịch vụ mạng, có thể phân biệt những dịch vụ không chỉ dành cho người dùng thông thường, chẳng hạn như dịch vụ tệp hoặc dịch vụ in, mà còn dành cho quản trị viên. Các dịch vụ này hướng đến việc tổ chức hoạt động của mạng. Ví dụ, **dịch vụ tra cứu** hoặc **dịch vụ danh mục** cho phép quản lý cơ sở dữ liệu về người dùng mạng, cũng như các thành phần phần mềm và phần cứng.

Dịch vụ được cung cấp bởi các dịch vụ mạng được gọi là **dịch vụ (service)**.

Mỗi dịch vụ đều liên quan đến một loại tài nguyên mạng cụ thể. Ví dụ, trên hình 2.3, các module của client (máy khách) và server (máy chủ), thực hiện quyền truy cập từ xa vào máy in, tạo thành dịch vụ mạng in ấn.

Trong các dịch vụ mạng, có thể phân biệt những dịch vụ không hướng tới người dùng thông thường mà hướng tới quản trị viên, chẳng hạn như dịch vụ tệp tin (file service) hoặc dịch vụ in ấn (print service). Các dịch vụ như vậy được thiết kế nhằm tổ chức hoạt động của mạng. Ví dụ, dịch vụ tra cứu (directory service) được thiết kế để duy trì cơ sở dữ liệu về người dùng mạng, cũng như tất cả các thành phần phần mềm và phần cứng trong mạng.

Dịch vụ mà một hệ thống cung cấp được gọi là "service".

**Dịch vụ** có thể cung cấp một hoặc nhiều loại **service**. Ví dụ, trong số các dịch vụ do dịch vụ tra cứu (directory service) cung cấp, ngoài việc quản lý tài nguyên, còn có các dịch vụ kiểm toán (audit), xác thực (authentication), ủy quyền (authorization), và các dịch vụ khác.

Để tìm kiếm và xem thông tin trên Internet, người ta sử dụng **dịch vụ web** (web service), bao gồm **web-server** và một chương trình máy khách được gọi là **web-browser** (trình duyệt web). Tài nguyên được chia sẻ trong trường hợp này là **web-site** (trang web) – một tập hợp các tệp được tổ chức theo cách nhất định, chứa thông tin liên quan về mặt ý nghĩa và được lưu trữ trên các thiết bị lưu trữ ngoài của web-server.

Trong sơ đồ dịch vụ web được minh họa ở hình 2.4, hai máy tính không được kết nối trực tiếp mà thông qua nhiều máy tính trung gian khác, hoặc các thiết bị mạng khác thuộc về Internet. Để biểu thị điều này, chúng tôi đặt giữa hai máy tính một khái niệm đồ họa gọi là **đám mây truyền thông** (communication cloud), cho phép trừu tượng hóa tất cả các chi tiết của môi trường truyền tin. Việc trao đổi tin nhắn giữa chương trình máy khách và máy chủ của dịch vụ web được thực hiện theo giao thức tiêu chuẩn HTTP và không phụ thuộc vào việc các tin nhắn đó được truyền "trực tiếp" (từ giao diện một máy tính tới giao diện của máy khác) hay thông qua một số lượng lớn các thiết bị giao tiếp trung gian – các thiết bị truyền thông trung chuyển (transit communication devices).

Cùng với đó, sự phức tạp của môi trường truyền tin dẫn đến việc phát sinh những nhiệm vụ bổ sung mới, mà các driver giao diện mạng đơn giản trước đây không được thiết kế để giải quyết. Thay vào đó, trên các máy tính tương tác, cần phải cài đặt các phương tiện phần mềm vận tải tiên tiến hơn (transport software).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.4.png" alt="Hình 2.4 Dịch vụ web" width="800">
</p>

##### 2.2.2 Hệ điều hành mạng (Network Operating System)

Hệ điều hành (Operating System) của máy tính thường được định nghĩa là một tập hợp các chương trình hệ thống liên kết (interconnected system programs), cung cấp khả năng quản lý hiệu quả các tài nguyên (resources) của máy tính (bộ nhớ - memory, bộ xử lý - processor, thiết bị ngoại vi - peripheral devices, tệp - files, v.v.), đồng thời cung cấp giao diện thân thiện (user-friendly interface) cho người dùng để làm việc với phần cứng máy tính (computer hardware) và phát triển ứng dụng (application development).

Khi nói về hệ điều hành mạng (Network Operating System - NOS), rõ ràng chúng ta cần mở rộng giới hạn của các tài nguyên được quản lý ra ngoài phạm vi của một máy tính duy nhất.

**Hệ điều hành mạng** được định nghĩa là hệ điều hành của một máy tính, ngoài việc quản lý các tài nguyên cục bộ (local resources), còn cung cấp cho người dùng và ứng dụng khả năng truy cập hiệu quả và thuận tiện (efficient and convenient access) vào các tài nguyên thông tin (informational resources) và phần cứng (hardware resources) của các máy tính khác trong mạng (networked computers).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.5.png" alt="Hình 2.5. Các thành phần chức năng của hệ điều hành mạng." width="800">
</p>

Vị trí của hệ điều hành mạng (Network Operating System - NOS) trong danh sách chung các hệ điều hành (Operating Systems - OS) phụ thuộc vào mức độ phong phú của các dịch vụ mạng (network services) và các dịch vụ (services) mà nó cung cấp cho người dùng cuối (end users), ứng dụng (applications) và quản trị viên mạng (network administrators).

Ngoài các dịch vụ mạng (network services), hệ điều hành mạng còn bao gồm các **phương tiện giao tiếp phần mềm (software communication tools)** hoặc **phương tiện truyền tải (transport tools)**, đảm bảo việc truyền tải thông điệp (messages) với sự phối hợp của các phương tiện giao tiếp phần cứng (hardware communication tools), thông qua đó các phần khách hàng (client) và phần máy chủ (server) của các dịch vụ mạng trao đổi dữ liệu với nhau. Nhiệm vụ giao tiếp giữa các máy tính trong mạng được thực hiện bởi các **trình điều khiển (drivers)** và **mô-đun giao thức (protocol modules)**. Chúng thực hiện các chức năng như: tạo thông điệp (message formation), chia nhỏ thông điệp thành các phần (packets, frames), chuyển đổi tên máy tính thành địa chỉ số (numeric addresses), nhân bản thông điệp trong trường hợp bị mất, định tuyến thông điệp trong mạng phức tạp, v.v.

Cả các dịch vụ mạng và các phương tiện truyền tải có thể là các thành phần tích hợp (built-in components) của hệ điều hành (OS) hoặc tồn tại dưới dạng các sản phẩm phần mềm riêng biệt. Ví dụ, dịch vụ tệp mạng (network file service) thường được tích hợp vào hệ điều hành, trong khi trình duyệt web (web browser) thường là một ứng dụng độc lập. Một hệ điều hành mạng điển hình thường bao gồm một tập hợp đa dạng các trình điều khiển (drivers) và mô-đun giao thức (protocol modules), nhưng người dùng, như thường lệ, có thể bổ sung tập hợp tiêu chuẩn này bằng các chương trình cần thiết khác.

Quyết định về cách thức triển khai (implementation) các khách hàng và máy chủ của dịch vụ mạng, cũng như các trình điều khiển và mô-đun giao thức, được đưa ra bởi các nhà phát triển, dựa trên nhiều cân nhắc khác nhau: kỹ thuật (technical), thương mại (commercial), và thậm chí pháp lý (legal). Ví dụ, dựa trên luật chống độc quyền (antitrust law) của Hoa Kỳ, Microsoft bị cấm tích hợp trình duyệt Internet Explorer của họ vào hệ điều hành của công ty.

Dịch vụ mạng (network service) có thể được cung cấp trong hệ điều hành (Operating System - OS) dưới dạng cả hai phần (khách hàng - client và máy chủ - server) hoặc chỉ một trong số đó.

Trong trường hợp đầu tiên, hệ điều hành, được gọi là **ngang hàng (peer-to-peer)**, không chỉ cho phép truy cập vào các tài nguyên của các máy tính khác, mà còn cung cấp các tài nguyên của chính mình để người dùng của các máy tính khác sử dụng. Ví dụ, nếu tất cả các máy tính trong mạng đều được cài đặt các thành phần khách hàng (client) và máy chủ (server) của dịch vụ tệp (file service), thì tất cả người dùng mạng có thể chia sẻ tệp với nhau. Các máy tính đồng thời thực hiện cả chức năng khách hàng và máy chủ được gọi là **nút ngang hàng (peer nodes)**.

Hệ điều hành chứa chủ yếu phần khách hàng (client-side) của dịch vụ mạng được gọi là **hệ điều hành khách hàng (client OS)**. Các hệ điều hành khách hàng được cài đặt trên các máy tính gửi yêu cầu tới tài nguyên của các máy tính khác trong mạng. Những máy tính như vậy, còn được gọi là máy tính khách (client computers), thường được sử dụng bởi người dùng phổ thông. Thông thường, các hệ điều hành khách hàng được thiết kế để làm việc trên các thiết bị đơn giản.

Một loại hệ điều hành khác được gọi là **hệ điều hành máy chủ (server OS)** – nó được thiết kế để xử lý các yêu cầu trong mạng và tài nguyên của máy chủ, bao gồm chủ yếu các phần máy chủ của dịch vụ mạng. Máy tính được cài đặt hệ điều hành máy chủ, chuyên phục vụ các yêu cầu từ các máy tính khác trong mạng, được gọi là **máy chủ chuyên dụng (dedicated server)**. Máy chủ chuyên dụng không được sử dụng bởi người dùng để làm việc trực tiếp.

**Lưu ý**

Chi tiết hơn về các hệ điều hành mạng (Network Operating Systems - NOS) và các dịch vụ mạng (network services) được tích hợp trong chúng, bạn có thể đọc trong các tài liệu chuyên ngành, cũng như trong sách giáo khoa của các tác giả với tiêu đề "Hệ điều hành mạng" (Network Operating Systems). 

Các dịch vụ mạng phổ biến nhất trên Internet, chẳng hạn như email (electronic mail), dịch vụ web (web services), điện thoại IP (IP telephony), v.v., sẽ được xem xét trong phần VII của cuốn sách này.

---

##### 2.2.3 Ứng dụng mạng (Network Applications)

Trên một máy tính được kết nối với mạng (network-connected computer), có thể chạy các loại ứng dụng khác nhau:

- **Ứng dụng cục bộ (Local Application)** hoàn toàn được thực thi trên máy tính này và chỉ sử dụng các tài nguyên cục bộ (local resources) (xem Hình 2.6, a). Đối với loại ứng dụng này, không cần bất kỳ phương tiện mạng nào (network means), và nó có thể được thực thi trên một máy tính hoạt động độc lập (autonomously operating computer).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.6.a.png" alt="Hình 2.6. Các loại ứng dụng hoạt động trong mạng." width="800">
</p>


- **Ứng dụng mạng tập trung (Centralized Network Application)** được thực thi hoàn toàn trên một máy tính, nhưng trong quá trình hoạt động, nó truy cập vào tài nguyên của các máy tính khác trong mạng. Trong ví dụ ở Hình 2.6, b, ứng dụng được thực thi trên một máy tính khách (client computer), xử lý dữ liệu từ một tệp được lưu trữ trên máy chủ tệp (file server), sau đó in kết quả trên máy in được kết nối với máy chủ in (print server). Rõ ràng, hoạt động của loại ứng dụng này là không thể thực hiện được nếu không có sự tham gia của các dịch vụ mạng (network services) và các phương tiện truyền tải thông điệp (message transportation means).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.6.b.png" alt="Hình 2.6. Các loại ứng dụng hoạt động trong mạng." width="800">
</p>

- **Ứng dụng phân tán (Distributed Network Application)** bao gồm một số phần tương tác (interacting components), mỗi phần thực hiện một công việc cụ thể và hoàn chỉnh trong việc giải quyết nhiệm vụ ứng dụng (application task). Thông thường, mỗi phần được thực thi trên một máy tính riêng biệt trong mạng (xem Hình 2.6, c). Các phần của ứng dụng phân tán tương tác với nhau bằng cách sử dụng các dịch vụ mạng (network services) và các phương tiện truyền tải (transportation tools) của hệ điều hành (Operating System - OS). Ứng dụng phân tán thường có quyền truy cập vào tất cả các tài nguyên của mạng máy tính (computer network).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.6.c.png" alt="Hình 2.6. Các loại ứng dụng hoạt động trong mạng." width="800">
</p>

Rõ ràng, ưu điểm nổi bật của các ứng dụng phân tán (distributed applications) là khả năng phân chia tính toán (parallelization of computations), cũng như chuyên môn hóa máy tính (specialization of computers). Ví dụ, trong một ứng dụng được thiết kế để phân tích biến đổi khí hậu, có thể chia thành ba phần độc lập (xem Hình 2.6, b), cho phép phân chia. Phần đầu tiên của ứng dụng, thực thi trên một máy tính cá nhân (personal computer) có hiệu suất thấp, có thể hỗ trợ giao diện người dùng đồ họa chuyên biệt (specialized graphical user interface). Phần thứ hai có thể thực hiện xử lý thống kê dữ liệu (statistical data processing) trên một máy tính chính hiệu suất cao (high-performance mainframe). Phần thứ ba sẽ tạo ra các báo cáo trên một máy chủ với hệ quản trị cơ sở dữ liệu tiêu chuẩn (standard DBMS).

Thông thường, mỗi phần của ứng dụng phân tán có thể được nhân bản thành nhiều bản sao, hoạt động trên các máy tính khác nhau. Ví dụ, trong trường hợp này, phần đầu tiên, chịu trách nhiệm hỗ trợ giao diện người dùng (user interface), có thể được chạy trên nhiều máy tính cá nhân, cho phép ứng dụng này làm việc với nhiều người dùng đồng thời.

Tuy nhiên, để đạt được tất cả các lợi ích mà ứng dụng phân tán hứa hẹn, các nhà phát triển (developers) cần giải quyết nhiều vấn đề, chẳng hạn như: chia ứng dụng thành bao nhiêu phần (how many parts to divide the application into), phân bổ chức năng nào cho từng phần (what functions to assign to each part), và tổ chức sự tương tác giữa các phần như thế nào (how to organize interaction among these parts) để trong trường hợp lỗi hoặc sự cố (failures), các phần còn lại có thể hoàn thành công việc, v.v.

Lưu ý rằng tất cả các dịch vụ như dịch vụ tệp (file service), dịch vụ in ấn (print service), dịch vụ thư điện tử (email service), điện thoại Internet (internet telephony), v.v., theo định nghĩa, thuộc về lớp các ứng dụng phân tán (distributed applications). Thực tế, bất kỳ dịch vụ mạng (network service) nào cũng bao gồm các phần khách hàng (client parts) và máy chủ (server parts), thường được thực thi trên các máy tính khác nhau.

Trong Hình 2.7, minh họa đặc điểm phân tán (distributed nature) của các dịch vụ web (web services), chúng ta thấy các loại thiết bị khách hàng khác nhau (different types of client devices) – máy tính cá nhân (personal computers), máy tính xách tay (laptops), và điện thoại di động (mobile phones) – với trình duyệt web (web browsers) được cài đặt trên chúng, tương tác qua mạng với máy chủ web (web server). 

Như vậy, một trang web (website) có thể được nhiều người dùng mạng (network users) sử dụng đồng thời – hàng trăm và thậm chí hàng nghìn.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.7.png" alt="Hình 2.6. Các loại ứng dụng hoạt động trong mạng." width="800">
</p>

Nhiều ví dụ về các ứng dụng phân tán (distributed applications) cũng có thể được tìm thấy trong các lĩnh vực như xử lý dữ liệu từ các thí nghiệm khoa học (scientific experiment data processing). Điều này không có gì đáng ngạc nhiên, bởi vì nhiều thí nghiệm tạo ra một lượng dữ liệu khổng lồ (large volumes of data), được tạo ra theo thời gian thực (real-time scale), mà không thể xử lý trên một máy tính đơn lẻ, ngay cả khi đó là một siêu máy tính (supercomputer).

Ngoài ra, các thuật toán xử lý dữ liệu thí nghiệm (experimental data processing algorithms) thường dễ dàng phân chia (easily parallelized), điều này cũng rất quan trọng để áp dụng thành công các máy tính liên kết (interconnected computers) nhằm giải quyết một nhiệm vụ chung (common task). Một trong những ví dụ nổi tiếng về ứng dụng khoa học phân tán (distributed scientific application) là phần mềm xử lý dữ liệu của Máy gia tốc hạt lớn (Large Hadron Collider - LHC), được khởi chạy vào ngày 10 tháng 9 năm 2008 tại CERN. Ứng dụng này hoạt động trên hơn 30.000 máy tính (more than 30,000 computers) được liên kết thành một mạng (networked).

---

#### 2.3 Truyền dữ liệu vật lý qua đường truyền (Physical Data Transmission via Communication Lines)

Ngay cả khi xem xét một mạng đơn giản nhất, chỉ bao gồm hai máy, cũng có thể phát hiện ra nhiều vấn đề liên quan đến việc truyền tín hiệu vật lý (physical signal transmission) qua các đường truyền (communication lines).

##### 2.3.1 Mã hóa (Encoding)

Trong kỹ thuật máy tính (computing technology), mã nhị phân (binary code) được sử dụng để biểu diễn dữ liệu. Bên trong máy tính, các số 1 và 0 trong dữ liệu tương ứng với các tín hiệu điện rời rạc (discrete electrical signals).

> **Việc biểu diễn dữ liệu dưới dạng tín hiệu điện hoặc tín hiệu quang học được gọi là mã hóa (encoding).**

Có nhiều phương pháp khác nhau để mã hóa (encoding) các chữ số nhị phân (binary digits), ví dụ: 

- **Phương pháp điện thế (potential method)**, trong đó số 1 tương ứng với một mức điện áp (voltage level) và số 0 tương ứng với một mức khác; 
- **Phương pháp xung (impulse method)**, khi các xung có độ phân cực khác nhau được sử dụng để biểu diễn các chữ số.

Các phương pháp tương tự cũng được áp dụng để mã hóa dữ liệu (data encoding) khi truyền chúng giữa hai máy tính qua các **đường truyền (communication lines)**. Tuy nhiên, các đường truyền này khác biệt so với các đặc điểm của đường truyền bên trong máy tính. Sự khác biệt chính của các đường truyền bên ngoài là chúng có độ dài lớn hơn nhiều và thường xuyên đi qua không gian không được che chắn, dễ bị ảnh hưởng bởi nhiễu điện từ mạnh (strong electromagnetic interference). Điều này dẫn đến những biến dạng đáng kể của các xung hình chữ nhật (rectangular pulses) trên các đường truyền ngoài, ví dụ: các cạnh xung bị "nhòe" (blurring edges), so với các đường truyền bên trong máy tính.

Vì vậy, để nhận dạng đáng tin cậy (reliable recognition) các xung ở đầu nhận của đường truyền, khi truyền dữ liệu trong và giữa các máy tính, không phải lúc nào cũng có thể sử dụng cùng tốc độ và phương pháp mã hóa như nhau. Ví dụ, sự tăng chậm của biên xung (slow rising edge) do tải điện dung cao (high capacitive load) trên đường truyền yêu cầu xung được truyền ở tốc độ thấp hơn, để các biên xung không chồng lấn (overlapping edges), và xung có đủ thời gian đạt đến biên độ yêu cầu.

Trong mạng máy tính (computer networks), cả mã hóa xung (impulse encoding) và dữ liệu rời rạc (discrete data) đều được sử dụng, cũng như một phương pháp biểu diễn dữ liệu khác, không bao giờ được sử dụng bên trong máy tính – **điều chế (modulation)** (xem Hình 2.8). Trong điều chế, thông tin rời rạc được biểu diễn dưới dạng tín hiệu dao động (oscillating signal) của một tần số cụ thể mà đường truyền có thể truyền tốt.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.8.png" alt="Hình 2.8. Ví dụ về cách biểu diễn thông tin rời rạc" width="800">
</p>

Phương pháp mã hóa điện thế (potential encoding) và mã hóa xung (impulse encoding) được áp dụng trên các kênh truyền dẫn chất lượng cao (high-quality channels), trong khi điều chế (modulation) dựa trên tín hiệu dạng sóng hình sin (sinusoidal signals) được ưu tiên sử dụng trong trường hợp kênh truyền gây ra biến dạng đáng kể đối với các tín hiệu được truyền tải. Ví dụ, điều chế thường được sử dụng trong các mạng toàn cầu (global networks) để truyền dữ liệu qua các kênh điện thoại analog (analog telephone channels), vốn được thiết kế để truyền giọng nói dưới dạng analog, và do đó không phù hợp với việc truyền tải trực tiếp các xung tín hiệu (impulse signals).

Phương pháp truyền tín hiệu (signal transmission method) và số lượng dây dẫn (number of wires) trong đường truyền giữa các máy tính cũng ảnh hưởng đáng kể. Để giảm chi phí của đường truyền (communication line cost) trong các mạng, người ta thường cố gắng giảm số lượng dây dẫn, vì vậy, tất cả các bit của một byte hoặc thậm chí nhiều byte được truyền không song song (non-parallel), như bên trong máy tính, mà theo kiểu nối tiếp (sequentially, bit by bit). Đối với cách này, chỉ cần một cặp dây dẫn (single pair of wires).

Một vấn đề khác cần được giải quyết khi truyền tín hiệu là vấn đề **đồng bộ hóa (synchronization)** giữa bộ phát (transmitter) của một máy tính với bộ thu (receiver) của máy tính khác. Trong tổ chức tương tác giữa các mô-đun bên trong một máy tính, vấn đề này được giải quyết rất đơn giản, bởi vì trong trường hợp này, tất cả các mô-đun được đồng bộ hóa với một bộ tạo nhịp chung (common clock generator).

Vấn đề đồng bộ hóa trên đường truyền giữa các máy tính có thể được giải quyết bằng nhiều cách – chẳng hạn, bằng cách trao đổi các xung đồng bộ đặc biệt (synchronization pulses) qua một đường truyền riêng, hoặc bằng cách đồng bộ hóa định kỳ (periodic synchronization) dựa trên các mã hoặc xung đã được định trước, với dạng đặc trưng khác biệt so với các xung tín hiệu dữ liệu.

Mặc dù đã áp dụng các biện pháp (ví dụ: chọn tốc độ truyền dữ liệu phù hợp, thiết kế đường truyền với các đặc tính cụ thể, và phương pháp đồng bộ hóa giữa bộ thu và bộ phát), khả năng một số bit dữ liệu được truyền bị sai lệch (errors) vẫn có thể xảy ra. Để nâng cao độ tin cậy trong trao đổi dữ liệu giữa các máy tính, thông thường, một phương pháp tiêu chuẩn được sử dụng – **kiểm tra tổng (checksum)**, trong đó giá trị của tổng kiểm tra cho mỗi khối byte được truyền qua đường truyền. Trong giao thức truyền dữ liệu (data transmission protocol), thường bao gồm một phần tử bắt buộc gọi là **tín hiệu xác nhận (acknowledgment signal)**, được gửi từ máy nhận (receiver) tới máy phát (transmitter), để xác nhận tính chính xác của dữ liệu được truyền.

---

### **1. Phương pháp điện thế (Potential Method)**

Phương pháp này mã hóa dữ liệu bằng cách sử dụng các mức điện thế khác nhau để biểu diễn các giá trị dữ liệu. 

- **Nguyên lý hoạt động:**  
  - Mỗi mức điện áp cụ thể được ánh xạ đến một giá trị dữ liệu (như 0 hoặc 1 trong hệ nhị phân).
  - Ví dụ: +5V biểu diễn bit `1`, 0V biểu diễn bit `0`.

- **Ưu điểm:**  
  - Đơn giản và dễ triển khai.  
  - Ít tiêu tốn năng lượng.

- **Nhược điểm:**  
  - Nhạy cảm với nhiễu.  
  - Không phù hợp cho truyền dẫn đường dài do suy hao tín hiệu.

---

### **2. Phương pháp xung (Impulse Method)**

Phương pháp này sử dụng các xung tín hiệu để truyền thông tin.

- **Nguyên lý hoạt động:**  
  - Mỗi xung tín hiệu hoặc chuỗi xung được sử dụng để biểu diễn các giá trị dữ liệu.  
  - Ví dụ: Sự xuất hiện của một xung biểu diễn `1`, còn không có xung biểu diễn `0`.

- **Ví dụ cụ thể:**  
  - **Pulse Code Modulation (PCM):** Tín hiệu được mã hóa thành chuỗi các xung dựa trên giá trị của chúng.
  - **Manchester Encoding:** Xung tăng hoặc giảm trong một chu kỳ để biểu diễn các bit khác nhau.

- **Ưu điểm:**  
  - Chống nhiễu tốt hơn phương pháp điện thế.  
  - Dễ dàng nhận biết tín hiệu.

- **Nhược điểm:**  
  - Yêu cầu băng thông lớn hơn để truyền tải.  
  - Cần đồng bộ hóa tốt giữa máy phát và máy thu.

---

### **3. Điều chế (Modulation)**

Phương pháp này mã hóa dữ liệu bằng cách điều chỉnh các đặc tính của sóng mang (carrier wave), như biên độ, tần số, hoặc pha.

- **Các loại điều chế phổ biến:**  
  - **Amplitude Modulation (AM):** Điều chỉnh biên độ của sóng mang theo dữ liệu.  
  - **Frequency Modulation (FM):** Điều chỉnh tần số của sóng mang theo dữ liệu.  
  - **Phase Modulation (PM):** Điều chỉnh pha của sóng mang.  
  - **Quadrature Amplitude Modulation (QAM):** Kết hợp điều chế biên độ và pha để truyền dữ liệu hiệu quả hơn.

- **Ưu điểm:**  
  - Hiệu quả cho truyền tải dữ liệu qua khoảng cách xa (như sóng radio, viễn thông).  
  - Hỗ trợ truyền tín hiệu analog và số.  

- **Nhược điểm:**  
  - Phức tạp hơn trong triển khai.  
  - Dễ bị ảnh hưởng bởi nhiễu và suy giảm tín hiệu nếu không có biện pháp xử lý tốt.

---

### **So sánh chung:**

| Phương pháp       | Đặc điểm chính                                   | Ưu điểm                      | Nhược điểm                     |
|--------------------|------------------------------------------------|------------------------------|--------------------------------|
| Điện thế          | Dựa trên mức điện áp                          | Đơn giản, tiết kiệm năng lượng | Nhạy cảm với nhiễu            |
| Xung              | Sử dụng chuỗi xung để biểu diễn dữ liệu        | Chống nhiễu tốt, dễ nhận biết | Yêu cầu băng thông lớn        |
| Điều chế          | Điều chỉnh sóng mang theo dữ liệu              | Hiệu quả cho truyền xa        | Phức tạp, nhạy cảm với suy hao |



##### 2.3.2 Đặc tính của các kênh vật lý (Characteristics of Physical Channels)

Có một số lượng lớn các đặc tính liên quan đến việc truyền tải lưu lượng (traffic) qua các kênh vật lý (physical channels). Một số đặc tính quan trọng sẽ cần thiết trong thời gian gần đây, chúng ta sẽ xem xét sơ lược ngay bây giờ và sau đó nghiên cứu chúng cùng với một số đặc tính mạng khác một cách chi tiết hơn.

- **Tải được cung cấp (Offered Load)** – đây là lưu lượng dữ liệu (data flow) được gửi từ ứng dụng của người dùng vào mạng, luôn sẵn sàng để nhận dữ liệu. Tải được cung cấp có thể được đặc trưng bởi **tốc độ tạo dữ liệu (data generation rate)** tính bằng bit/giây (bits per second). Đặc tính này mô tả cường độ hoạt động của nguồn thông tin và không phụ thuộc vào tính chất của các kênh vật lý.

- **Thông lượng (Throughput)**, còn được gọi là **dung lượng kênh (channel capacity)**, là tốc độ tối đa (maximum possible rate) để truyền thông tin qua một kênh nhất định. Đặc tính này không liên quan đến tải được cung cấp. Nó phản ánh khả năng tốc độ của mạng, được xác định bởi các tham số của môi trường truyền vật lý (physical transmission medium) cũng như các đặc điểm của phương pháp truyền thông tin rời rạc (selected method of discrete information transmission) trong môi trường đó. Ví dụ, thông lượng của kênh truyền trong mạng Ethernet trên cáp quang là 10 Mbit/s. Đây là giới hạn tối đa đối với sự kết hợp giữa công nghệ Ethernet và môi trường truyền cáp quang. Tuy nhiên, trên cùng một loại cáp quang, có thể thiết kế các hệ thống mã hóa dữ liệu khác, các phương pháp đồng bộ tín hiệu (synchronization methods), và các tham số khác, cho phép có thông lượng cao hơn. Ví dụ, công nghệ Fast Ethernet hỗ trợ truyền dữ liệu với tốc độ tối đa 100 Mbit/s, trong khi công nghệ Gigabit Ethernet – 1000 Mbit/s.

Để phân tích và cấu hình mạng, rất hữu ích khi biết thông tin về thông lượng (throughput) của các thành phần riêng lẻ trong mạng (individual network elements). Do tính chất tuần tự của việc truyền dữ liệu qua các phần tử khác nhau của mạng, thông lượng tổng thể của bất kỳ đường truyền nào trong mạng luôn bằng **giá trị nhỏ nhất** (minimum value) trong số các thông lượng của các phần tử cấu thành đường truyền đó. Để tăng thông lượng của đường truyền tổng hợp, trước tiên cần tập trung vào các phần tử chậm nhất, được gọi là **điểm nghẽn (bottlenecks)**.

- **Tốc độ truyền dữ liệu (Information Rate)**, hay còn gọi là **thông lượng (Throughput)** (cả hai thuật ngữ tiếng Anh đều được sử dụng đồng nghĩa), là tốc độ thực tế (actual rate) của luồng dữ liệu qua mạng hoặc một số phần của mạng. Tốc độ của luồng thông tin, còn được gọi là tốc độ truyền dữ liệu (data transmission rate), được xác định bằng cách chia khối lượng dữ liệu được truyền trong một khoảng thời gian nhất định cho giá trị của khoảng thời gian đó.
  Từ định nghĩa này, rõ ràng rằng đặc tính này luôn là giá trị trung bình (average value). Nó phản ánh cả tốc độ dữ liệu được đưa vào mạng – tải được cung cấp (offered load), cũng như các đặc tính tốc độ của môi trường vật lý (physical medium) – thông lượng của mạng (network capacity). Tốc độ truyền dữ liệu có thể thấp hơn tải được cung cấp, khi dữ liệu trong mạng có thể bị biến dạng hoặc mất mát, hoặc trong trường hợp khác – khi dữ liệu được bộ đệm (buffered data) trước khi truyền qua một kênh nào đó với thông lượng giới hạn.

Một nhóm đặc tính khác của kênh truyền (communication channel) liên quan đến khả năng truyền thông tin qua kênh theo một hoặc hai chiều.

Khi hai máy tính tương tác với nhau, thông thường cần truyền thông tin theo cả hai chiều – từ máy tính **A** đến máy tính **B** và ngược lại. Ngay cả trong trường hợp người dùng chỉ nhận thông tin (ví dụ: tải xuống một tệp nhạc từ Internet) và không truyền đi (ví dụ: gửi email), quá trình trao đổi thông tin vẫn diễn ra ở cả hai chiều. Đơn giản là ngoài luồng dữ liệu chính mà người dùng quan tâm, còn có luồng dữ liệu phụ hỗ trợ theo hướng ngược lại, tạo thành tín hiệu xác nhận (acknowledgment signal) về việc nhận dữ liệu.

Các kênh truyền vật lý được chia thành nhiều loại tùy thuộc vào khả năng truyền thông tin theo cả hai chiều hay không.

- **Kênh song công (Duplex Channel)** cung cấp khả năng truyền đồng thời thông tin theo cả hai chiều. Kênh song công có thể bao gồm hai môi trường vật lý (physical media), mỗi môi trường chỉ được sử dụng để truyền thông tin theo một chiều. Cũng có thể sử dụng một môi trường duy nhất để truyền đồng thời các luồng dữ liệu theo cả hai chiều. Trong trường hợp này, các phương pháp bổ sung được áp dụng để tách từng luồng dữ liệu ra khỏi tín hiệu tổng hợp.

- **Kênh bán song công (Half-Duplex Channel)** cũng cung cấp khả năng truyền thông tin theo cả hai chiều, nhưng không đồng thời mà lần lượt. Nghĩa là trong một khoảng thời gian nhất định, thông tin được truyền theo một hướng, và trong khoảng thời gian tiếp theo – theo hướng ngược lại.

- **Kênh đơn công (Simplex Channel)** chỉ cho phép truyền thông tin theo một chiều. Thường thì một kênh song công được tạo thành từ hai kênh đơn công.


#### 2.4 Vấn đề kết nối nhiều máy tính (Problems of Connecting Multiple Computers)

Trước đây, chúng ta đã xem xét một mạng cơ bản, bao gồm chỉ hai máy tính. Khi kết hợp nhiều máy tính hơn trong một mạng, một loạt các vấn đề mới sẽ phát sinh.

##### 2.4.1 Cấu trúc liên kết của các kết nối vật lý (Topology of Physical Connections)

Khi kết nối một số lượng máy tính (hơn hai) trong mạng, cần phải quyết định cách nối chúng với nhau, hay nói cách khác, lựa chọn cấu hình của các kết nối vật lý, hay Cấu trúc liên kết của chúng.

> **Cấu trúc liên kết mạng (Network Topology)** là cấu hình của một đồ thị (graph), trong đó các đỉnh (vertices) tương ứng với các nút cuối (end nodes) của mạng (ví dụ: máy tính) và thiết bị truyền thông (communication devices) (ví dụ: bộ định tuyến – router), và các cạnh (edges) là các kết nối thông tin vật lý giữa các đỉnh.

Số lượng các phương án cấu hình khả thi tăng mạnh khi số lượng thiết bị được kết nối tăng lên. Ví dụ, nếu có ba máy tính, chúng ta có thể kết nối chúng theo hai cách (hình 2.9, a). Nếu có bốn máy tính, đã có thể đề xuất sáu Cấu trúc liên kết với các cấu hình khác nhau (hình 2.9, b), nếu không tính đến những hạn chế thực tiễn.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.9.png" alt="Hình 2.9. Các kiểu kết nối máy tính" width="800">
</p>

Chúng ta có thể kết nối từng máy tính với mỗi máy tính khác hoặc kết nối chúng theo cách tuần tự, giả định rằng chúng sẽ giao tiếp với nhau bằng cách truyền thông điệp "qua trung gian". Các nút trung gian phải được trang bị các công cụ đặc biệt cho phép chúng thực hiện hoạt động trung gian cụ thể này. Một nút trung gian có thể là một máy tính đa năng hoặc một thiết bị chuyên dụng.

Việc lựa chọn Cấu trúc liên kết kết nối có ảnh hưởng đáng kể đến các đặc tính của mạng. Ví dụ, việc có nhiều đường kết nối giữa các nút sẽ tăng độ tin cậy của mạng và cho phép phân phối tải giữa các kênh khác nhau. Sự đơn giản trong việc kết nối các nút mới, đặc trưng của một số Cấu trúc liên kết, làm cho mạng dễ dàng **mở rộng (scalable)**. Các cân nhắc kinh tế thường dẫn đến việc lựa chọn Cấu trúc liên kết với tổng chiều dài đường kết nối tối thiểu.

Trong số nhiều cấu hình khả thi, có sự khác biệt giữa **mạng kết nối đầy đủ (fully connected)** và **mạng không kết nối đầy đủ (partially connected)**.


**Cấu trúc liên kết kết nối đầy đủ (Fully Connected Topology)** tương ứng với một mạng mà mỗi máy tính được kết nối trực tiếp với tất cả các máy tính khác (hình 2.10, a). Mặc dù đơn giản về mặt logic, kiểu kết nối này lại cồng kềnh và không hiệu quả trong thực tế. Thực sự, trong trường hợp này, mỗi máy tính trong mạng cần phải có một số lượng lớn các cổng giao tiếp để kết nối với tất cả các máy tính khác trong mạng. Đối với mỗi cặp máy tính, cần có một đường truyền vật lý riêng (trong một số trường hợp, thậm chí cần hai đường, nếu không thể sử dụng đường truyền này cho truyền dữ liệu hai chiều).

Cấu trúc liên kết kết nối đầy đủ hiếm khi được sử dụng trong các mạng lớn, vì với số nút là **N**, cần đến **N(N-1)/2** đường truyền vật lý hai chiều, nghĩa là có sự phụ thuộc bậc hai vào số lượng nút. Thông thường, loại Cấu trúc liên kết này chỉ được sử dụng trong các cụm máy tính (clusters) hoặc trong các mạng nhỏ, nơi chỉ có một số lượng nhỏ máy tính được kết nối.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.10.png" alt="Hình 2.10. Các loại cấu trúc mạng phổ biến" width="800">
</p>


Tất cả các biến thể khác đều dựa trên **Cấu trúc liên kết không đầy đủ (Non-Fully Connected Topology)**, trong đó việc trao đổi dữ liệu giữa hai máy tính có thể yêu cầu chuyển tiếp dữ liệu qua các nút khác trong mạng.


**Cấu trúc liên kết mạng lưới (Mesh Topology)** được tạo ra từ **Cấu trúc liên kết đầy đủ (Full Topology)** bằng cách loại bỏ một số liên kết (Hình 2.10, b). Cấu trúc liên kết mạng lưới cho phép kết nối một số lượng lớn các máy tính và thường được sử dụng cho các mạng lớn.

Trong mạng có **Cấu trúc liên kết vòng (Ring Topology)** (Hình 2.10, c), dữ liệu được truyền đi trong một vòng lặp từ một máy tính tới máy tính khác. Ưu điểm chính của vòng lặp là nó tự nhiên đảm bảo khả năng dự phòng kết nối. Thực tế, bất kỳ nút nào trong vòng cũng được kết nối hai chiều – theo chiều kim đồng hồ và ngược lại. Ngoài ra, vòng lặp cung cấp cấu hình thuận tiện để tổ chức việc quay lại dữ liệu, giúp đảm bảo rằng dữ liệu không bị mất. Tuy nhiên, nhược điểm là nếu một nút trong vòng bị hỏng hoặc kết nối bị ngắt, toàn bộ mạng sẽ bị ảnh hưởng.

**Cấu trúc liên kết sao (Star Topology)** (Hình 2.10, d) được hình thành khi tất cả các máy tính kết nối trực tiếp với một thiết bị trung tâm gọi là **hub** hoặc **switch**. Trong trường hợp này, thông tin từ bất kỳ máy tính nào cũng phải thông qua thiết bị trung tâm. Nhược điểm của Cấu trúc liên kết này là chi phí cao cho việc trang bị thiết bị trung tâm và hạn chế số lượng cổng kết nối trên hub.

Trong một số trường hợp, việc xây dựng mạng sử dụng **Cấu trúc liên kết cây (Tree Topology)** có ý nghĩa, trong đó các nút trung tâm của các cấu trúc sao được kết nối với nhau theo dạng cây phân cấp (Hình 2.10, e). Cấu trúc liên kết cây rất phổ biến trong mạng LAN và mạng WAN hiện nay.

Một trường hợp đặc biệt khác là **Cấu trúc liên kết bus (Bus Topology)** (Hình 2.10, f), trong đó một dây cáp duy nhất được sử dụng như một đường dẫn chính, và tất cả các máy tính kết nối với dây này. Tuy nhiên, điểm yếu chính của Cấu trúc liên kết bus là nếu dây chính bị lỗi, toàn bộ mạng sẽ bị ảnh hưởng.

Cuối cùng, có **Cấu trúc liên kết hỗn hợp (Mixed Topology)**, trong đó các phần của mạng sử dụng các Cấu trúc liên kết khác nhau, kết hợp linh hoạt để tạo thành một hệ thống phù hợp với yêu cầu cụ thể của mạng.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.11.png" alt="Hình 2.11. Cấu trúc mạng hỗn hợp." width="900">
</p>
<p align="center"><b>Hình 2.11. Cấu trúc mạng hỗn hợp.</b></p>

---


##### 2.4.2 Định địa chỉ các nút mạng

Một vấn đề khác cần phải tính đến khi kết nối ba hoặc nhiều máy tính là vấn đề định địa chỉ (addressing), cụ thể hơn là định địa chỉ các giao diện mạng của chúng. Một máy tính có thể có nhiều giao diện mạng. Ví dụ, để tạo một cấu trúc liên kết đầy đủ với **N** máy tính, cần mỗi máy tính có **N - 1** giao diện.

Theo số lượng giao diện được định địa chỉ, địa chỉ có thể được phân loại như sau:

- **Địa chỉ đơn nhất (Unicast)**: Được sử dụng để xác định một giao diện cụ thể duy nhất.
- **Địa chỉ nhóm (Multicast)**: Xác định đồng thời nhiều giao diện, do đó dữ liệu được đánh dấu với địa chỉ nhóm sẽ được chuyển đến tất cả các nút thuộc về nhóm đó.
- **Dữ liệu gửi đến địa chỉ quảng bá (Broadcast)**: Cần được chuyển đến tất cả các nút trong mạng.
- **Địa chỉ bất kỳ (Anycast)**: Tương tự như địa chỉ nhóm, nhưng dữ liệu gửi tới địa chỉ này chỉ được chuyển đến một nút trong nhóm, thường là nút gần nhất theo một số quy tắc định tuyến.


**Địa chỉ có thể là dạng số (ví dụ, 129.26.255.255 hoặc 81.1a.ff.ff) và dạng ký hiệu (site.domen.ru, willi-winki).**

Địa chỉ dạng ký hiệu (tên gọi) được thiết kế để con người dễ ghi nhớ và vì vậy thường mang ý nghĩa. Đối với các mạng lớn, tên gọi dạng ký hiệu có thể có cấu trúc phân cấp, ví dụ: ftp-arch1.ucl.ac.uk. Địa chỉ này nói rằng, máy tính này hỗ trợ kho lưu trữ ftp trong mạng của một trong các trường cao đẳng thuộc Đại học London (University College London – ucl) và mạng này thuộc về nhánh học thuật (ac) của Internet ở Vương quốc Anh (United Kingdom – uk). Khi làm việc trong mạng nội bộ của Đại học London, tên dạng ký hiệu dài như vậy là dư thừa, và thay vì nó, bạn có thể sử dụng tên gọi dạng ký hiệu ngắn hơn như ftp-arch1. Mặc dù tên gọi dạng ký hiệu thuận tiện hơn cho con người, việc truyền chúng trong mạng lại không kinh tế vì có định dạng thay đổi và tiềm năng độ dài lớn.

**Tập hợp tất cả các địa chỉ được cho phép trong phạm vi một sơ đồ định địa chỉ cụ thể được gọi là không gian địa chỉ (addressing space).** Không gian địa chỉ có thể có tổ chức phẳng (linear) hoặc tổ chức phân cấp (hierarchical).

Với **tổ chức phẳng (flat organization)**, tập hợp các địa chỉ không có cấu trúc phân cấp nào. Một ví dụ về địa chỉ số dạng phẳng là **địa chỉ MAC (MAC address)**, được thiết kế để nhận diện duy nhất các giao diện mạng trong mạng cục bộ (local networks). Địa chỉ này chỉ được sử dụng ở cấp phần cứng (hardware), vì vậy nó thường được tạo ra để gọn nhất có thể và được ghi dưới dạng số nhị phân hoặc số thập lục phân, ví dụ: 0080105e24a8. Khi thiết lập địa chỉ MAC, không cần thêm bất kỳ công việc nào vì chúng thường được tích hợp sẵn trong phần cứng của nhà sản xuất, do đó, chúng còn được gọi là **địa chỉ phần cứng (hardware address)**. Sử dụng địa chỉ phẳng là một giải pháp cố định — khi thay đổi phần cứng, chẳng hạn như bộ chuyển đổi mạng, địa chỉ của giao diện mạng cũng thay đổi.

**Với tổ chức phân cấp (hierarchical organization)**, không gian địa chỉ được cấu trúc dưới dạng các nhóm lồng nhau, lần lượt thu hẹp phạm vi địa chỉ, và cuối cùng xác định các giao diện mạng riêng biệt. Ví dụ, trong cấu trúc địa chỉ không gian ba cấp, địa chỉ của nút cuối cùng có thể được xác định bởi ba thành phần:

- **Định danh nhóm (K)**, mà nút đó thuộc về;
- **Định danh nhóm con (L)**;
- **Định danh nút (n)**, xác định duy nhất nút trong nhóm con.

Định địa chỉ phân cấp trong nhiều trường hợp tỏ ra hợp lý hơn so với tổ chức phẳng. Trong các mạng lớn với hàng nghìn nút, sử dụng địa chỉ phẳng dẫn đến chi phí lớn — các nút cuối và thiết bị truyền thông phải xử lý các bảng địa chỉ lớn chứa hàng nghìn mục. Ngược lại, hệ thống định địa chỉ phân cấp cho phép trong quá trình di chuyển dữ liệu chỉ sử dụng thành phần lớn nhất của địa chỉ (ví dụ, định danh nhóm K), sau đó (để định vị địa chỉ chi tiết hơn) sử dụng thành phần kế tiếp theo thứ bậc (L) và cuối cùng — phần nhỏ nhất (n).

Một ví dụ tiêu biểu của địa chỉ số phân cấp là địa chỉ **IP (IP address)**. Trong đó hỗ trợ cấu trúc hai cấp, địa chỉ được chia thành phần lớn hơn — số mạng (K) và phần nhỏ hơn — số nút (n). Sự phân chia này cho phép chuyển tiếp dữ liệu dựa trên cơ sở số mạng mà không cần phải xác định số nút cho đến khi thông tin đã đến mạng mong muốn — tương tự như việc sử dụng mã bưu chính chỉ sau khi thư được chuyển đến thành phố cần đến.

Trong thực tế, thường áp dụng đồng thời nhiều sơ đồ định địa chỉ, để giao diện mạng của máy tính có thể có nhiều địa chỉ hoặc tên cùng lúc. Mỗi địa chỉ được sử dụng trong trường hợp mà loại định địa chỉ đó thuận tiện nhất. Và để chuyển đổi địa chỉ từ loại này sang loại khác, các giao thức hỗ trợ đặc biệt được sử dụng, được gọi là **giao thức phân giải địa chỉ (address resolution protocols)**.

Người dùng định địa chỉ máy tính bằng các tên ký hiệu phân cấp, những tên này tự động được thay thế trong các thông báo được truyền qua mạng bằng các địa chỉ số phân cấp. Với những địa chỉ số này, các thông báo được chuyển từ một mạng sang mạng khác, và sau khi được chuyển đến mạng đích, thay vì địa chỉ số phân cấp, địa chỉ phần cứng phẳng được sử dụng. Vấn đề thiết lập sự tương thích giữa các địa chỉ thuộc các kiểu khác nhau có thể được giải quyết bằng cách tập trung hoặc phân tán.

**Với cách tiếp cận tập trung**, một hoặc nhiều máy tính (máy chủ tên - name server) trong mạng được phân bổ để lưu trữ bảng ánh xạ các tên ký hiệu và các địa chỉ số. Tất cả các máy tính khác sẽ gửi yêu cầu tới máy chủ tên để tra cứu địa chỉ số của máy tính cần thiết thông qua tên ký hiệu.

**Với cách tiếp cận phân tán**, mỗi máy tính tự lưu trữ các địa chỉ được chỉ định thuộc các loại khác nhau. Khi một máy tính cần xác định địa chỉ phần cứng phẳng dựa trên địa chỉ số phân cấp của một máy tính khác, nó sẽ gửi một yêu cầu quảng bá (broadcast) vào mạng. Tất cả các máy tính trong mạng so sánh yêu cầu này với địa chỉ của chính nó. Máy tính có sự trùng khớp sẽ gửi phản hồi chứa địa chỉ phần cứng được yêu cầu. Cơ chế này được sử dụng trong **giao thức phân giải địa chỉ (Address Resolution Protocol - ARP)** thuộc bộ giao thức TCP/IP.

Ưu điểm của cách tiếp cận phân tán là cho phép loại bỏ việc chỉ định một máy tính đặc biệt làm máy chủ tên, vốn thường đòi hỏi cấu hình thủ công bảng ánh xạ địa chỉ. Nhược điểm là yêu cầu phải gửi các thông báo quảng bá, làm tăng tải cho mạng. Vì vậy, cách tiếp cận phân tán thường được áp dụng trong các mạng nhỏ, trong khi cách tiếp cận tập trung phù hợp với mạng lớn.

Cho đến nay, chúng ta đã nói về các địa chỉ của giao diện mạng, máy tính và các thiết bị truyền thông, nhưng mục tiêu cuối cùng của dữ liệu được truyền qua mạng là các tiến trình (process) hoạt động trên các thiết bị này và thực hiện các nhiệm vụ cụ thể. Do đó, địa chỉ được chỉ định cho các tiến trình, cùng với thông tin xác định giao diện thiết bị, phải chỉ rõ máy tính nào được gửi dữ liệu. Rõ ràng, để đảm bảo tính duy nhất của địa chỉ trong phạm vi mạng, cần thêm thông tin. Một ví dụ về các địa chỉ tiến trình là **số cổng TCP và UDP (TCP and UDP port numbers)** trong bộ giao thức TCP/IP.

##### 2.4.3 Chuyển mạch (Switching)

Giả sử các máy tính được liên kết vật lý với nhau theo một cấu trúc mạng nhất định, và hệ thống định địa chỉ đã được chọn. Tuy nhiên, vẫn còn một câu hỏi chưa được giải quyết: Làm cách nào để truyền dữ liệu giữa các nút cuối? Nhiệm vụ này trở nên đặc biệt phức tạp đối với mạng có cấu trúc liên kết không hoàn toàn kết nối, khi việc trao đổi dữ liệu giữa bất kỳ cặp nút cuối nào (người dùng) thường phải thông qua các nút chuyển tiếp.

**Kết nối các nút cuối thông qua một mạng các nút chuyển tiếp được gọi là chuyển mạch (switching). Chuỗi các nút nằm trên đường đi từ người gửi đến người nhận tạo thành một tuyến đường (route).**

Ví dụ, trong mạng được minh họa ở Hình 2.12, các nút (nodes) 2 và 4, không được kết nối trực tiếp, buộc phải truyền dữ liệu qua các nút chuyển tiếp (transit nodes), chẳng hạn như các nút 1 và 5. Nút 1 phải thực hiện việc truyền dữ liệu giữa các giao diện (interfaces) A và B, còn nút 5 — giữa các giao diện F và B. Trong trường hợp này, tuyến đường (route) là chuỗi sau: 2-1-5-4, trong đó 2 là nút gửi (sending node), 1 và 5 là các nút chuyển tiếp (transit nodes), và 4 là nút nhận (receiving node).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.12.png" alt="Hình 2.12. Chuyển mạch người dùng qua mạng các nút trung gian" width="900">
</p>

---

#### 2.5 Nhiệm vụ tổng quát của chuyển mạch (General task of switching)

Ở dạng tổng quát nhất, nhiệm vụ chuyển mạch (switching) có thể được trình bày dưới dạng các nhiệm vụ cụ thể có liên quan chặt chẽ sau:

1. Xác định các luồng thông tin (information flows), mà đối với chúng cần thiết lập tuyến đường (routes).
2. Định tuyến các luồng (routing of flows) — thiết lập các tuyến đường (route creation).
3. Chuyển tiếp các luồng (forwarding of flows), tức là nhận dạng các luồng và chuyển mạch cục bộ (local switching) của chúng tại mỗi nút chuyển tiếp (transit node).
4. Ghép kênh và tách kênh các luồng (multiplexing and demultiplexing of flows).

---

##### 2.5.1 Xác định các luồng thông tin (Defining information flows)

Rõ ràng, qua một nút chuyển tiếp (transit node) có thể đi qua nhiều tuyến đường (routes). Ví dụ, qua nút 5 (xem Hình 2.12), đi qua ít nhất tất cả dữ liệu được nút 4 gửi tới từng nút còn lại, cũng như tất cả dữ liệu được gửi đến các nút 3, 4 và 10. Nút chuyển tiếp (transit node) phải có khả năng **nhận diện (recognize)** các luồng dữ liệu (data flows) đến nó, để đảm bảo việc truyền mỗi luồng đến đúng giao diện (interface) của nó, dẫn đến nút cần thiết, và có thể, chọn cách xử lý cụ thể cho luồng đó.

**Luồng thông tin (Information flow)**, hay **luồng dữ liệu (data flow)**, là chuỗi liên tục của các dữ liệu được liên kết với nhau bởi tập hợp các đặc điểm chung, giúp phân biệt dữ liệu này khỏi luồng dữ liệu mạng tổng thể.

Ví dụ, một luồng có thể được xác định là tất cả dữ liệu đến từ một máy tính; đặc điểm chung trong trường hợp này là địa chỉ nguồn (source address). Những dữ liệu này có thể đại diện cho một tập hợp các luồng con (subflows), mỗi luồng con được phân biệt bởi địa chỉ đích (destination address). Cuối cùng, mỗi luồng con này, lần lượt, có thể được chia thành các luồng con nhỏ hơn, phát sinh từ các ứng dụng mạng khác nhau — thư điện tử (email), sao chép tệp tin (file copying), hoặc máy chủ web (web server). Dữ liệu tạo thành luồng có thể được biểu diễn dưới dạng chuỗi các đơn vị thông tin khác nhau — gói tin (packets), khung (frames), hoặc ô (cells).

---

**Lưu ý (Note)**

Trong tài liệu tiếng Anh, đối với các luồng dữ liệu (data flows) được truyền với tốc độ đều (constant speed) và không đều (variable speed), thường sử dụng các thuật ngữ khác nhau — tương ứng là **data stream** và **data flow**. Ví dụ, khi truyền tải một trang web qua Internet, tải trọng được truyền đại diện cho một luồng dữ liệu không đều (variable data flow), trong khi phát nhạc từ các trạm phát thanh qua Internet là luồng dữ liệu đều (constant data stream). Đối với các mạng truyền dữ liệu (data transmission networks), đặc trưng là tốc độ truyền không đều, vì vậy, trong phần lớn các trường hợp, thuật ngữ "luồng dữ liệu (data flow)" sẽ được hiểu là luồng dữ liệu không đều (variable data flow), và chỉ chỉ ra đặc tính đều đặn của quá trình này khi điều đó cần được nhấn mạnh.

---


Rõ ràng rằng, trong chuyển mạch (switching), địa chỉ đích (destination address) của dữ liệu đóng vai trò là một đặc điểm bắt buộc (mandatory attribute). Dựa trên đặc điểm này, toàn bộ luồng dữ liệu (data flow) đi vào nút chuyển tiếp (transit node) được chia thành các luồng con (subflows), mỗi luồng trong số đó được truyền tới một giao diện (interface) phù hợp với tuyến đường (route) đã định trước.

Địa chỉ nguồn (source address) và đích (destination address) xác định luồng dữ liệu cho cặp nút cuối (end nodes) tương ứng. Tuy nhiên, thường thì việc biểu diễn luồng dữ liệu dưới dạng một số luồng con (subflows) là hữu ích hơn, và đối với mỗi luồng con, có thể cần thiết lập một tuyến đường đặc biệt. Hãy xem xét một ví dụ khi giữa một cặp nút cuối (end nodes) có một số ứng dụng mạng (network applications) đang hoạt động, mỗi ứng dụng đều đưa ra các yêu cầu đặc thù đối với mạng. Trong trường hợp này, định tuyến (routing) của luồng dữ liệu phải được thực hiện dựa trên tính chất của dữ liệu được truyền, ví dụ, đối với máy chủ tệp (file server), điều quan trọng là các khối dữ liệu lớn phải được chuyển qua các kênh có khả năng truyền tải cao (high-throughput channels), trong khi hệ thống quản lý (management systems), gửi các thông điệp ngắn vào mạng, yêu cầu xử lý ngay lập tức với độ trễ (latency) thấp nhất. Ngoài ra, thậm chí đối với dữ liệu có cùng yêu cầu mạng, có thể thiết lập nhiều tuyến đường để nhờ sự song song (parallelization) mà tăng tốc độ truyền tải.

Cũng có thể thực hiện một thao tác ngược lại với việc phân chia các luồng con (subflows) — đó là **gộp luồng (aggregation of flows)**. Thao tác này thường được thực hiện trên các tuyến chính của mạng (network backbones), nơi truyền tải một lượng lớn các luồng cá nhân (individual flows). Việc gộp các luồng có cùng một phần tuyến đường (route) qua mạng giúp giảm số lượng luồng mà các nút trung gian (intermediate nodes) phải xử lý, bởi vì các luồng đã được gộp lại sẽ được mô tả như một luồng duy nhất. Kết quả là giảm tải cho các nút trung gian của mạng và tăng hiệu suất (performance) của chúng.

Các đặc điểm của luồng (flow attributes) có thể mang ý nghĩa **toàn cầu (global)** hoặc **cục bộ (local)** — trong trường hợp đầu tiên, chúng xác định luồng trên phạm vi toàn mạng, trong khi trường hợp thứ hai là trong phạm vi của một nút chuyển tiếp (transit node). Một cặp địa chỉ xác định (identifying addresses) của các nút cuối (end nodes) là một ví dụ về đặc điểm toàn cầu (global attribute). Một đặc điểm cục bộ (local attribute), định nghĩa luồng trong phạm vi thiết bị, có thể là số (identifier) của giao diện (interface) mà dữ liệu đã đến.

Ví dụ, quay lại Hình 2.12, nút 1 có thể được thiết lập để truyền tất cả dữ liệu đến giao diện B, mà chúng nhận từ giao diện A, và đến giao diện C, mà chúng nhận từ giao diện D. Quy tắc này cho phép phân biệt luồng dữ liệu của nút 2 khỏi luồng dữ liệu của nút 7 và định tuyến chúng qua các nút chuyển tiếp khác nhau trong mạng. Trong trường hợp này, luồng của nút 2 sẽ qua nút 5, còn luồng của nút 7 sẽ qua nút 8.

**Nhãn luồng (Flow label)** là một loại đặc điểm (attribute) đặc biệt. Nó đại diện cho một số cụ thể mang theo tất cả dữ liệu của luồng (data flow). **Nhãn toàn cầu (Global label)** được gán cho dữ liệu của luồng và không thay đổi giá trị trên toàn bộ đường đi từ nút nguồn (source node) đến nút đích (destination node), do đó xác định duy nhất luồng trong phạm vi mạng (network). Trong một số công nghệ, **nhãn cục bộ (Local label)** của luồng được sử dụng, thay đổi động (dynamically) giá trị của nó trong quá trình truyền dữ liệu từ một nút đến nút khác.

Như vậy, việc nhận diện luồng (flow recognition) trong quá trình chuyển mạch (switching) được thực hiện dựa trên các đặc điểm (attributes), trong đó ngoài địa chỉ đích (destination address) bắt buộc, có thể có các đặc điểm khác — chẳng hạn, như các định danh ứng dụng (application identifiers).

---

##### 2.5.2 Định tuyến (Routing)

Nhiệm vụ định tuyến bao gồm hai công việc chính:

- Xác định tuyến đường (route determination);
- Thông báo mạng (network notification) về tuyến đường đã chọn.

**Xác định tuyến đường (Determine the route)** có nghĩa là chọn thứ tự các nút chuyển tiếp (transit nodes) và giao diện (interfaces) của chúng, qua đó cần truyền dữ liệu để đến địa chỉ đích (destination address). Xác định tuyến đường là một nhiệm vụ phức tạp, đặc biệt khi cấu hình mạng (network configuration) có nhiều đường đi giữa cặp giao diện mạng (network interfaces) đang tương tác. Thông thường, việc chọn sẽ dừng lại ở một tuyến đường **tối ưu (optimal)** theo một số tiêu chí định tuyến (routing criteria).

Các tiêu chí tối ưu (optimization criteria) có thể bao gồm, ví dụ:

- Băng thông (bandwidth) và mức tải của các kênh liên lạc (link load);
- Độ trễ (latency) trong các kênh truyền dẫn (transmission channels);
- Số lượng nút trung gian (intermediate nodes);
- Độ tin cậy (reliability) của các kênh và nút chuyển tiếp (transit nodes).

Tuyến đường (route) có thể được xác định theo cách thực nghiệm (empirical) hoặc "thủ công" (manual) bởi quản trị viên mạng (network administrator) dựa trên nhiều cân nhắc khác nhau, thường không được chính thức hóa. Trong số các động cơ thúc đẩy việc lựa chọn đường đi có thể bao gồm: các yêu cầu đặc biệt từ mạng đối với các loại ứng dụng (applications) khác nhau, quyết định truyền tải lưu lượng (traffic) qua mạng của một nhà cung cấp dịch vụ (service provider) cụ thể, dự đoán về tải cao điểm (peak loads) trên một số kênh mạng (network channels), và các cân nhắc về bảo mật (security).

Tuy nhiên, phương pháp thực nghiệm để xác định tuyến đường không phù hợp với các mạng lớn có cấu trúc liên kết phức tạp (complex topology). Trong trường hợp này, các phương pháp tự động (automatic methods) để xác định tuyến đường được sử dụng. Để thực hiện điều này, các nút cuối (end nodes) và các thiết bị mạng khác được trang bị các công cụ phần mềm (software tools) đặc biệt, giúp tổ chức trao đổi các thông điệp dịch vụ (service messages), cho phép mỗi nút tạo ra một "mô hình" (representation) về mạng. Sau đó, dựa trên dữ liệu thu thập được thông qua các phương pháp phần mềm, các tuyến đường hợp lý (rational routes) được xác định.

Khi chọn tuyến đường, người ta thường chỉ xem xét thông tin về cấu trúc liên kết mạng (network topology). Phương pháp này được minh họa trong Hình 2.13. Để truyền tải lưu lượng giữa các nút cuối A và C, có hai tuyến đường thay thế: A-1-2-3-C và A-1-3-C. Nếu chỉ tính đến cấu trúc liên kết, lựa chọn rõ ràng là tuyến A-1-3-C, vì tuyến này có ít nút trung gian (transit nodes) hơn.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.13.png" alt="Hình 2.13. Lựa chọn tuyến đường" width="900">
</p>
<p align="center"><b>Hình 2.13. Lựa chọn tuyến đường (route)</b></p>

Giải pháp được tìm thấy bằng cách tối thiểu hóa tiêu chí (criterion), trong trường hợp này là chiều dài của tuyến đường (route length), được đo bằng số lượng nút chuyển tiếp (transit nodes). Tuy nhiên, có thể lựa chọn của chúng ta không phải là tốt nhất. Trong hình minh họa, các kênh 1-2 và 2-3 có băng thông (bandwidth) 100 Mbit/s mỗi kênh, trong khi kênh 1-3 chỉ có 10 Mbit/s. Để thông tin của chúng ta được truyền qua mạng với tốc độ tối đa có thể, cần chọn tuyến đường A-1-2-3-C, mặc dù tuyến này đi qua nhiều nút trung gian hơn. Nói cách khác, trong trường hợp này, tuyến A-1-2-3-C tỏ ra "ngắn hơn" về mặt hiệu quả.

Đánh giá trừu tượng về "khoảng cách" giữa hai nút trong mạng được gọi là **metric**. Ví dụ, để đo chiều dài của tuyến đường, có thể sử dụng các metric khác nhau — số lượng các nút chuyển tiếp (transit nodes), độ dài vật lý (physical length) của tuyến đường, hoặc thậm chí chi phí (cost) của nó tính bằng giá trị tiền tệ. Để xây dựng metric, khi tính đến băng thông (bandwidth), thường sử dụng cách tiếp cận sau: độ dài của mỗi đoạn kênh (channel segment) được đặc trưng bởi giá trị nghịch đảo của băng thông. Để làm việc với các số nguyên, giá trị này được nhân với một hằng số cố định lớn. Ví dụ, nếu chọn hằng số cố định là 100 Mbit/s, metric của kênh 1-2 và 2-3 sẽ là 1, trong khi metric của kênh 1-3 là 10. Metric của tuyến đường bằng tổng metric của tất cả các kênh cấu thành, do đó phần đường A-1-2-3 có metric là 2, trong khi phần thay thế A-1-3 có metric là 10. Chúng ta chọn tuyến đường "ngắn hơn," nghĩa là A-1-2-3-C.


Các phương pháp đã mô tả để lựa chọn tuyến đường (route selection) không tính đến mức độ tải hiện tại (current load) của các kênh lưu lượng (traffic channels). Dùng phép so sánh với giao thông ô tô, có thể nói rằng chúng ta chọn tuyến đường dựa trên bản đồ, tính đến số lượng thành phố trung gian và độ rộng đường (tương tự như băng thông của kênh - bandwidth), bỏ qua thông tin về các vụ tắc đường qua đài phát thanh hoặc truyền hình. Vì vậy, giải pháp của chúng ta có thể không phải là tốt nhất, khi tuyến đường A-1-2-3-C đã được tải nặng với nhiều luồng (flows), còn tuyến đường A-1-3-C thì gần như không có lưu lượng.

Sau khi tuyến đường được xác định (bằng tay hoặc tự động), cần thông báo (notify) về tuyến đường này cho tất cả các thiết bị trong mạng. Một thông điệp (message) về tuyến đường phải cung cấp cho mỗi thiết bị trung gian (intermediate device) thông tin như sau: "Mỗi khi dữ liệu thuộc về một luồng (flow) được gửi đến thiết bị, chúng cần được truyền tiếp trên giao diện (interface) i/f1." Mỗi thông điệp như vậy về tuyến đường được xử lý bởi thiết bị trung gian, kết quả là một mục mới được tạo trong **bảng chuyển mạch (switching table)** (còn gọi là **bảng định tuyến - routing table**) của thiết bị này. Trong bảng này, một đặc điểm cục bộ (local attribute) của luồng (ví dụ, số giao diện đầu vào hoặc địa chỉ đích - destination address) được liên kết với giao diện đầu ra (output interface), nơi mà thiết bị phải truyền dữ liệu liên quan đến luồng đó.

Bảng 2.1 là một đoạn của bảng chuyển mạch (switching table), chứa mục được tạo dựa trên thông điệp về yêu cầu truyền luồng k trên giao diện i/f1.



**Bảng 2.1. Mẫu bảng chuyển mạch**  

| **Đặc điểm luồng**            | **Hướng truyền dữ liệu (số giao diện và/hoặc địa chỉ của nút tiếp theo)** |
|-------------------------------|--------------------------------------------------------------------------|
| n = (DA, SA, A)               | if/1                                                                    |

- **DA**: Địa chỉ đích (Destination Address).  
- **SA**: Địa chỉ nguồn (Source Address).  
- **A**: Thuộc tính khác của luồng dữ liệu.  

Trong bảng này, các đặc điểm (attributes) của luồng (flow) được sử dụng bao gồm địa chỉ đích (**DA - Destination Address**), địa chỉ nguồn (**SA - Source Address**) và loại ứng dụng (**A - Application**) tạo ra các gói dữ liệu của luồng.

Thông báo (notification) đến các thiết bị trung gian (transit devices) trên tuyến đường được chọn, cũng như việc xác định tuyến đường (route determination), có thể được thực hiện thủ công (manual) hoặc tự động (automatic). Quản trị viên mạng (network administrator) có thể cố định tuyến đường bằng cách cấu hình thiết bị ở chế độ thủ công, ví dụ: cứng hóa kết nối giữa một số cặp giao diện đầu vào và đầu ra trong thời gian dài (giống như cách hoạt động của các **bảng chuyển mạch điện thoại - telephone switchboards** trong các bộ chuyển mạch đầu tiên). Ngoài ra, thiết bị cũng có thể tự động tạo và ghi các mục vào bảng chuyển mạch (switching table) theo sáng kiến riêng của nó.

Tuy nhiên, do cấu trúc liên kết mạng (network topology) và các luồng thông tin (information flows) có thể thay đổi (ví dụ: các nút bị lỗi hoặc các nút trung gian mới xuất hiện, địa chỉ thay đổi, hoặc luồng mới được xác định), việc xác định linh hoạt tuyến đường và gán tuyến đường đòi hỏi phải phân tích liên tục trạng thái mạng (network state) và cập nhật các tuyến đường cũng như bảng chuyển mạch. Trong các trường hợp như vậy, nhiệm vụ thiết lập tuyến đường, thông thường, không thể được giải quyết mà không có các công cụ phần mềm (software tools) và phần cứng (hardware tools) phức tạp đủ mức.

---

##### 2.5.3 Chuyển tiếp dữ liệu (Data forwarding)

Vậy là, các tuyến đường (routes) đã được xác định, các mục tương ứng đã được ghi vào bảng của tất cả các nút trung gian (transit nodes), và mọi thứ đã sẵn sàng để thực hiện thao tác chính — truyền dữ liệu giữa các thuê bao (subscribers), hay còn gọi là **chuyển mạch thuê bao (subscriber switching)**.

Đối với mỗi cặp thuê bao, thao tác này có thể bao gồm một số (tùy thuộc vào số lượng nút trung gian) thao tác chuyển mạch cục bộ (local switching operations). Trước hết, thiết bị gửi phải đưa dữ liệu lên giao diện (interface) của nó, nơi bắt đầu tuyến đường đã xác định. Tất cả các nút trung gian phải thực hiện tương ứng việc "chuyển" dữ liệu từ một giao diện của chúng sang giao diện khác, hay nói cách khác, thực hiện **chuyển mạch giao diện (interface switching)**. Một thiết bị, với chức năng chính là thực hiện chuyển mạch, được gọi là **bộ chuyển mạch (switch)**. Trong Hình 2.14, một bộ chuyển mạch được minh họa, thực hiện chuyển đổi các luồng thông tin (information flows) giữa bốn giao diện của nó.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.14.png" alt="Hình 2.14. Bộ chuyển mạch (Switch)" width="900">
</p>
<p align="center"><b>Hình 2.14. Bộ chuyển mạch (Switch)</b></p>

**Giao diện của bộ chuyển mạch (Switch interface)** (còn được gọi là **cổng - port**) là một mô-đun vật lý, bao gồm bộ thu (receiver) và bộ phát (transmitter). Trong trường hợp bộ phát và bộ thu hoạt động trên một kênh truyền song công (duplex communication channel), chúng hoạt động độc lập với nhau, đảm bảo truyền dữ liệu đồng thời theo cả hai hướng. Đôi khi, phần nhận của giao diện được gọi là **giao diện đầu vào (input interface)**, và phần phát được gọi là **giao diện đầu ra (output interface)**.

Trước khi thực hiện chuyển mạch (switching), bộ chuyển mạch phải nhận diện luồng (flow). Để làm điều này, bộ chuyển mạch cố gắng tìm kiếm đặc điểm của bất kỳ luồng nào trong bảng chuyển mạch (switching table) của nó, dựa trên dữ liệu đến. Nếu có sự trùng khớp, dữ liệu này sẽ được chuyển đến giao diện đã được xác định cho nó trong tuyến đường (route).

Bộ chuyển mạch (switch) có thể là một thiết bị chuyên dụng (specialized device) hoặc một máy tính đa năng (universal computer) với cơ chế chuyển mạch phần mềm (software switching mechanism) tích hợp sẵn, trong trường hợp này bộ chuyển mạch được gọi là **chuyển mạch phần mềm (software switch)**. Máy tính có thể kết hợp chức năng chuyển mạch dữ liệu (data switching) với việc thực hiện các chức năng thông thường của nó như một nút cuối (end node). 

Tuy nhiên, trong nhiều trường hợp, giải pháp hợp lý hơn là chỉ định một số nút trong mạng chuyên biệt (dedicated) cho việc chuyển mạch. Những nút này tạo thành một **mạng chuyển mạch (switching network)** mà tất cả các nút khác sẽ được kết nối với. Trong Hình 2.15, một mạng chuyển mạch được minh họa, được hình thành bởi các nút 1, 5, 6 và 8, và các nút cuối (end nodes) 2, 3, 4, 7, 9 và 10 được kết nối với mạng này.

---

**Về các thuật ngữ (On terms)**

Các thuật ngữ **"chuyển mạch (switching)"**, **"bảng chuyển mạch (switching table)"** và **"bộ chuyển mạch (switch)"** trong mạng viễn thông (telecommunication networks) có thể được hiểu theo nhiều cách khác nhau. Chúng ta đã định nghĩa chuyển mạch là một quá trình kết nối các thuê bao mạng (network subscribers) thông qua các nút trung gian (transit nodes). Thuật ngữ này cũng được sử dụng để chỉ việc kết nối các giao diện (interfaces) trong phạm vi một nút trung gian.

Bộ chuyển mạch (switch), theo nghĩa rộng, là một thiết bị bất kỳ có khả năng thực hiện các thao tác chuyển dữ liệu (data forwarding) từ một giao diện sang một giao diện khác. Thao tác chuyển mạch (switching operation) có thể được thực hiện theo các quy tắc và thuật toán khác nhau. Một số phương pháp chuyển mạch và các bảng cũng như thiết bị tương ứng với chúng đã nhận được những tên gọi cụ thể. 

Ví dụ, trong công nghệ IP (IP technology), các thuật ngữ **"định tuyến (routing)"**, **"bảng định tuyến (routing table)"** và **"bộ định tuyến (router)"** được sử dụng để chỉ các khái niệm tương tự. Đồng thời, trong các mạng cục bộ Ethernet, các thuật ngữ **"chuyển mạch (switching)"**, **"bảng chuyển mạch (switching table)"** và **"bộ chuyển mạch (switch)"** được sử dụng trong nghĩa hẹp, chẳng hạn như các thiết bị chuyển đổi dữ liệu giữa các giao diện của nó.

Trong mạng điện thoại (telephone networks), xuất hiện từ lâu trước các mạng máy tính, thuật ngữ tương tự cũng được sử dụng, và "bộ chuyển mạch (switch)" trong ngữ cảnh này là đồng nghĩa với **"trạm điện thoại (telephone station)"**.

---

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.15.png" alt="Hình 2.15. Mạng chuyển mạch (Switching network)" width="900">
</p>
<p align="center"><b>Hình 2.15. Mạng chuyển mạch (Switching network)</b></p>

---

##### 2.5.4 Ghép kênh và tách kênh (Multiplexing and Demultiplexing)

Để xác định giao diện (interface) mà dữ liệu nhận được cần được truyền đến, bộ chuyển mạch (switch) phải làm rõ dữ liệu đó thuộc về luồng nào (flow). Nhiệm vụ này phải được giải quyết bất kể dữ liệu đến với bộ chuyển mạch là từ một luồng "thuần nhất" (pure flow) hay một luồng "hỗn hợp" (mixed flow), được tạo thành từ việc gộp nhiều luồng (aggregation of multiple flows).

Trong trường hợp thứ hai, ngoài nhiệm vụ nhận diện luồng (flow recognition), nhiệm vụ tách kênh (demultiplexing) cũng được thêm vào.

**Tách kênh (Demultiplexing)** — là việc phân tách một luồng dữ liệu tổng hợp thành nhiều luồng cấu thành.

Như thường lệ, thao tác chuyển mạch (switching operation) cũng đi kèm với thao tác ngược lại — **ghép kênh (multiplexing)**.

**Ghép kênh (Multiplexing)** (hay còn gọi là gộp luồng - aggregation) — là việc hợp nhất nhiều luồng dữ liệu riêng lẻ thành một luồng tổng hợp, được truyền qua một kênh truyền vật lý (physical communication channel) duy nhất.

Nói cách khác, ghép kênh (multiplexing) là một phương pháp phân chia một kênh vật lý hiện có giữa nhiều phiên giao tiếp (communication sessions) đồng thời của các thuê bao mạng (network subscribers).

Các thao tác ghép kênh và tách kênh (multiplexing/demultiplexing operations) có tầm quan trọng tương đương trong bất kỳ mạng nào như các thao tác chuyển mạch (switching), bởi vì nếu không có chúng, mỗi luồng sẽ yêu cầu một kênh riêng biệt, dẫn đến số lượng kết nối song song trong mạng tăng đáng kể và làm mất đi các lợi ích của mạng không hoàn toàn kết nối.

Hình 2.16 minh họa một đoạn mạng bao gồm ba bộ chuyển mạch (switches). Bộ chuyển mạch 1 có bốn giao diện mạng (network interfaces). Dữ liệu từ hai giao diện — 3 và 4 — được gửi đến giao diện 1. Dữ liệu này cần được truyền qua một kênh vật lý chung, do đó phải thực hiện thao tác ghép kênh (multiplexing).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.16.png" alt="Hình 2.16. Các thao tác ghép kênh và tách kênh trong chuyển mạch" width="900">
</p>
<p align="center"><b>Hình 2.16. Các thao tác ghép kênh và tách kênh trong chuyển mạch</b></p>

Một trong những phương pháp chính để **ghép kênh (multiplexing)** luồng là **ghép kênh phân chia theo thời gian (time-division multiplexing - TDM)**. Với phương pháp này, mỗi luồng định kỳ (với chu kỳ cố định hoặc ngẫu nhiên) sẽ được toàn quyền sử dụng kênh vật lý (physical channel) để truyền dữ liệu của nó. 

Một phương pháp phổ biến khác là **ghép kênh phân chia theo tần số (frequency-division multiplexing - FDM)**, trong đó mỗi luồng sẽ truyền dữ liệu trong dải tần số (frequency range) được phân bổ riêng.

Công nghệ ghép kênh cũng phải cho phép thiết bị nhận thực hiện thao tác ngược lại — **tách kênh (demultiplexing)**, tức là phân tách luồng dữ liệu tổng hợp thành các luồng cấu thành. Trên giao diện 3, bộ chuyển mạch (switch) thực hiện thao tác tách kênh (demultiplexing) một luồng thành ba luồng con (subflows). Một trong số đó được chuyển đến giao diện 1, luồng thứ hai đến giao diện 2, và luồng thứ ba đến giao diện 4.

Nói chung, trên một giao diện, cả hai chức năng **ghép kênh (multiplexing)** và **tách kênh (demultiplexing)** có thể được thực hiện đồng thời.

**Lưu ý**: Một trường hợp đặc biệt của bộ chuyển mạch, nơi tất cả các luồng thông tin đầu vào được chuyển mạch đến một giao diện đầu ra duy nhất, tại đó chúng được ghép lại thành một luồng tổng hợp (aggregated flow), được gọi là **bộ ghép kênh (multiplexer)**. Ngược lại, bộ chuyển mạch có một giao diện đầu vào và nhiều giao diện đầu ra được gọi là **bộ tách kênh (demultiplexer)** (Hình 2.17).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.17.png" alt="Hình 2.17. Bộ ghép kênh và bộ tách kênh" width="900">
</p>
<p align="center"><b>Hình 2.17. Bộ ghép kênh và bộ tách kênh</b></p>


---

##### 2.5.5 Môi trường truyền dữ liệu chia sẻ (Shared data transmission medium)

Trong tất cả các ví dụ đã xem xét về ghép kênh (multiplexing) luồng, mỗi đường truyền chỉ được kết nối với hai giao diện (interfaces). Trong trường hợp đường truyền là một kênh song công (duplex communication channel), như được minh họa trong Hình 2.18, mỗi giao diện sử dụng kênh truyền độc quyền theo hướng "từ nó đi" (outgoing). Điều này được giải thích bởi thực tế rằng một kênh song công bao gồm hai môi trường truyền dữ liệu độc lập (subchannels), và vì chỉ bộ phát (transmitter) của giao diện là thiết bị chủ động (active device), còn bộ thu (receiver) thì thụ động (passive), chỉ chờ tín hiệu đến từ bộ phát, nên không có sự cạnh tranh giữa các kênh phụ (subchannels).

Chế độ sử dụng môi trường truyền dữ liệu như vậy hiện nay là cơ chế cơ bản trong các mạng máy tính cục bộ (local networks) và toàn cầu (global networks).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.18.png" alt="Hình 2.18. Kênh song công - không có môi trường chia sẻ" width="900">
</p>
<p align="center"><b>Hình 2.18. Kênh song công - không có môi trường chia sẻ</b></p>

Tuy nhiên, nếu trong các mạng toàn cầu (global networks), chế độ này luôn được sử dụng, thì trong các mạng cục bộ (local networks) cho đến giữa những năm 1990, một chế độ khác đã chiếm ưu thế, dựa trên môi trường truyền dữ liệu chia sẻ (shared data transmission medium).

**Môi trường chia sẻ (shared medium)** được gọi là môi trường vật lý để truyền dữ liệu, trong đó một số bộ phát (transmitters) của các nút mạng (network nodes) được kết nối trực tiếp. Đồng thời, tại mỗi thời điểm, chỉ một trong các bộ phát của bất kỳ nút nào trong mạng được phép truy cập vào môi trường chia sẻ và sử dụng nó để truyền dữ liệu đến bộ thu (receiver) của một nút khác, cũng được kết nối với cùng môi trường này.

Trong trường hợp đơn giản nhất, hiệu ứng chia sẻ môi trường xuất hiện khi hai giao diện (interfaces) được kết nối thông qua một kênh truyền bán song công (half-duplex channel), tức là một kênh có thể truyền dữ liệu theo bất kỳ hướng nào, nhưng chỉ từng hướng một (Hình 2.19). Trong trường hợp này, cùng một môi trường truyền dữ liệu (ví dụ, cáp đồng trục hoặc môi trường sóng vô tuyến chung) được kết nối với hai nút mạng độc lập.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.19.png" alt="Hình 2.19. Kênh bán song công - môi trường chia sẻ" width="900">
</p>
<p align="center"><b>Hình 2.19. Kênh bán song công - môi trường chia sẻ</b></p>

Khi sử dụng môi trường truyền dữ liệu như vậy, một nhiệm vụ mới nảy sinh — **chia sẻ môi trường truyền dữ liệu giữa các bộ phát độc lập (independent transmitters)** sao cho tại mỗi thời điểm chỉ có dữ liệu của một bộ phát được truyền qua môi trường. Nói cách khác, cần có **một cơ chế đồng bộ hóa (synchronization mechanism)** để kiểm soát quyền truy cập của các giao diện (interfaces) vào môi trường chia sẻ.

Một trường hợp tổng quát của môi trường chia sẻ là khi hơn hai giao diện được kết nối với cùng một kênh truyền (ví dụ, ba giao diện trong ví dụ minh họa ở Hình 2.20), sử dụng cấu trúc liên kết bus (bus topology).

Có nhiều cách để giải quyết vấn đề tổ chức truy cập đồng thời vào các đường truyền chia sẻ. Một trong những cách đó là **phương pháp tập trung (centralized method)**, trong đó quyền truy cập vào kênh được kiểm soát bởi một thiết bị đặc biệt — **bộ điều phối (arbiter)**. Cách khác là **phương pháp phân tán (decentralized method)**. Khi quan sát cách tổ chức hoạt động của máy tính, ta thấy rằng quyền truy cập vào bus hệ thống (system bus) của máy tính, sử dụng các khối nội bộ, được kiểm soát tập trung — bởi bộ xử lý (processor) hoặc một arbiter chuyên dụng.

Trong mạng, tổ chức truy cập đồng thời vào các đường truyền chia sẻ có những đặc điểm riêng do thời gian truyền tín hiệu dọc theo đường truyền. Các thủ tục đồng bộ quyền truy cập có thể yêu cầu khoảng thời gian quá lớn, dẫn đến tổn thất hiệu suất đáng kể. Chính vì lý do này, cơ chế chia sẻ môi trường trong mạng toàn cầu (global networks) hầu như không được sử dụng.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/2.20.png" alt="Hình 2.20. Kênh với nhiều kết nối - môi trường chia sẻ" width="900">
</p>
<p align="center"><b>Hình 2.20. Kênh với nhiều kết nối - môi trường chia sẻ</b></p>

Thoạt nhìn, có thể cho rằng cơ chế chia sẻ môi trường (medium sharing mechanism) rất giống với cơ chế ghép kênh (multiplexing mechanism) luồng, vì trong cả hai trường hợp, có nhiều luồng dữ liệu (data flows) được truyền qua đường truyền. Tuy nhiên, ở đây có một sự khác biệt cơ bản liên quan đến cách kiểm soát (control) đường truyền. Trong ghép kênh, đường truyền song công (duplex link) ở mỗi hướng đều nằm dưới sự kiểm soát hoàn toàn của một bộ chuyển mạch (switch), quyết định cách các luồng dữ liệu chia sẻ kênh chung. 

Đối với mạng cục bộ (local networks), môi trường chia sẻ đã được sử dụng tương đối lâu như một cơ chế chính để tận dụng các kênh truyền (communication channels), điều này được áp dụng trong tất cả các công nghệ mạng cục bộ — **Ethernet**, **Token Ring**, **FDDI**. Trong các công nghệ này, phương pháp truy cập phân tán (decentralized access methods) được áp dụng, không yêu cầu sự hiện diện của một bộ điều phối (arbiter) trong mạng. Sự phổ biến của kỹ thuật chia sẻ môi trường trong mạng cục bộ được giải thích bởi sự đơn giản và tiết kiệm về mặt phần cứng. 

Ví dụ, để tạo một mạng Ethernet trên cáp đồng trục (coaxial cable), ngoài các bộ điều hợp mạng (network adapters) và bản thân cáp, không cần thêm bất kỳ thiết bị mạng nào khác. Việc mở rộng số lượng máy tính trong mạng cục bộ Ethernet sử dụng cáp đồng trục cũng được thực hiện khá đơn giản — bằng cách kết nối thêm một đoạn cáp mới với đoạn cáp hiện có.

Ngày nay, trong các mạng cục bộ có dây (wired local networks), phương pháp chia sẻ môi trường (medium sharing method) hầu như không còn được sử dụng. Nguyên nhân chính của việc từ bỏ môi trường chia sẻ là hiệu suất thấp (low performance) và khó dự đoán, cũng như khả năng mở rộng kém (poor scalability). Hiệu suất thấp được giải thích bởi thực tế rằng băng thông (bandwidth) của kênh truyền được chia sẻ giữa tất cả các máy tính trong mạng.

Ví dụ, nếu một mạng cục bộ Ethernet bao gồm 100 máy tính và sử dụng cáp đồng trục (coaxial cable) cùng các bộ điều hợp mạng (network adapters) hoạt động ở tốc độ 10 Mbit/s, thì trung bình mỗi máy tính chỉ được phân bổ 0,1 Mbit/s băng thông. Việc đánh giá chính xác phần băng thông cho một máy tính trong mạng là khó khăn, vì giá trị này phụ thuộc vào nhiều yếu tố ngẫu nhiên, chẳng hạn như mức độ hoạt động của các máy tính khác. Có lẽ đến đây, người đọc đã hiểu lý do tại sao loại mạng này có khả năng mở rộng kém — càng thêm nhiều máy tính, phần băng thông dành cho mỗi máy tính càng giảm.

Những nhược điểm được mô tả là hệ quả của chính nguyên tắc chia sẻ môi trường, do đó không thể khắc phục hoàn toàn. Sự xuất hiện của các bộ chuyển mạch (switches) giá rẻ cho mạng cục bộ vào đầu những năm 1990 đã dẫn đến một cuộc cách mạng thực sự trong lĩnh vực này, và dần dần, các bộ chuyển mạch đã thay thế hoàn toàn môi trường chia sẻ.

Ngày nay, cơ chế chia sẻ môi trường chỉ được sử dụng trong các mạng cục bộ không dây (wireless local networks), nơi môi trường — không gian sóng radio (radio ether) — tự nhiên kết nối tất cả các nút cuối (end nodes) nằm trong vùng phủ sóng tín hiệu.

---

**Ví dụ - Phép so sánh (Example - Analogy)**

Nhiệm vụ tổng quát của chuyển mạch (switching), đã được xem xét ở trên, là một mô hình trừu tượng đủ để áp dụng cho bất kỳ công nghệ mạng nào. Hãy giải thích mô hình này bằng ví dụ về cách hoạt động của dịch vụ bưu chính truyền thống. Bưu chính cũng xử lý các luồng thông tin (information flows), trong trường hợp này là các bưu gửi (postal items). Đặc điểm chính của luồng bưu chính là địa chỉ người nhận (recipient address). 

Để đơn giản, chúng ta sẽ chỉ xem xét địa chỉ quốc gia, ví dụ như Ấn Độ, Na Uy, Nga, Brazil, v.v. Một đặc điểm bổ sung của luồng có thể là yêu cầu đặc biệt về độ tin cậy hoặc tốc độ giao hàng. Ví dụ, ghi chú "Avia" trên các bưu gửi đến Brazil sẽ tạo ra một luồng con (subflow) riêng biệt, được giao bằng máy bay.

Đối với mỗi luồng, dịch vụ bưu chính cần xác định tuyến đường (route) mà bưu gửi sẽ đi qua thông qua các bưu cục (postal offices), là tương đương với các bộ chuyển mạch (switches). Kết quả của nhiều năm hoạt động, dịch vụ bưu chính đã xác định các tuyến đường cho hầu hết các địa chỉ đích (destinations). Đôi khi, các tuyến đường mới xuất hiện do các cơ hội mới — chính trị, giao thông, kinh tế. Sau khi chọn tuyến đường mới, cần thông báo (notify) về điều này đến toàn bộ mạng lưới bưu cục. Rõ ràng, các hành động này rất giống với hoạt động của mạng viễn thông (telecommunication network).

Thông tin về các tuyến đường đã chọn được biểu diễn trong mỗi bưu cục dưới dạng một bảng, trong đó thiết lập sự tương ứng giữa quốc gia đích và bưu cục tiếp theo. Ví dụ, tại bưu cục ở thành phố Saratov, các thư gửi đến Ấn Độ sẽ được gửi đến bưu cục ở Ashkhabad, còn các thư gửi đến Na Uy sẽ được chuyển đến bưu cục ở Saint Petersburg. Bảng định tuyến này là một sự tương đồng trực tiếp với bảng chuyển mạch (switching table) trong mạng viễn thông.

Mỗi bưu cục hoạt động như một bộ chuyển mạch. Các bưu gửi đến từ người gửi hoặc các bưu cục khác được phân loại (classified) thành các luồng (flows). Sau đó, các bưu gửi thuộc về một luồng cụ thể được đóng gói vào bao, được đánh dấu với bưu cục đích tiếp theo theo bảng định tuyến và gửi đi.

---

<h3 id="chuong-3-chuyen-mach-kenh-va-chuyen-mach-goi">CHƯƠNG 3: Chuyển mạch kênh và chuyển mạch gói (Channel Switching and Packet Switching)</h3>


Trong số rất nhiều phương pháp tiếp cận để giải quyết bài toán chuyển mạch thuê bao (subscriber switching) trong mạng, có hai phương pháp cơ bản được xác định — chuyển mạch kênh (channel switching) và chuyển mạch gói (packet switching).

Mỗi phương pháp trong hai phương pháp này đều có ưu và nhược điểm riêng. Khi sử dụng chuyển mạch gói (packet switching), các đặc điểm của lưu lượng máy tính (computer traffic) được tính đến, do đó phương pháp này hiệu quả hơn đối với các mạng máy tính so với phương pháp chuyển mạch kênh truyền thống (traditional channel switching), vốn được sử dụng trong mạng điện thoại (telephony networks).

Chuyển mạch gói đang cố gắng thay thế chuyển mạch kênh trong các lĩnh vực truyền thống của nó, chẳng hạn như điện thoại (internet telephony hoặc IP telephony), nhưng cuộc tranh luận này vẫn chưa được giải quyết, và rất có thể, cả hai kỹ thuật chuyển mạch sẽ tiếp tục tồn tại song song trong một thời gian dài, bổ sung cho nhau.

---

#### 3.1 Chuyển mạch kênh (Channel Switching)

Về mặt lịch sử, chuyển mạch kênh xuất hiện sớm hơn nhiều so với chuyển mạch gói và có nguồn gốc từ các mạng điện thoại đầu tiên.

Các mạng được xây dựng dựa trên nguyên tắc chuyển mạch kênh có lịch sử phong phú, và ngay cả ngày nay, chúng vẫn được sử dụng rộng rãi trong thế giới viễn thông (telecommunications), đóng vai trò là nền tảng của các mạng sơ cấp (primary networks), cho phép tạo ra các kênh truyền tải trục chính (high-speed backbone channels). Các phiên kết nối đầu tiên giữa các máy tính được thực hiện thông qua mạng điện thoại, nghĩa là cũng áp dụng công nghệ chuyển mạch kênh. Người dùng, những người truy cập Internet qua modem, vẫn tiếp tục sử dụng các mạng này, vì dữ liệu của họ được truyền đến thiết bị của nhà cung cấp qua mạng điện thoại cục bộ.

Mạng với chuyển mạch kênh bao gồm nhiều bộ chuyển mạch (switches) và các nút cuối (end nodes) — các thuê bao (subscribers), được kết nối với nhau thông qua các đường truyền (links) hoặc các liên kết (network segments). Lưu ý rằng trong ngữ cảnh này, thuật ngữ **"đường truyền (link)"** được sử dụng để chỉ các kết nối giữa hai nút liền kề của mạng.

Trong mạng chuyển mạch kênh, các nhiệm vụ riêng lẻ của chuyển mạch, đã được trình bày trước đó, được giải quyết. Ví dụ, trong vai trò của các luồng thông tin (information flows) trong mạng chuyển mạch kênh là các cặp thuê bao. Thời gian tồn tại của một luồng thông tin nằm trong phạm vi của một **phiên kết nối thuê bao (subscriber communication session)**. Đặc điểm toàn cầu của luồng là cặp địa chỉ (address pairs) của các thuê bao, xác định rõ ràng các nút kết nối.

Đối với tất cả các luồng có thể, các tuyến đường (routes) được xác định trước. Trong các mạng chuyển mạch kênh (channel switching networks), các tuyến đường được thiết lập thủ công (manually) bởi quản trị viên mạng (network administrator) hoặc được tìm thấy tự động (automatically) bằng cách sử dụng các công cụ phần mềm và phần cứng đặc biệt. 

Các tuyến đường được ghi lại trong các bảng chuyển mạch (switching tables), trong đó các đặc điểm của luồng (flow attributes) được liên kết với các bộ định danh của giao diện đầu ra (output interface identifiers) của bộ chuyển mạch (switch). Dựa trên các bảng này, dữ liệu được chuyển tiếp (forwarding) và ghép kênh (multiplexing) được thực hiện. Tuy nhiên, như đã đề cập trước đó, trong các mạng chuyển mạch kênh, việc giải quyết tất cả các nhiệm vụ này có các đặc điểm riêng.

---

##### 3.1.1 Kênh cơ bản (Elementary Channel)

Một trong những đặc điểm của mạng chuyển mạch kênh (channel switching networks) là việc sử dụng khái niệm **kênh cơ bản (elementary channel)**.

**Kênh cơ bản** là một đặc tính kỹ thuật cơ bản của mạng chuyển mạch kênh, đại diện cho một giá trị băng thông (bandwidth) cố định trong phạm vi của loại mạng cụ thể. Mỗi đường truyền (link) trong mạng chuyển mạch kênh có băng thông là bội số của kênh cơ bản, được chấp nhận đối với loại mạng này.

Trong các phần trước, chúng ta đã sử dụng thuật ngữ "kênh" như một cách tương tự với thuật ngữ "đường truyền (link)." Khi nói đến mạng chuyển mạch kênh, thuật ngữ "kênh" được gán ý nghĩa là **đơn vị băng thông (bandwidth unit)**.

Giá trị số của kênh cơ bản, hay nói cách khác, đơn vị tối thiểu của băng thông của một đường truyền, được chọn dựa trên các yếu tố khác nhau. Rõ ràng là không nên chọn giá trị kênh cơ bản nhỏ hơn băng thông tối thiểu cần thiết để truyền tải lưu lượng mong đợi. Ví dụ, trong mạng điện thoại hiện đại, giá trị phổ biến nhất của kênh cơ bản là tốc độ 64 Kbit/s — đây là tốc độ tối thiểu cần thiết để đảm bảo truyền giọng nói số chất lượng cao.

Các đường truyền trong mạng chuyển mạch kênh (và trong các loại mạng máy tính khác) có băng thông khác nhau, một số lớn hơn, một số nhỏ hơn. Khi chọn đường truyền với các đặc điểm băng thông khác nhau để kết nối mạng, các chuyên gia thiết kế mạng cố gắng tính đến cường độ khác nhau của các luồng thông tin (information flows), thường phát sinh ở các đoạn mạng khác nhau: càng gần trung tâm mạng, lưu lượng càng lớn, do đó các đường truyền chính (backbone links) phải tổng hợp lưu lượng của một lượng lớn các đường truyền ngoại vi (peripheral links).

**Một đặc điểm của mạng chuyển mạch kênh là băng thông của mỗi đường truyền phải là bội số của số nguyên kênh cơ bản.**

Do đó, các đường truyền kết nối thuê bao trong mạng điện thoại có thể chứa 2, 24, hoặc 30 kênh cơ bản; một đường truyền kết nối các bộ chuyển mạch có thể chứa 480 hoặc 1920 kênh cơ bản.

Như được suy ra từ định nghĩa, **kênh cơ bản (elementary channel)** đại diện cho một phần băng thông (bandwidth) của đường truyền (communication line). Trong các công nghệ khác nhau, việc phân chia băng thông được thực hiện theo các cách khác nhau. 

Trong một số trường hợp, chẳng hạn như trong công nghệ **OTN (Optical Transport Network)**, việc phân chia được thực hiện theo thời gian (time-division), và kênh cơ bản là băng thông tương ứng với một khe thời gian (time slot), trong đó đường truyền được cấp riêng biệt cho một luồng cụ thể.

Trong các công nghệ khác (ví dụ, **DWDM - Dense Wavelength Division Multiplexing**), các kênh cơ bản được xác định như là các dải tần số (frequency ranges), có thể được gán cho các luồng cụ thể. 

Việc nhận dạng (identification) các kênh cơ bản cũng được thực hiện khác nhau tùy thuộc vào công nghệ. Ở giai đoạn này, chúng ta giả định rằng số hiệu kênh (channel number) được sử dụng làm định danh.

---

**Số hóa giọng nói (Voice Digitization)**

Nhiệm vụ số hóa giọng nói là một trường hợp cụ thể của vấn đề chung hơn — **truyền thông tin analog dưới dạng rời rạc (discrete form)**. Vấn đề này đã được giải quyết vào những năm 1960, khi giọng nói bắt đầu được truyền qua các mạng điện thoại dưới dạng chuỗi các số 1 và 0. Quá trình chuyển đổi này dựa trên việc **rời rạc hóa (discretization)** các quá trình liên tục, cả về biên độ (amplitude) và thời gian (time) (Hình 3.1).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.1.png" alt="Hình 3.1. Điều chế rời rạc của quá trình liên tục" width="900">
</p>
<p align="center"><b>Hình 3.1. Điều chế rời rạc của quá trình liên tục</b></p>


Biên độ của hàm liên tục ban đầu được đo ở các khoảng thời gian cố định — điều này dẫn đến **rời rạc hóa theo thời gian (time discretization)**. Sau đó, mỗi mẫu đo được biểu diễn dưới dạng một số nhị phân với một số lượng bit nhất định, điều này có nghĩa là **rời rạc hóa theo giá trị (value discretization)** — tập hợp liên tục các giá trị biên độ được thay thế bằng một tập hợp rời rạc các giá trị của nó.

Để truyền giọng nói chất lượng cao, tần số lượng tử hóa (quantization frequency) của biên độ dao động âm thanh được sử dụng là 8000 Hz (**rời rạc hóa theo thời gian với khoảng thời gian 125 μs**). Để biểu diễn biên độ của một mẫu đo, 256 mức lượng tử hóa được sử dụng (**rời rạc hóa theo giá trị** với 8 bit cho mỗi mẫu). Trong trường hợp này, để truyền tải một kênh giọng nói, cần băng thông 64 Kbit/s:  
**8000 × 8 = 64 000 bit/s hoặc 64 Kbit/s**. Kênh giọng nói như vậy được gọi là **kênh cơ bản của mạng điện thoại số (elementary channel of digital telephone networks)**.

---

Chuyển sang đoạn mạng được minh họa trong Hình 3.2. Giả sử rằng mạng này được đặc trưng bởi kênh cơ bản có băng thông **T = 64 Kbit/s**. Trong mạng có các đường truyền với các băng thông khác nhau, gồm 2, 3, 4 và 5 kênh cơ bản. Để xác định, giả sử rằng các giao diện là song công (duplex interfaces). Các kênh cơ bản được nhận dạng bằng các số định danh (identifiers). Ví dụ, máy chuyển mạch **S2** có quyền truy cập vào các giao diện (ports) trên cổng **P1** với các kênh cơ bản 1, 2, 3 và 4, và trên cổng **P3** với các kênh cơ bản 1, 2, 3, 4 và 5.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.2.png" alt="Hình 3.2. Kênh tổng hợp trong mạng chuyển mạch kênh" width="900">
</p>
<p align="center"><b>Hình 3.2. Kênh tổng hợp trong mạng chuyển mạch kênh</b></p>

Hình vẽ minh họa hai thuê bao **A** và **B**, trong một phiên liên lạc (telecommunication session) tạo ra một **luồng thông tin (information flow)**, với một **tuyến đường (route)** được thiết lập trong mạng thông qua bốn bộ chuyển mạch — **S1**, **S2**, **S3**, và **S4**. Giả sử rằng cường độ của luồng thông tin giữa hai thuê bao không vượt quá **2T bit/s**.

Khi đó, để trao đổi dữ liệu giữa hai thuê bao này, chỉ cần có hai kênh cơ bản (elementary channels), được "phân bổ" trên mỗi đường truyền dọc theo tuyến đường từ điểm **A** đến điểm **B**. Trong hình minh họa, các kênh cơ bản cần thiết cho các thuê bao **A** và **B** được đánh dấu bằng các đường nét dày.

---

##### 3.1.2 Kênh tổng hợp (Composite Channel)

Một kênh được xây dựng thông qua chuyển mạch (switching) hoặc kết nối (connection) các **kênh cơ bản (elementary channels)** dành riêng cho luồng thông tin (information flow) được gọi là **kênh tổng hợp (composite channel)**.

Trong ví dụ được xem xét, để kết nối hai thuê bao **A** và **B**, một kênh tổng hợp với "độ dày" là hai kênh cơ bản đã được tạo ra. Nếu thay đổi giả định và cho rằng lưu lượng được dự kiến sẽ không vượt quá **T bit/s**, thì các thuê bao chỉ cần một kênh tổng hợp với "độ dày" là một kênh cơ bản.

Đồng thời, các thuê bao có cường độ trao đổi dữ liệu cao hơn có thể đưa ra yêu cầu lớn hơn về băng thông (bandwidth) của kênh tổng hợp. Để đáp ứng điều này, họ cần đặt trước nhiều kênh cơ bản hơn trên mỗi đường truyền, nhưng không nhất thiết phải giống nhau trên tất cả các đường truyền.

Những đặc tính sau đây của **kênh tổng hợp (composite channel)** được nhấn mạnh:

- Kênh tổng hợp trên toàn bộ chiều dài của nó bao gồm một số lượng **kênh cơ bản (elementary channels)** giống nhau;
- Kênh tổng hợp có **băng thông cố định và không thay đổi (constant and fixed bandwidth)** trên toàn bộ chiều dài của nó;
- Kênh tổng hợp được tạo ra **tạm thời (temporarily)** trong thời gian của phiên liên lạc giữa hai thuê bao, hay nói cách khác, chỉ trong thời gian tồn tại của luồng thông tin (information flow);
- Trong thời gian phiên liên lạc, tất cả các **kênh cơ bản (elementary channels)** trong kênh tổng hợp được dành riêng cho các thuê bao mà kênh tổng hợp này được tạo ra;
- Trong toàn bộ phiên liên lạc, thuê bao có thể gửi dữ liệu vào mạng với tốc độ không vượt quá băng thông của kênh tổng hợp;
- Dữ liệu được truyền trong kênh tổng hợp được đảm bảo sẽ đến thuê bao nhận **mà không có độ trễ (without delay)**, với tốc độ không thấp hơn tốc độ nguồn (source speed), bất kể liệu có kết nối khác tồn tại trong mạng hay không;
- Sau khi phiên liên lạc kết thúc, các **kênh cơ bản (elementary channels)** thuộc kênh tổng hợp được giải phóng và trả lại vào nhóm tài nguyên chung để sử dụng bởi các thuê bao khác.

Trong mạng có thể diễn ra đồng thời nhiều phiên liên lạc (sessions) (đây là tình huống phổ biến đối với mạng điện thoại, trong đó đồng thời truyền tải các cuộc hội thoại của hàng trăm và hàng nghìn thuê bao). Việc phân chia mạng giữa các phiên liên lạc được thực hiện ở cấp độ các **kênh cơ bản (elementary channels)**. 

Ví dụ, (xem Hình 3.2), chúng ta có thể giả định rằng, sau khi trên đường truyền **S2–S3** đã được phân bổ hai kênh để kết nối giữa thuê bao **A** và **B**, ba kênh cơ bản còn lại được phân bổ cho các phiên liên lạc khác, diễn ra cùng lúc trên cùng đường truyền. 

Điều này có nghĩa là **ghép kênh (multiplexing)** cho phép truyền tải lưu lượng từ nhiều kết nối logic (logical connections) qua mỗi kênh vật lý (physical channel).

**Ghép kênh (Multiplexing)** đồng nghĩa với việc các thuê bao phải cạnh tranh tài nguyên, trong trường hợp này là các **kênh cơ bản (elementary channels)**. Có thể xảy ra tình huống khi một đường truyền trung gian đã sử dụng hết các kênh cơ bản tự do — trong trường hợp này, một phiên liên lạc mới, với tuyến đường đi qua đường truyền này, không thể diễn ra.

Để nhận diện các tình huống như vậy, việc trao đổi dữ liệu trong mạng chuyển mạch kênh bao gồm một **thủ tục thiết lập kết nối (connection establishment procedure)**. Theo thủ tục này, thuê bao khởi tạo phiên liên lạc (ví dụ, thuê bao **A** trong mạng của chúng ta), gửi một **yêu cầu (request)** vào mạng chuyển mạch, nội dung yêu cầu là địa chỉ của thuê bao được gọi, ví dụ như **B1**.

Mục tiêu của yêu cầu là kiểm tra xem có thể hình thành kênh tổng hợp (composite channel) giữa thuê bao gọi và thuê bao được gọi hay không. Để làm được điều này, cần tuân thủ hai điều kiện: có đủ số lượng **kênh cơ bản tự do (free elementary channels)** trên mỗi đường truyền dọc theo tuyến đường giữa **A** và **B**, và thuê bao được gọi không bận với kết nối khác.

Yêu cầu này được xử lý trên cơ sở tuyến đường (route), được xác định trước đó cho luồng thông tin của cặp thuê bao này. Tuyến đường này được ghi lại trong các **bảng chuyển mạch toàn cầu (global switching tables)**, với thông tin về các nút trung gian trên tuyến đường giữa thuê bao **A** và **B**.

Ví dụ, bộ chuyển mạch (switch) **S4** trong ví dụ của chúng ta có thể có bảng định tuyến toàn cầu (global routing table) như sau:

**Bảng 3.1**. Ví dụ về bảng định tuyến toàn cầu

| Thuê bao (Subscriber) | Giao diện dẫn đến bộ chuyển mạch tiếp theo (Interface leading to the next switch) |
|------------------------|-----------------------------------------------------------------------------|
| A                      | P1                                                                          |
| B                      | P2                                                                          |
| C                      | P4                                                                          |
| D                      | P3                                                                          |

Nếu sau khi xử lý yêu cầu, xác định rằng không có gì ngăn cản việc thiết lập kết nối, thì **kênh tổng hợp (composite channel)** sẽ được cố định. Để thực hiện điều này, trong mỗi bộ chuyển mạch dọc theo tuyến đường từ **A** đến **B** sẽ tạo ra các bản ghi trong **bảng chuyển mạch cục bộ (local switching tables)**, trong đó chỉ ra sự tương ứng giữa **các dấu hiệu cục bộ của luồng (local flow characteristics)** — số của các **kênh cơ bản (elementary channels)** được đặt trước cho phiên liên lạc này tại bộ chuyển mạch cụ thể.

Trong ví dụ của chúng ta, sau khi xử lý yêu cầu để thiết lập kết nối từ thuê bao **A** đến thuê bao **B**, các bản ghi tương ứng đã được tạo ra trong **S1**, **S2**, **S3**, và **S4** trong các **bảng chuyển mạch cục bộ (local switching tables)** của chúng.

**Bảng chuyển mạch cục bộ (Local switching table)** tại bộ chuyển mạch **S4** sẽ có dạng như sau:

**Bảng 3.2.** Ví dụ về bảng định tuyến cục bộ (Local Routing Table)

| Kênh cơ bản đầu vào (Incoming Elementary Channels) | Kênh cơ bản đầu ra (Outgoing Elementary Channels) |
|-----------------------------------------------------|--------------------------------------------------|
| P1/kênh 2                                           | P2/kênh 1                                        |
| P1/kênh 3                                           | P2/kênh 2                                        |

Các bản ghi được trình bày trong ví dụ cho thấy rằng kênh cơ bản (elementary channel) 2, đến từ giao diện **P1**, được chuyển tiếp (switched) tới kênh cơ bản 1 của giao diện **P2**, và kênh cơ bản 3 của giao diện **P1** được chuyển tiếp tới kênh cơ bản 2 của giao diện **P2**.

Trong ví dụ này, số của các kênh cơ bản mang các giá trị duy nhất trong phạm vi mỗi giao diện. Do đó, trong bảng định tuyến cục bộ, các kênh cơ bản được xác định thông qua cặp "số giao diện/số kênh (interface number/channel number)." Một cách tổ chức khác cũng có thể xảy ra, trong đó số của các kênh cơ bản được giữ duy nhất trong toàn bộ bộ chuyển mạch (switch). Tuy nhiên, trong trường hợp thêm hoặc xóa giao diện, điều này có thể yêu cầu đánh số lại (renumbering), gây ra sự bất tiện.

Sau khi kênh tổng hợp (composite channel) được thiết lập và các bản ghi tương ứng được hình thành trong các bảng chuyển mạch cục bộ (local switching tables) của từng bộ chuyển mạch, thuê bao **A** và **B** có thể bắt đầu phiên liên lạc của mình.

Như vậy, việc truyền dữ liệu trong mạng với chuyển mạch kênh (circuit switching) diễn ra theo hai giai đoạn:

1. Một thông báo dịch vụ (service message) được gửi vào mạng — đó là một yêu cầu (request) mang địa chỉ của thuê bao được gọi và khởi tạo việc tạo kênh tổng hợp (composite channel).

2. Qua kênh tổng hợp đã được chuẩn bị, luồng dữ liệu chính (main data flow) được truyền, mà không yêu cầu bất kỳ thông tin bổ sung nào, bao gồm cả địa chỉ của thuê bao được gọi. Việc chuyển mạch dữ liệu (data switching) trong các bộ chuyển mạch (switches) được thực hiện dựa trên các dấu hiệu cục bộ của luồng (local flow characteristics) — số của các kênh cơ bản (elementary channels) được phân bổ cho nó.

Các yêu cầu thiết lập kết nối (connection establishment requests) không phải lúc nào cũng hoàn thành thành công. Nếu trên đường giữa thuê bao gọi (calling subscriber) và thuê bao được gọi (called subscriber) không có các kênh cơ bản (elementary channels) còn trống hoặc nút được gọi (called node) đang bận, thì xảy ra từ chối thiết lập kết nối (connection establishment denial). 

Ví dụ, nếu trong suốt phiên liên lạc giữa thuê bao **A** và **B**, thuê bao **C** gửi yêu cầu vào mạng để thiết lập kết nối với thuê bao **D**, thì nó sẽ nhận được từ chối (denial), vì trong hai kênh cơ bản cần thiết trên tuyến liên kết **S3–S4**, chỉ có một kênh còn trống (hình 3.3). Khi từ chối thiết lập kết nối, mạng sẽ thông báo cho thuê bao gọi bằng một thông báo đặc biệt.

Càng nhiều tải (load) trên mạng, nghĩa là càng nhiều kết nối mà mạng hỗ trợ tại thời điểm đó, thì khả năng từ chối đối với yêu cầu thiết lập kết nối mới càng cao.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.3.png" alt="Hình 3.3. Từ chối thiết lập kết nối trong mạng chuyển mạch kênh" width="900">
</p>
<p align="center"><b>Hình 3.3. Từ chối thiết lập kết nối trong mạng chuyển mạch kênh</b></p>

Chúng tôi đã mô tả quy trình thiết lập kết nối trong **chế độ tự động động (automatic dynamic mode)**, dựa trên khả năng của các thuê bao gửi các tin nhắn dịch vụ (service messages) vào mạng - các yêu cầu thiết lập kết nối (connection requests), và khả năng của các nút mạng xử lý những tin nhắn này. Chế độ này được sử dụng trong các mạng điện thoại: thiết bị điện thoại tạo yêu cầu bằng cách gửi các xung (impulse) (hoặc tín hiệu âm (tone signals)), mã hóa số của thuê bao cần gọi, và mạng hoặc thiết lập kết nối, hoặc thông báo về tình trạng bận (busy signal). Trong các mạng điện thoại đầu tiên, mỗi đường dây kết nối từ thuê bao đến tổng đài trung tâm là một kênh cơ bản. Các bộ chuyển mạch (switch) là cơ điện (electromechanical), và việc kết nối được thực hiện thủ công bởi các nhân viên vận hành thông qua việc cắm dây cáp vào các cổng của bộ chuyển mạch, nơi các đường dây thuê bao được kết nối.

Tuy nhiên, đây không phải là cách duy nhất để mạng với các kênh chuyển mạch hoạt động. Có tồn tại một **chế độ thủ công tĩnh (static manual mode)** để thiết lập kết nối, đặc trưng cho các trường hợp cần thiết lập một kênh ghép (compound channel) không phải chỉ trong một phiên kết nối ngắn của thuê bao, mà trong một thời gian dài hơn. Việc tạo ra kênh lâu dài như vậy không thể được khởi xướng bởi các thuê bao - nó được tạo ra bởi các quản trị viên của mạng. Rõ ràng, chế độ thủ công tĩnh không phù hợp cho mạng điện thoại truyền thống với các phiên kết nối ngắn, nhưng nó hoàn toàn phù hợp cho việc tạo ra các kênh viễn thông (telecommunication channels) tốc độ cao giữa các thành phố và quốc gia trên cơ sở tương đối ổn định.

Công nghệ chuyển mạch kênh (channel switching technology) hướng đến việc giảm thiểu các sự kiện ngẫu nhiên trong mạng, nghĩa là công nghệ này nhằm đến tính quyết định (determinism). Để tránh mọi khả năng không xác định, một phần lớn công việc tổ chức trao đổi thông tin được thực hiện trước khi việc truyền dữ liệu (data transmission) thực sự bắt đầu. Trước tiên, theo địa chỉ được xác định trước, tính khả dụng của các kênh cơ bản cần thiết (elementary channels) trên toàn bộ đường từ người gửi đến người nhận được kiểm tra. Sau đó, các kênh này được gán cố định trong suốt thời gian phiên kết nối để sử dụng riêng bởi hai thuê bao và được chuyển mạch thành một đường ống liên tục (continuous pipeline) (kênh ghép - compound channel), có các “van cổng” (gateway valves) ở phía mỗi thuê bao. Sau phần công việc chuẩn bị kỹ lưỡng này, việc còn lại là thực hiện điều nhỏ nhất: “mở các van cổng” và cho phép luồng thông tin (information flow) tự do và không bị cản trở “chảy qua” giữa các điểm đã định sẵn trong mạng (Hình 3.4).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.4.png" alt="Hình 3.4. Mạng chuyển mạch kênh như một hệ thống đường ống" width="900">
</p>
<p align="center"><b>Hình 3.4. Mạng chuyển mạch kênh như một hệ thống đường ống</b></p>


##### 3.1.3 Sự không hiệu quả trong việc truyền tải lưu lượng xung nhịp

Các mạng sử dụng công nghệ chuyển mạch kênh (channel switching) hoạt động hiệu quả nhất khi truyền tải lưu lượng người dùng trong trường hợp tốc độ lưu lượng đó không đổi trong suốt phiên kết nối và phù hợp tối đa với khả năng truyền tải cố định (fixed bandwidth) của các đường truyền vật lý trong mạng. Hiệu suất của mạng giảm khi các luồng thông tin, được tạo bởi các thuê bao, mang tính chất xung nhịp (pulsating).

Ví dụ, khi nói chuyện qua điện thoại, mọi người thường thay đổi tốc độ lời nói, xen lẫn các khoảng tạm dừng nhanh. Kết quả là các luồng thông tin "âm thanh" (voice information flows) trở nên không đều, và do đó, hiệu suất truyền dữ liệu bị giảm. Tuy nhiên, đối với các cuộc gọi thoại, sự giảm hiệu suất này vẫn được chấp nhận và cho phép sử dụng rộng rãi các mạng chuyển mạch kênh để truyền tải lưu lượng thoại.

Hiệu suất của mạng chuyển mạch kênh giảm mạnh hơn khi truyền tải cái gọi là **lưu lượng máy tính (computer traffic)**, tức là lưu lượng được tạo ra bởi các ứng dụng mà người dùng máy tính đang sử dụng. Loại lưu lượng này hầu như luôn mang tính xung nhịp. Ví dụ, khi bạn tải một trang web từ Internet, tốc độ lưu lượng tăng đột ngột, nhưng sau khi tải xong, lưu lượng giảm xuống gần như bằng không. Nếu trong phiên truy cập Internet đó bạn sử dụng mạng chuyển mạch kênh, phần lớn thời gian kênh ghép giữa máy tính của bạn và máy chủ web sẽ không được sử dụng. Đồng thời, một phần băng thông của mạng sẽ bị giữ cố định cho bạn và không thể được sử dụng bởi những người dùng khác. Mạng trong các trường hợp này giống như thang cuốn trống rỗng trong tàu điện ngầm, vẫn hoạt động nhưng không có tác dụng.

Để truyền tải hiệu quả lưu lượng máy tính không đều, công nghệ **chuyển mạch gói (packet switching)** đã được phát triển đặc biệt.


#### 3.2 Chuyển mạch gói (Packet Switching)

Các mạng với công nghệ chuyển mạch gói (packet switching), giống như các mạng chuyển mạch kênh (channel switching), được tạo thành từ các bộ chuyển mạch (switch) được kết nối với nhau qua các đường truyền vật lý. Tuy nhiên, việc truyền dữ liệu trong các mạng này hoàn toàn khác biệt. Nói một cách đơn giản, so với mạng chuyển mạch kênh, mạng chuyển mạch gói hoạt động “ít trách nhiệm” hơn. Ví dụ, mạng có thể nhận dữ liệu để truyền mà không cần phải đặt trước các đường truyền trên tuyến đường của dữ liệu và không cấu hình trước băng thông yêu cầu. Mạng chuyển mạch gói không tạo các kênh liên lạc riêng biệt cho các thuê bao. Dữ liệu có thể bị trễ hoặc thậm chí bị mất trên đường truyền. Vậy làm thế nào mà với sự hỗn loạn và không chắc chắn như vậy, mạng chuyển mạch gói vẫn thực hiện chức năng truyền dữ liệu của mình?

> **Nguyên tắc quan trọng nhất trong hoạt động của các mạng chuyển mạch gói là việc biểu diễn thông tin được truyền qua mạng dưới dạng các phần dữ liệu riêng lẻ có cấu trúc, được gọi là các gói (packets).**

Mỗi gói có một phần **tiêu đề (header)** (Hình 3.5), trong đó chứa địa chỉ đích và các thông tin bổ sung khác (độ dài của trường dữ liệu, tổng kiểm tra (checksum), v.v.). Việc có địa chỉ trong mỗi gói là một trong những đặc điểm quan trọng nhất của công nghệ chuyển mạch gói, vì mỗi gói có thể được xử lý bởi bộ chuyển mạch một cách độc lập với các gói khác trong luồng mạng. Ngoài tiêu đề, mỗi gói còn có một trường bổ sung được đặt ở cuối gói, được gọi là **đoạn kết (trailer)**. Trong đoạn kết thường chứa một tổng kiểm tra (checksum), cho phép kiểm tra xem thông tin có bị sai lệch trong quá trình truyền hay không.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.5.png" alt="Hình 3.5. Phân chia dữ liệu thành các gói tin" width="900">
</p>
<p align="center"><b>Hình 3.5. Phân chia dữ liệu thành các gói tin</b></p>

Tùy thuộc vào việc triển khai cụ thể công nghệ chuyển mạch gói (packet switching), các gói có thể có độ dài cố định hoặc biến đổi. Ngoài ra, thành phần thông tin trong tiêu đề của các gói cũng có thể khác nhau. Ví dụ, trong công nghệ ATM, các gói (gọi là "ô" - cells) có độ dài cố định, trong khi đó, trong công nghệ Ethernet, chỉ quy định độ dài tối thiểu và tối đa của các gói (khung - frames).

Các gói được gửi vào mạng với tốc độ do nguồn (source) sinh ra. Người ta giả định rằng mạng chuyển mạch gói, không giống như mạng chuyển mạch kênh (channel switching network), luôn sẵn sàng nhận gói tại nút cuối (end node).

Cũng như trong các mạng chuyển mạch kênh, trong các mạng chuyển mạch gói, tuyến đường (route) cho từng luồng dữ liệu được xác định thủ công hoặc tự động bằng các bảng chuyển mạch (switching tables) lưu trong các bộ chuyển mạch (switches). Các gói khi đến bộ chuyển mạch được xử lý và định tuyến theo tuyến đường này dựa trên thông tin trong tiêu đề của chúng, cũng như trong bảng chuyển mạch (Hình 3.6).

Các gói thuộc cùng một hoặc các luồng thông tin khác nhau, khi di chuyển trong mạng, có thể "chen lấn" lẫn nhau, tạo thành hàng đợi (queues) và làm "chậm" nhau. Trên đường đi, các gói có thể gặp các đường truyền có băng thông khác nhau. Tùy thuộc vào thời gian, tốc độ của mạng có thể thay đổi đáng kể theo mức độ sử dụng và độ tải của các đường truyền. Trong các trường hợp như vậy, không loại trừ tình huống các gói, thuộc cùng một luồng dữ liệu, có thể di chuyển với các tốc độ khác nhau và thậm chí đến điểm đích không theo thứ tự ban đầu.

Việc chia dữ liệu thành các gói (packets) cho phép truyền tải lưu lượng máy tính không đều một cách hiệu quả hơn so với các mạng chuyển mạch kênh (channel switching networks). Điều này được giải thích bởi sự xung nhịp (pulsation) của lưu lượng từ các máy tính riêng lẻ mang tính ngẫu nhiên và được phân bổ theo thời gian, làm cho các đỉnh của chúng hiếm khi trùng nhau. Vì vậy, khi một đường truyền chuyển tiếp lưu lượng của nhiều nút cuối (end nodes), các xung nhịp trong luồng tổng hợp trở nên mượt mà hơn và băng thông của đường truyền được sử dụng hợp lý hơn, không có tình trạng chờ đợi kéo dài.

Ví dụ, trong Hình 3.7, các luồng gói không đồng đều từ các nút cuối 3, 4 và 10 trong mạng được hiển thị ở Hình 3.6. Giả sử rằng các luồng này được truyền theo hướng đến bộ chuyển mạch (switch) số 8 và do đó chồng chéo lên nhau khi đi qua đường truyền giữa các bộ chuyển mạch số 5 và số 8. Kết quả là luồng tổng hợp thu được trở nên đều đặn hơn so với từng luồng riêng lẻ hình thành nên nó.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.6.png" alt="Hình 3.6. Truyền dữ liệu qua mạng dưới dạng các gói tin" width="900">
</p>
<p align="center"><b>Hình 3.6. Truyền dữ liệu qua mạng dưới dạng các gói tin</b></p>

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.7.png" alt="Hình 3.7. Làm mượt lưu lượng trong các mạng chuyển mạch gói tin" width="900">
</p>
<p align="center"><b>Hình 3.7. Làm mượt lưu lượng trong các mạng chuyển mạch gói tin</b></p>


##### 3.2.1 Bộ đệm gói (Packet Buffering)

Tính không xác định và tính không đồng bộ trong việc di chuyển dữ liệu qua mạng chuyển mạch gói (packet switching networks) đặt ra các yêu cầu đặc biệt đối với hoạt động của các bộ chuyển mạch (switches) trong mạng này.

> **Sự khác biệt chính giữa các bộ chuyển mạch gói (packet switches)** với các bộ chuyển mạch trong mạng chuyển mạch kênh là chúng có bộ nhớ đệm nội bộ (internal buffer memory) để lưu trữ tạm thời các gói.

Thực sự, một bộ chuyển mạch gói không thể quyết định việc chuyển tiếp một gói mà không lưu trữ toàn bộ gói trong bộ nhớ. Bộ chuyển mạch kiểm tra **tổng kiểm tra (checksum)**; nếu nó cho thấy dữ liệu gói không bị lỗi, bộ chuyển mạch sẽ bắt đầu xử lý gói, xác định bộ chuyển mạch tiếp theo dựa trên địa chỉ đích. Do đó, **mỗi gói** được đặt lần lượt, từng bit một, vào **bộ đệm đầu vào (input buffer)**. Lưu ý rằng, với đặc điểm này, các mạng chuyển mạch gói sử dụng kỹ thuật **lưu trữ và chuyển tiếp (store-and-forward)**. Để thực hiện kỹ thuật này, bộ chuyển mạch chỉ cần có một bộ đệm có kích thước tương đương với một gói dữ liệu.

Tuy nhiên, các bộ đệm cũng cần thiết cho những mục đích khác, đặc biệt là **điều chỉnh tốc độ truyền tải dữ liệu trên các đường truyền (data transmission lines)** được kết nối với giao diện của bộ chuyển mạch. Thật vậy, nếu tốc độ dòng gói trên một đường truyền trong một khoảng thời gian nào đó vượt quá khả năng truyền tải của đường truyền mà gói cần đến, thì để tránh mất mát gói trên giao diện đích, cần tổ chức một **hàng đợi đầu ra (output queue)** (Hình 3.8).

Bộ đệm hóa (buffering) là cần thiết để điều chỉnh tốc độ xử lý của các gói trong bộ chuyển mạch. Nếu khối xử lý của bộ chuyển mạch không kịp xử lý các gói (phân tích tiêu đề và chuyển hướng gói đến giao diện đích), **hàng đợi đầu vào (input queues)** sẽ hình thành ở các giao diện của bộ chuyển mạch. Rõ ràng là để lưu trữ hàng đợi đầu vào, bộ đệm cần có kích thước ít nhất bằng một gói dữ liệu.

Có nhiều cách tiếp cận khác nhau để xây dựng khối xử lý trong bộ chuyển mạch. Cách tiếp cận truyền thống dựa trên một bộ xử lý trung tâm duy nhất (central processor), bộ xử lý này phục vụ tất cả các hàng đợi đầu vào của bộ chuyển mạch, điều này có thể dẫn đến các hàng đợi lớn, vì hiệu suất xử lý giảm khi phải chia sẻ tài nguyên giữa nhiều giao diện. Các phương pháp hiện đại sử dụng cách tiếp cận đa xử lý (multiprocessing approach), trong đó mỗi giao diện có bộ xử lý riêng để xử lý các gói. Ngoài ra, có một bộ xử lý điều phối (coordinating processor), giúp tăng hiệu suất của bộ chuyển mạch và giảm tải cho các giao diện. Tuy nhiên, các hàng đợi vẫn có thể xuất hiện, vì bộ xử lý trung tâm phải đảm bảo sự đồng bộ hóa của tất cả các quá trình. Các vấn đề cụ thể hơn liên quan đến kiến trúc bộ đệm nội bộ sẽ được xem xét trong chương 11.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.8.png" alt="Hình 3.8. Bộ đệm và hàng đợi gói trong bộ chuyển mạch" width="900">
</p>
<p align="center"><b>Hình 3.8. Bộ đệm và hàng đợi gói trong bộ chuyển mạch</b></p>

Do dung lượng bộ đệm (buffer) trong các bộ chuyển mạch (switch) bị giới hạn, đôi khi xảy ra hiện tượng **mất gói (packet loss)** do tràn bộ đệm khi một phần của mạng bị quá tải tạm thời, ví dụ như khi các giai đoạn xung nhịp của một số luồng thông tin trùng nhau. Để bù đắp cho những tổn thất như vậy, công nghệ chuyển mạch gói (packet switching) đã dự trù một số cơ chế đặc biệt, sẽ được xem xét chi tiết sau.

Bộ chuyển mạch gói có thể hoạt động dựa trên một trong ba phương pháp chuyển tiếp gói sau:

- **Chuyển tiếp dạng datagram (datagram-based forwarding);**
- **Chuyển tiếp với thiết lập kết nối logic (logical connection establishment);**
- **Chuyển tiếp với thiết lập kênh ảo (virtual channel establishment).**
  
---

##### 3.2.2 Truyền tải dạng datagram

> **Phương pháp truyền tải dữ liệu dạng datagram** dựa trên nguyên tắc rằng tất cả các gói dữ liệu được truyền đi (chuyển từ một nút mạng này sang nút mạng khác) một cách độc lập với nhau theo cùng một quy tắc. Không có thông tin nào về các gói đã được truyền đi trước đó được lưu trữ trong mạng và trong quá trình xử lý gói mới, thông tin về các gói trước đó không được xem xét. Nói cách khác, mỗi gói riêng lẻ được mạng xem xét như một đơn vị truyền tải hoàn toàn độc lập - **datagram.**

Quyết định về việc chuyển tiếp gói được đưa ra dựa trên **bảng chuyển mạch (switching table)**, bảng này liên kết địa chỉ đích của các gói với thông tin xác định rõ ràng nút trung gian (hoặc nút cuối) tiếp theo trên tuyến đường. Dữ liệu này có thể bao gồm các **định danh giao diện (interface identifiers)** của bộ chuyển mạch hoặc địa chỉ của các giao diện đầu vào của các bộ chuyển mạch tiếp theo trên tuyến đường.

Trong **Hình 3.9**, minh họa một mạng trong đó sáu nút cuối (N1-N6) được kết nối với bảy bộ chuyển mạch (S1-S7). Cũng cho thấy một số gói đang di chuyển trên các tuyến đường khác nhau với các địa chỉ đích khác nhau (N1-N6), trong đó có bộ chuyển mạch S1 nằm trên tuyến đường của chúng. Khi mỗi gói đến bộ chuyển mạch S1, nó sẽ được kiểm tra trong bảng chuyển mạch để xác định tuyến đường tiếp theo. Ví dụ, gói có địa chỉ N5 sẽ được bộ chuyển mạch S1 gửi qua giao diện dẫn đến bộ chuyển mạch S6, nơi cuối cùng gói này sẽ được chuyển đến nút cuối cùng, người nhận N5.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.9.png" alt="Hình 3.9. Minh họa nguyên tắc truyền dữ liệu kiểu datagram" width="900">
</p>
<p align="center"><b>Hình 3.9. Minh họa nguyên tắc truyền dữ liệu kiểu datagram</b></p>

Trong bảng chuyển mạch (switching table), đối với cùng một địa chỉ đích, có thể chứa nhiều bản ghi, mỗi bản ghi tương ứng với các địa chỉ khác nhau của bộ chuyển mạch tiếp theo. Cách tiếp cận này được gọi là **cân bằng tải (load balancing)** và được sử dụng để cải thiện hiệu suất và độ tin cậy của mạng. Ví dụ, như được minh họa trong Hình 3.9, các gói đến bộ chuyển mạch S1 với địa chỉ đích N2 được phân phối giữa hai bộ chuyển mạch tiếp theo — S2 và S3, điều này giúp giảm tải cho từng bộ chuyển mạch và do đó, rút ngắn hàng đợi và tăng tốc độ truyền tải. Một số **sự đa dạng (diversity)** trong các tuyến đường mà các gói với cùng một địa chỉ đích có thể đi qua mạng là kết quả tự nhiên của nguyên tắc xử lý độc lập từng gói, đặc trưng cho phương pháp datagram.

Các gói, theo cùng một địa chỉ đích, có thể đến đích thông qua các tuyến đường khác nhau do sự thay đổi trạng thái của mạng, chẳng hạn như khi một bộ chuyển mạch trung gian gặp sự cố.

Phương pháp datagram hoạt động nhanh chóng, vì không cần thực hiện bất kỳ hành động chuẩn bị nào trước khi gửi dữ liệu. Tuy nhiên, với phương pháp này, rất khó để xác minh xem gói có được gửi đến đích hay không.

> **Trong phương pháp datagram, việc giao gói không được đảm bảo mà được thực hiện theo khả năng — đặc tính này được mô tả bằng thuật ngữ "giao theo nỗ lực tốt nhất" (best effort).**

##### 3.2.3 Truyền tải với thiết lập kết nối logic

Phương pháp tiếp theo được xem xét về chuyển tiếp gói dựa trên việc các thiết bị mạng "ghi nhớ" lịch sử trao đổi dữ liệu, ví dụ, nút gửi nhớ số lượng gói đã gửi, trong khi nút nhận nhớ số lượng gói đã nhận. Loại thông tin này được ghi nhận trong phạm vi của một **kết nối logic (logical connection).**

> **Quy trình thỏa thuận giữa hai nút cuối của mạng về một số tham số của quá trình trao đổi gói được gọi là thiết lập kết nối logic. Các tham số mà hai nút này thỏa thuận được gọi là các tham số của kết nối logic.**

Sự tồn tại của kết nối logic cho phép xử lý gói một cách hợp lý hơn so với phương pháp datagram. Ví dụ, khi mất một số gói trước đó, tốc độ gửi các gói tiếp theo có thể bị giảm. Ngược lại, nhờ việc đánh số các gói và theo dõi số thứ tự của các gói đã gửi và nhận, có thể nâng cao độ tin cậy bằng cách loại bỏ các bản sao (duplicates), sắp xếp thứ tự của các gói đến và truyền lại các gói bị mất.

Các tham số của kết nối có thể là **cố định (static)**, tức là không thay đổi trong suốt quá trình kết nối (ví dụ: định danh kết nối, phương thức mã hóa gói hoặc kích thước tối đa của gói dữ liệu), hoặc **thay đổi (dynamic)**, tức là được điều chỉnh trong suốt kết nối (ví dụ: số thứ tự gói tiếp theo được truyền).

Khi người gửi và người nhận thiết lập một **bắt đầu cố định (fixed initial state)** của kết nối logic, chúng sẽ thỏa thuận về các tham số của quy trình trao đổi và chỉ sau đó bắt đầu truyền dữ liệu.

**Truyền tải với thiết lập kết nối logic bao gồm ba giai đoạn (Hình 3.10):**

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.10.png" alt="Hình 3.10. Truyền dữ liệu không thiết lập kết nối (a) và có thiết lập kết nối (b)" width="900">
</p>
<p align="center"><b>Hình 3.10. Truyền dữ liệu không thiết lập kết nối (a) và có thiết lập kết nối (b)</b></p>

- **Thiết lập kết nối logic**, bắt đầu từ việc nút khởi tạo kết nối gửi đến nút nhận một gói dịch vụ với đề nghị thiết lập kết nối. Nếu nút nhận đồng ý, nó gửi lại một gói dịch vụ khác, xác nhận thiết lập kết nối và đề xuất một số tham số cần được sử dụng trong phạm vi kết nối logic này. Những tham số này có thể bao gồm, ví dụ: định danh kết nối, số lượng gói có thể được gửi mà không cần xác nhận, v.v. Nút khởi tạo kết nối có thể kết thúc quá trình thiết lập kết nối bằng cách gửi gói dịch vụ thứ ba, trong đó nó thông báo rằng các tham số đề xuất là phù hợp với nó.

- **Truyền dữ liệu (Data Transmission):** Sau khi kết nối được thiết lập và tất cả các tham số được thỏa thuận, các nút cuối bắt đầu truyền dữ liệu thực tế. Kết nối logic (logical connection) có thể được thiết kế để truyền dữ liệu theo một hướng (từ nút khởi tạo kết nối - initiator) hoặc theo cả hai hướng.

- **Ngắt kết nối logic (Logical Connection Termination):** Sau khi truyền tải một tập hợp dữ liệu hoàn chỉnh, ví dụ như một tệp cụ thể, nút gửi (sending node) sẽ khởi tạo quy trình ngắt kết nối logic, tương tự như quy trình thiết lập kết nối.

Lưu ý rằng, không giống như truyền tải dạng datagram (datagram transmission), trong đó chỉ hỗ trợ một loại gói — gói thông tin (informational packets), truyền tải với thiết lập kết nối (connection-oriented transmission) phải hỗ trợ ít nhất hai loại gói — gói thông tin, mang dữ liệu của người dùng, và gói dịch vụ (service packets), được thiết kế để thiết lập hoặc ngắt kết nối.

Các gói thông tin được các bộ chuyển mạch (switches) xử lý giống như trong truyền tải dạng datagram: từ tiêu đề của gói, địa chỉ đích được trích xuất và so sánh với các bản ghi trong bảng chuyển mạch (switching tables), chứa thông tin về các bước tiếp theo trên tuyến đường. Cũng như các datagram, các gói thuộc cùng một kết nối logic (logical connection) trong một số trường hợp (ví dụ: khi có sự cố đường truyền) có thể đến đích thông qua các tuyến đường khác nhau.

Tuy nhiên, truyền tải với thiết lập kết nối có sự khác biệt quan trọng so với truyền tải dạng datagram, bởi vì ngoài việc xử lý các gói tại các bộ chuyển mạch, còn có việc **xử lý bổ sung tại các nút cuối (end nodes)**. Ví dụ, nếu khi thiết lập kết nối đã thỏa thuận rằng dữ liệu sẽ được truyền dưới dạng mã hóa, thì việc mã hóa sẽ do nút gửi thực hiện, và việc giải mã sẽ do nút nhận thực hiện. Tương tự, trong phạm vi kết nối logic, tất cả các công việc đảm bảo độ tin cậy, như đánh số gói, theo dõi các gói đã nhận và chưa nhận, gửi lại các bản sao, và loại bỏ các bản sao dư thừa, đều được thực hiện bởi các nút cuối.

Cơ chế thiết lập kết nối logic cho phép thực hiện phân hóa (differentiation) trong xử lý các luồng thông tin. Ngay cả các luồng dữ liệu thuộc cùng một cặp nút cuối cũng có thể được phục vụ khác nhau. Ví dụ, một cặp nút cuối có thể thiết lập hai kết nối logic song song, trong đó dữ liệu trong một kết nối được truyền ở dạng mã hóa, và trong kết nối còn lại là dạng văn bản thuần túy.

> **Như đã thấy, truyền tải với thiết lập kết nối cung cấp nhiều khả năng hơn về độ tin cậy và bảo mật trong trao đổi dữ liệu so với truyền tải dạng datagram. Tuy nhiên, phương pháp này chậm hơn, vì nó bao hàm chi phí tính toán bổ sung cho việc thiết lập và duy trì kết nối logic.**

##### 3.2.4  Truyền tải với thiết lập kênh ảo (Virtual Channel Transmission)

Phương pháp tiếp theo để chuyển tiếp dữ liệu trong các mạng gói dựa trên một trường hợp đặc biệt của kết nối logic (logical connection), trong đó các tham số của kết nối bao gồm tuyến đường cố định (route) cho tất cả các gói. Điều này có nghĩa là các gói, được truyền trong phạm vi kết nối này, phải đi theo một tuyến đường duy nhất đã được cố định cho kết nối đó.

> **Tuyến đường cố định duy nhất được thiết lập trước, kết nối các nút cuối trong mạng chuyển mạch gói, được gọi là kênh ảo (virtual circuit hoặc virtual channel).**

Các kênh ảo được thiết lập để phục vụ các luồng thông tin ổn định (stable information flows). Với mục đích phân biệt luồng dữ liệu khỏi lưu lượng chung, mỗi gói thuộc luồng này được đánh dấu bằng một nhãn đặc biệt (label).

Cũng như trong mạng với thiết lập kết nối logic, việc thiết lập một kênh ảo bắt đầu bằng việc nút nguồn (source node) gửi một gói đặc biệt — yêu cầu thiết lập kết nối (connection establishment request). Trong yêu cầu này, địa chỉ đích và nhãn của luồng, mà kênh ảo này được thiết lập, được chỉ định. Yêu cầu này, khi đi qua mạng, tạo ra một bản ghi mới trong bảng của mỗi bộ chuyển mạch (switch) nằm trên tuyến đường từ nút gửi đến nút nhận. Bản ghi cho biết cách bộ chuyển mạch cần xử lý gói có nhãn đã chỉ định. Kênh ảo được thiết lập được xác định bởi nhãn này.

Sau khi kênh ảo được thiết lập, luồng dữ liệu tương ứng có thể được truyền qua nó. Với mỗi gói, mang dữ liệu của người dùng, địa chỉ đích không còn được chỉ định, mà chỉ cần nhãn của kênh ảo. Khi nhận một gói, giao diện đầu vào của bộ chuyển mạch sẽ đọc giá trị nhãn từ tiêu đề gói, kiểm tra bảng chuyển mạch, và xác định giao diện đầu ra mà qua đó gói cần được chuyển tiếp.

Trong **Hình 3.11**, một mạng được hiển thị, trong đó hai kênh ảo (virtual channels) được thiết lập, được xác định bởi các nhãn VC1 và VC2. Kênh đầu tiên đi từ nút cuối với địa chỉ N1 đến nút cuối với địa chỉ N2 qua các bộ chuyển mạch trung gian S1, S2 và S4. Kênh ảo thứ hai, VC2, đảm bảo việc truyền dữ liệu theo tuyến N1 → S1 → S3 → S5 → N3. 

Trong trường hợp chung, giữa hai nút cuối có thể có nhiều kênh ảo, ví dụ, một kênh ảo khác giữa các nút N1 và N2 có thể đi qua bộ chuyển mạch trung gian S3. Trên hình minh họa, có hai gói dữ liệu được hiển thị, mang trong tiêu đề của chúng các nhãn luồng VC1 và VC2, các nhãn này đóng vai trò là địa chỉ đích.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.11.png" alt="Hình 3.11. Minh họa nguyên lý hoạt động của kênh ảo" width="900">
</p>
<p align="center"><b>Hình 3.11. Minh họa nguyên lý hoạt động của kênh ảo</b></p>

Bảng chuyển mạch (switching table) trong các mạng sử dụng kênh ảo (virtual channels) khác với bảng chuyển mạch trong các mạng datagram. Nó chỉ chứa các bản ghi về **các kênh ảo đi qua bộ chuyển mạch**, chứ không phải tất cả các địa chỉ đích có thể, như trong các mạng với thuật toán datagram. Thông thường, số lượng kênh ảo đi qua một nút nhỏ hơn đáng kể so với tổng số nút trong mạng lớn, vì vậy bảng chuyển mạch trong trường hợp này ngắn hơn nhiều và do đó, việc phân tích bảng mất ít thời gian hơn tại bộ chuyển mạch. Vì lý do này, nhãn (label) ngắn hơn địa chỉ của nút đích, và tiêu đề của gói trong mạng với kênh ảo truyền tải một mã định danh dòng ngắn gọn thay vì một địa chỉ dài.

**Lưu ý:**

Việc sử dụng kỹ thuật kênh ảo trong mạng không làm cho chúng trở thành các mạng chuyển mạch kênh (circuit switching networks). Mặc dù các mạng này cũng có quy trình thiết lập kênh trước (pre-established channel procedure), kênh này là ảo (virtual), tức là nó được sử dụng để truyền các gói riêng lẻ, chứ không phải là một luồng thông tin cố định với tốc độ không đổi như trong mạng chuyển mạch kênh.

Trong cùng một công nghệ mạng, có thể có các cách tiếp cận khác nhau để chuyển tiếp dữ liệu. Ví dụ, để truyền dữ liệu giữa các mạng riêng biệt trong Internet, giao thức datagram IP được sử dụng. Đồng thời, việc đảm bảo truyền dữ liệu đáng tin cậy giữa các nút cuối của mạng này được thực hiện bởi giao thức TCP, thiết lập kết nối logic (logical connection) mà không cố định tuyến đường. Cuối cùng, Internet cũng là ví dụ của một mạng sử dụng kỹ thuật kênh ảo, vì Internet bao gồm nhiều mạng MPLS hỗ trợ kênh ảo.

#### 3.3 So sánh mạng chuyển mạch kênh và chuyển mạch gói

Để so sánh các đặc tính của mạng chuyển mạch kênh (circuit switching networks) và mạng chuyển mạch gói (packet switching networks), sử dụng bảng 3.3.

**Bảng 3.3. So sánh mạng chuyển mạch kênh và chuyển mạch gói**

| **Chuyển mạch kênh**                                | **Chuyển mạch gói**                                        |
|------------------------------------------------------|------------------------------------------------------------|
| Cần thiết lập kết nối trước                         | Không cần giai đoạn thiết lập kết nối (phương pháp datagram) |
| Địa chỉ chỉ cần tại giai đoạn thiết lập kết nối      | Địa chỉ và các thông tin dịch vụ khác được truyền với mỗi gói |
| Mạng có thể từ chối thiết lập kết nối cho thuê bao  | Mạng luôn sẵn sàng nhận dữ liệu từ thuê bao                 |
| Băng thông được đảm bảo (guaranteed bandwidth) cho thuê bao đang hoạt động | Băng thông cho thuê bao không được xác định, độ trễ truyền mang tính ngẫu nhiên |
| Lưu lượng thời gian thực được truyền tải mà không có độ trễ | Tài nguyên mạng được sử dụng hiệu quả hơn khi truyền tải lưu lượng xung nhịp |
| Độ tin cậy truyền tải cao                           | Có thể xảy ra mất dữ liệu do tràn bộ đệm                   |
| Sử dụng không hợp lý băng thông vật lý của kênh, làm giảm hiệu quả chung của mạng | Phân bổ băng thông vật lý của kênh một cách tự động, linh hoạt giữa các thuê bao |

**Lưu ý:**

Trước khi thực hiện so sánh kỹ thuật giữa mạng chuyển mạch kênh và mạng chuyển mạch gói, chúng ta tiến hành so sánh không chính thức dựa trên cách mà chúng mô tả, ví dụ như một phương pháp ẩn dụ giao thông vận tải đầy hiệu quả.

---

##### 3.3.1 Ẩn dụ giao thông cho mạng chuyển mạch gói và kênh

Đầu tiên, hãy xác nhận rằng chuyển động trên đường có nhiều điểm chung với việc di chuyển các gói trong mạng **chuyển mạch gói (packet switching network)**.

Hãy giả sử rằng trong ẩn dụ này, các xe ô tô tượng trưng cho các gói (packets), đường là các kênh truyền (communication channels), và ngã tư là các bộ chuyển mạch (switches). Tương tự như các gói, các xe ô tô di chuyển độc lập với nhau, chia sẻ băng thông của đường và tạo ra sự cản trở lẫn nhau.

Lưu lượng giao thông quá mức, không phù hợp với khả năng băng thông của đường, dẫn đến tắc nghẽn, tương đương với việc các gói phải chờ tại các bộ chuyển mạch.

Tại ngã tư, diễn ra "chuyển mạch" các luồng xe, mỗi xe chọn hướng đi phù hợp tại ngã tư để đến đích. Tất nhiên, ngã tư đóng vai trò bị động hơn nhiều so với các bộ chuyển mạch. Vai trò tích cực của ngã tư trong việc xử lý lưu lượng có thể thấy ở các ngã tư có tín hiệu đèn giao thông, nơi dòng xe được điều phối. Một vai trò chủ động hơn nữa là của cảnh sát giao thông, người có thể sắp xếp luồng xe cho từng tuyến và từng xe riêng biệt.

Cũng như trong mạng chuyển mạch gói, sự hình thành tắc nghẽn trên đường là kết quả của sự không đều trong lưu lượng xe. Ví dụ, ngay cả khi tốc độ của một xe giảm trong một đoạn đường hẹp, nó có thể tạo ra một tắc nghẽn lớn nếu các xe luôn di chuyển với cùng một tốc độ và khoảng cách đều nhau.

Bây giờ, hãy tìm điểm chung giữa lưu thông xe và mạng **chuyển mạch kênh (circuit switching network).**

Đôi khi trên đường, cần đảm bảo điều kiện đặc biệt cho việc di chuyển của một đoàn xe. Ví dụ, giả sử một đoàn xe buýt dài chở trẻ em từ thành phố đến trại hè trên một đường cao tốc nhiều làn. Để đoàn xe không bị cản trở, một tuyến đường được lên kế hoạch trước. 

Trên toàn bộ tuyến đường, một làn đường riêng được phân bổ cho đoàn xe tại tất cả các đoạn đường. Làn đường được giải phóng trước khỏi các xe khác và không được sử dụng bởi các phương tiện khác cho đến khi đoàn xe đến đích. Trong quá trình di chuyển, các xe trong đoàn đi với tốc độ giống nhau và khoảng cách đều nhau, không cản trở lẫn nhau. Tuy nhiên, các xe trong đoàn không thể tự rời khỏi đoàn hoặc rẽ sang hướng khác. Đường trong cách tổ chức như vậy không hiệu quả – làn đường phần lớn bị bỏ trống, giống như trong các mạng **chuyển mạch kênh.**

---

##### 3.3.2 Cấu trúc độ trễ trong mạng chuyển mạch kênh và gói

Hãy quay trở lại từ ẩn dụ xe hơi đến lưu lượng mạng. Giả sử người dùng mạng cần truyền một lưu lượng không đều đặn, bao gồm các khoảng thời gian hoạt động và tạm dừng. Giả sử thêm rằng người dùng có thể chọn, qua mạng nào (chuyển mạch kênh hoặc gói), để truyền tải lưu lượng của mình, và hiệu suất của kênh trong cả hai mạng là như nhau. 

Rõ ràng, hiệu quả hơn từ góc nhìn về độ trễ thời gian đối với người dùng sẽ là việc sử dụng mạng chuyển mạch kênh, nơi một kênh được dành riêng hoàn toàn cho người dùng. Với cách này, tất cả dữ liệu được truyền đến địa chỉ đích mà không có độ trễ. Thực tế rằng một phần lớn thời gian kênh sẽ bị bỏ trống (trong các khoảng tạm dừng) không quan trọng với người dùng – điều quan trọng đối với anh ta là giải quyết nhanh chóng nhiệm vụ của mình.

Nếu người dùng sử dụng dịch vụ của mạng chuyển mạch gói, thì quá trình truyền tải dữ liệu có thể chậm hơn, vì các gói của anh ta, có thể, sẽ bị chờ trong hàng đợi, đợi các tài nguyên mạng cần thiết được giải phóng, cùng với các gói của người dùng khác.

Hãy xem xét chi tiết hơn cơ chế phát sinh độ trễ khi truyền tải dữ liệu trong các mạng của cả hai loại. Giả sử một tin nhắn được gửi từ nút cuối N1 đến nút cuối N2 (Hình 3.12). Trên đường truyền dữ liệu có hai bộ chuyển mạch.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.12.png" alt="Hình 3.12. Biểu đồ thời gian truyền tin trong mạng chuyển mạch kênh" width="900">
</p>
<p align="center"><b>Hình 3.12. Biểu đồ thời gian truyền tin trong mạng chuyển mạch kênh</b></p>

Trong **mạng chuyển mạch kênh (circuit switching network)**, dữ liệu sau độ trễ, liên quan đến việc thiết lập kênh, bắt đầu được truyền với tốc độ chuẩn của kênh. Thời gian truyền dữ liệu đến địa chỉ đích $$T$$ bằng tổng thời gian lan truyền tín hiệu trong kênh $$t_{prg}$$ (prg — propagation) và thời gian truyền thông tin trong kênh $$t_{trns}$$ (trns — transmission), được gọi là **thời gian tuần tự hóa (serialization time)**.

Sự hiện diện của các bộ chuyển mạch trong mạng chuyển mạch kênh không ảnh hưởng đến tổng thời gian truyền dữ liệu qua mạng.

**Lưu ý:**

Thời gian truyền tin nhắn trong kênh trùng khớp hoàn toàn với thời gian nhận tin nhắn đó tại bộ đệm của nút đích, tức là với **thời gian đệm (buffering time)**.

Thời gian lan truyền tín hiệu phụ thuộc vào khoảng cách giữa các thuê bao $$L$$ và tốc độ $$S$$ lan truyền sóng điện từ trong môi trường vật lý cụ thể, dao động từ 0,6 đến 0,9 tốc độ ánh sáng trong chân không:

$$
t_{prg} = L / S.
$$

Thời gian tuần tự hóa (tức là thời gian đệm tại nút đích) bằng tỷ lệ giữa kích thước tin nhắn$$V$$tính bằng bit và băng thông của kênh$$C$$tính bằng bit trên giây:

$$
t_{trns} = V / C.
$$

Trong **mạng chuyển mạch gói (packet switching network)**, việc truyền dữ liệu không yêu cầu thiết lập kết nối bắt buộc. Giả sử rằng trong mạng, được minh họa trong Hình 3.13, tin nhắn có kích thước $$V$$ , giống như trong trường hợp trước (Hình 3.12), nhưng nó được chia thành các gói, mỗi gói đi kèm với một tiêu đề. Các gói được truyền từ nút N1 đến nút N2, giữa chúng có hai bộ chuyển mạch. Tại mỗi bộ chuyển mạch, mỗi gói bị giữ lại hai lần: tại thời điểm đến giao diện đầu vào và tại thời điểm truyền vào giao diện đầu ra của mạng. Như thấy rõ, bộ chuyển mạch giữ gói trong một thời gian nhất định. Ở đây, $$T_1$$ là thời gian truyền đến địa chỉ của gói đầu tiên trong tin nhắn, và $$T_{ps}$$ là toàn bộ tin nhắn.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.13.png" alt="Hình 3.13. Biểu đồ thời gian truyền tin nhắn, được chia thành các gói, trong mạng chuyển mạch gói." width="900">
</p>
<p align="center"><b>Hình 3.13. Biểu đồ thời gian truyền tin nhắn, được chia thành các gói, trong mạng chuyển mạch gói.</b></p>


Khi so sánh biểu đồ thời gian truyền dữ liệu trong mạng **chuyển mạch kênh (circuit switching)** và **chuyển mạch gói (packet switching)**, chúng ta lưu ý hai điểm:

- Giá trị **thời gian lan truyền tín hiệu $$t_{prg}$$** trong cùng một môi trường vật lý và với cùng một khoảng cách là giống nhau;

- Vì băng thông của các kênh trong cả hai mạng là như nhau, giá trị **thời gian truyền tin nhắn trong kênh $$t_{prg}$$** cũng bằng nhau.

Tuy nhiên, việc chia tin nhắn thành các gói và sau đó truyền chúng qua mạng chuyển mạch gói dẫn đến các độ trễ bổ sung. Hãy theo dõi đường đi của gói đầu tiên và lưu ý các thành phần tạo nên thời gian truyền của nó đến nút đích, và thành phần nào là đặc trưng riêng cho mạng chuyển mạch gói (Hình 3.14).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.14.png" alt="Hình 3.14. Biểu đồ thời gian truyền một gói trong mạng chuyển mạch gói" width="900">
</p>
<p align="center"><b>Hình 3.14. Biểu đồ thời gian truyền một gói trong mạng chuyển mạch gói</b></p>

**Dịch đoạn văn:**

Thời gian truyền một gói từ nút $$N1$$ đến bộ chuyển mạch 1 có thể được biểu diễn dưới dạng tổng của một số thành phần:

- **Thứ nhất**, thời gian tiêu tốn tại nút gửi $$N1$$:
  - $$t_1$$ : Thời gian hình thành gói, còn được gọi là **thời gian đóng gói (packetization time)** (phụ thuộc vào các thông số hoạt động của phần mềm và phần cứng tại nút gửi và không phụ thuộc vào các tham số của mạng);
  - $$t_2$$ : Thời gian truyền tiêu đề vào kênh;
  - $$t_3$$ : Thời gian truyền dữ liệu gói vào kênh.

- **Thứ hai**, thời gian bổ sung tiêu tốn để lan truyền tín hiệu qua kênh truyền. Gọi $$t_4$$ là thời gian lan truyền tín hiệu, biểu thị thời gian truyền một bit thông tin từ nút $$N1$$ đến bộ chuyển mạch 1.

- **Thứ ba**, thời gian bổ sung tiêu tốn tại bộ chuyển mạch trung gian:
  - $$t_5$$: Thời gian nhận gói với tiêu đề từ kênh vào bộ đệm đầu vào của bộ chuyển mạch (như đã đề cập, bằng $$t_2 + t_3$$, tức là thời gian truyền gói với tiêu đề từ nút gửi);
  - $$t_6$$: Thời gian chờ gói trong hàng đợi, dao động trong một phạm vi rộng và không thể biết trước, vì phụ thuộc vào tải hiện tại của mạng;
  - $$t_7$$: Thời gian chuyển mạch gói khi nó được truyền qua cổng đầu ra, cố định cho mô hình cụ thể và thường không đáng kể (từ vài micro giây đến vài mili giây).

Gọi $$T_{N1-S1}$$ là thời gian truyền gói từ nút $$N1$$ đến cổng đầu ra của bộ chuyển mạch 1. Thời gian này bao gồm các thành phần sau:

$$
T_{N1-S1} = t_1 + t_4 + t_5 + t_6 + t_7.
$$

Lưu ý rằng, trong các thành phần trên không có $$t_2$$và$$t_3$$. Từ Hình 3.14, có thể thấy rằng quá trình truyền bit từ bộ phát vào kênh trùng khớp với thời gian truyền bit vào kênh.

Thời gian tiêu tốn trên hai đoạn đường còn lại, gọi là $$T_{S1-S2}$$và$$T_{S2-N2}$$. Các đại lượng này có cấu trúc tương tự $$T_{N1-S1}$$, ngoại trừ:
- $$T_{S1-S2}$$ không bao gồm thời gian đóng gói $$t_1$$;
- $$T_{S2-N2}$$ không bao gồm thời gian chuyển mạch $$t_7$$ (vì đoạn này kết thúc tại nút cuối). 

Do đó, thời gian truyền một gói duy nhất qua mạng là:

$$
T_1 = T_{N1-S1} + T_{S1-S2} + T_{S2-N2}.
$$

Thời gian truyền một tin nhắn bao gồm nhiều gói sẽ bằng tổng thời gian truyền tất cả các gói? Không! Vì mạng chuyển mạch gói hoạt động như một băng chuyền (Hình 3.13): gói tin được truyền qua nhiều giai đoạn, trong đó các thiết bị thực hiện các bước này song song. Do đó, thời gian truyền tin nhắn nhỏ hơn đáng kể so với tổng thời gian truyền từng gói tin.

Tuy nhiên, thời gian này khó tính chính xác do tính không xác định trong trạng thái tải của mạng và hàng đợi tại các bộ chuyển mạch. Giả sử các gói tin đứng trong hàng đợi với thời gian chờ tương đương nhau, thời gian truyền toàn bộ tin nhắn, bao gồm $$n$$ gói, có thể được ước lượng bằng:

$$
T_{PS} = T_1 + (n - 1) \cdot (t_1 + t_5).
$$

---

##### 3.3.3 So sánh định lượng về độ trễ. Ví dụ

Để minh họa, chúng ta giải bài toán so sánh tốc độ hoạt động của mạng **chuyển mạch kênh (circuit switching)** và **chuyển mạch gói (packet switching)** thông qua một ví dụ cụ thể, với các giả định về dữ liệu đầu vào cần thiết. Giả sử, chúng ta biết các thông tin sau:

- Dung lượng $$V$$ của tin nhắn, được truyền trong cả hai loại mạng, là $$10^7$$ byte.
- Nút gửi $$N1$$ cách nút nhận $$N2$$ một khoảng cách $$L = 5000$$ km.
- Tốc độ lan truyền tín hiệu $$S$$ là $$200 \,000 \, \text{km/s}$$ (tương đương $$2/3$$ tốc độ ánh sáng).
- Băng thông của kênh truyền $$C$$ là $$100 \, \text{Mbit/s}.$$

Thời gian truyền dữ liệu qua mạng **chuyển mạch kênh (circuit switching network)** bao gồm thời gian lan truyền tín hiệu và thời gian truyền tin nhắn trong kênh. Giả sử rằng kênh là cố định, nghĩa là nó đã được chuyển mạch, do đó thời gian thiết lập kết nối bằng 0.

- **Thời gian lan truyền tín hiệu (signal propagation time)** cho khoảng cách 5000 km có thể ước tính khoảng 25 ms:
  
 $$
  5000 \, \text{km} / 200\,000 \, \text{km/s} = 0,025 \, \text{s}.
 $$

- **Thời gian truyền tin nhắn trong kênh (message transmission time)** với băng thông 100 Mbit/s và kích thước tin nhắn 10 triệu byte là:
  
 $$
  (10^7 \times 8 \, \text{bit}) / (10^8 \, \text{bit/s}) = 8 \times 10^{-1} = 0,8 \, \text{s} = 800 \, \text{ms}.
 $$

Do đó, **thời gian truyền toàn bộ dữ liệu đến thuê bao $$N2$$ trong mạng chuyển mạch kênh là 825 ms.**

Bây giờ chúng ta tính thời gian truyền dữ liệu với dung lượng $$10^7$$ byte trong mạng **chuyển mạch gói (packet switching)**, giả sử rằng:

- **Băng thông của đường truyền** có cùng giá trị là 100 Mbit/s.
- **Số lượng bộ chuyển mạch trung gian** ($$S1 - S10$$) là mười.
- Tin nhắn ban đầu được chia thành các gói $$10^3$$ byte với tiêu đề 40 byte.
- **Khoảng thời gian ($$t_1$$)** giữa tất cả các gói là như nhau và bằng 100 µs.
- **Thời gian chuyển mạch ($$t_7$$)** trên mỗi bộ chuyển mạch là như nhau và bằng 50 µs.

$$
T_{N1-S1} = 100 \, \text{µs} + t_4^{(1)} + 83 \, \text{µs} + 50 \, \text{µs} = 233 \, \text{µs} + t_4^{(1)}.
$$

Thời gian $$T_{S1-S2}$$ truyền gói đầu tiên từ bộ chuyển mạch $$S1$$ đến bộ chuyển mạch$$S2$$ khác với việc không có thành phần $$t_1 = 100 \, \text{µs}$$ (gói đã được hình thành) và với thành phần $$t_4$$ phụ thuộc vào khoảng cách $$L_2$$ giữa bộ chuyển mạch $$S1$$ và $$S2$$. Điều này được ký hiệu là $$t_4^{(2)}$$.

Với điều này, chúng ta có:

$$
T_{S1-S2} = 133 \, \text{µs} + t_4^{(2)}.
$$

Tương tự, thời gian truyền dữ liệu giữa mỗi cặp bộ chuyển mạch liền kề có thể được biểu diễn như sau:

$$
T_{Si-Si+1} = 133 \, \text{µs} + t_4^{(i+1)},
$$

với $$i$$ thay đổi từ 1 đến 10.

Thời gian $$T_{S10-N2}$$ truyền gói từ bộ chuyển mạch $$S10$$ đến nút cuối $$N2$$ khác với việc không có thành phần $$t_7 = 50 \, \text{µs}$$ (tại nút cuối không có hoạt động chuyển mạch) và với thành phần $$t_4^{(11)}$$, phụ thuộc vào khoảng cách $$L_{11}$$ giữa bộ chuyển mạch $$S10$$ và nút $$N2$$.

Do đó:

$$
T_{S10-N2} = 83 \, \text{µs} + t_4^{(11)}.
$$

Bây giờ, chúng ta tìm thời gian tổng $$T_1$$ để truyền gói đầu tiên từ nút $$N1$$ đến nút $$N2$$:

$$
T_1 = T_{N1-S1} + T_{S1-S2} + \ldots + T_{S10-N2} = 233 \, \text{µs} + (133 \, \text{µs} \times 9) + 83 \, \text{µs} + \sum t_4^{(i)},
$$

với:

$$
\sum t_4^{(i)} = (\sum L_i) / S,
$$

với $$i$$ thay đổi từ 1 đến 11. Tổng khoảng cách giữa các nút liền kề và các bộ chuyển mạch bằng khoảng cách $$L$$ giữa nguồn và đích, tức là 5000 km, và mạng có cùng tốc độ. Do đó, thời gian truyền đầy đủ của gói đầu tiên là:

$$
T_1 = 0,001513 \, \text{s} + (5000 \, \text{km}) / (200 \,000 \, \text{km/s}) = 0,001513 \, \text{s} + 0,025 \, \text{s} = 0,026513 \, \text{s}.
$$


Mỗi gói tiếp theo sẽ đến sau khoảng thời gian 100 µs và tốn thêm 83 µs để lưu trữ vào bộ đệm. Do đó, thời gian truyền tin nhắn, bao gồm 10.000 gói, có thể được ước tính như sau:

$$
T_{PS} = T_1 + (10\,000 - 1) \cdot (t_1 + t_5) = 0,026513 + 9999 \cdot (0,0001 + 0,000083) = 0,026513 + 9999 \cdot 0,000183 = 0,026513 + 1,829817 = 1,85633 \, \text{s} = 1856 \, \text{ms}.
$$

> **Như vậy**, việc truyền dữ liệu trong các điều kiện đã nêu qua mạng **chuyển mạch gói** mất 1856 ms, lâu hơn 1031 ms so với mạng **chuyển mạch kênh**, nơi quá trình truyền tương tự chỉ mất 825 ms.

#### 3.4 Ethernet – một ví dụ về công nghệ tiêu chuẩn với chuyển mạch gói

Hãy xem cách các khái niệm đã được mô tả trước đó được triển khai trong một trong những công nghệ mạng tiêu chuẩn đầu tiên – công nghệ **Ethernet**, hoạt động với tốc độ bit 10 Mbit/s. Trong phần này, chúng ta chỉ đề cập đến các nguyên tắc cơ bản nhất của hoạt động Ethernet (mô tả chi tiết về công nghệ Ethernet được trình bày trong Phần III của cuốn sách này).

- **Tô-pô (Topology):** Có hai phiên bản công nghệ Ethernet:
  - Ethernet với môi trường chia sẻ;
  - Ethernet chuyển mạch (switched Ethernet).

Trong trường hợp đầu tiên, tất cả các nút mạng chia sẻ một môi trường chung để truyền dữ liệu, tức là mạng được xây dựng theo tô-pô dạng bus. Hình 3.15 minh họa phiên bản tô-pô đơn giản nhất – tất cả các máy tính trong mạng được kết nối với một môi trường chia sẻ, bao gồm một đoạn cáp đồng trục duy nhất, trong trường hợp này là một kênh truyền bán song công (half-duplex).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.15.png" alt="Hình 3.15. Mạng Ethernet trên môi trường chia sẻ" width="900">
</p>
<p align="center"><b>Hình 3.15. Mạng Ethernet trên môi trường chia sẻ</b></p>


Trong trường hợp mạng **Ethernet** không sử dụng môi trường chia sẻ, mà được xây dựng trên các bộ chuyển mạch (switches), được kết nối bằng các kênh truyền song công (full-duplex communication channels), thì được gọi là **Ethernet chuyển mạch (switched Ethernet)**. Tô-pô (topology) trong trường hợp này là một tô-pô cây (tree topology), tức là một cấu trúc mà giữa hai nút bất kỳ trong mạng chỉ tồn tại duy nhất một đường kết nối. Ví dụ về tô-pô của mạng **Ethernet chuyển mạch** được minh họa trong Hình 3.16.

Các hạn chế về tô-pô (topological restrictions) (chỉ cho phép cấu trúc dạng cây của các kết nối bộ chuyển mạch) liên quan đến cách xây dựng bảng định tuyến (forwarding tables) của các bộ chuyển mạch Ethernet.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/3.16.png" alt="Hình 3.16. Topology cây của mạng Ethernet chuyển mạch" width="900">
</p>
<p align="center"><b>Hình 3.16. Topology cây của mạng Ethernet chuyển mạch</b></p>

- **Phương pháp chuyển mạch (Switching method):** Trong công nghệ **Ethernet**, sử dụng **chuyển mạch kiểu datagram (datagram switching)**. Đơn vị dữ liệu mà các máy tính trao đổi trong mạng **Ethernet** được gọi là **khung (frame)**. Khung có định dạng cố định và, cùng với trường dữ liệu, chứa thông tin dịch vụ khác nhau. Trong trường hợp mạng **Ethernet** được xây dựng dựa trên các bộ chuyển mạch, mỗi bộ chuyển mạch sẽ chuyển tiếp các khung tuân thủ các nguyên tắc của chuyển mạch gói, như đã được mô tả trước đó. 

  Nhưng trong trường hợp mạng **Ethernet** một phân đoạn với môi trường chia sẻ, câu hỏi đặt ra là: việc chuyển mạch được thực hiện ở đâu? Có tồn tại một "bộ chuyển mạch" nào, là thành phần chính của bất kỳ mạng chuyển mạch gói nào? Hay liệu **Ethernet** duy trì một loại chuyển mạch đặc biệt? Thực tế, "bộ chuyển mạch" trong mạng **Ethernet** một phân đoạn không hiện diện như một thực thể cụ thể, bởi vì các chức năng của nó được phân tán khắp mạng giữa các **bộ điều hợp mạng (network adapters)** của máy tính và bản thân môi trường chia sẻ tín hiệu. 

  Các giao diện của bộ chuyển mạch "ảo" này là các bộ điều hợp mạng, và chức năng của khối chuyển mạch – truyền các khung giữa các giao diện – được thực hiện bởi môi trường chia sẻ. Các bộ điều hợp đảm nhận một phần các chức năng của khối chuyển mạch: chính chúng quyết định khung nào được gửi đến máy tính nào và khung nào thì không.

- **Định địa chỉ (Addressing):** Mỗi máy tính, hoặc chính xác hơn, mỗi bộ điều hợp mạng (network adapter), có một địa chỉ phần cứng duy nhất, được gọi là **địa chỉ MAC (MAC address)**, như đã đề cập trong Chương 2. Địa chỉ **Ethernet** là địa chỉ số phẳng. Các địa chỉ hỗ trợ cả truyền thông cá nhân (individual), quảng bá (broadcast), và nhóm (multicast).

- **Phân chia môi trường và đa kênh (Multiplexing):** Trong mạng **Ethernet** với bộ chuyển mạch, mỗi kênh là một kênh truyền song công (full-duplex channel), nhờ đó loại bỏ vấn đề chia sẻ môi trường giữa các giao diện của các nút. Bộ phát Ethernet của bộ chuyển mạch sử dụng các kênh truyền này để hỗ trợ các luồng khung đa kênh từ các nút khác nhau.

Trong trường hợp mạng **Ethernet** sử dụng môi trường chia sẻ, các nút cuối áp dụng một phương pháp truy cập đặc biệt nhằm đồng bộ hóa việc sử dụng kênh truyền bán song công (half-duplex channel) duy nhất, liên kết tất cả các máy tính trong mạng. Trong mạng **Ethernet** với môi trường chia sẻ, không có trọng tài duy nhất; thay vào đó, tất cả các nút sử dụng một phương pháp truy cập ngẫu nhiên phân tán (distributed random access method).

Các luồng thông tin từ các nút cuối của mạng **Ethernet** được **đa kênh hóa (multiplexed)** trên kênh truyền duy nhất trong chế độ phân chia thời gian (time-division). Điều này có nghĩa là các khung (frames) từ các luồng khác nhau được cấp quyền truy cập kênh theo thứ tự lần lượt. 

Để nhấn mạnh sự khác biệt không phải lúc nào cũng rõ ràng giữa các khái niệm **đa kênh hóa (multiplexing)** và **phân chia môi trường (media sharing)**, hãy xem xét một tình huống khi trong toàn bộ mạng **Ethernet**, chỉ một máy tính cần truyền dữ liệu, và dữ liệu này thuộc nhiều ứng dụng khác nhau. Trong trường hợp này, vấn đề phân chia môi trường giữa các giao diện mạng không xuất hiện, nhưng bài toán truyền nhiều luồng thông tin qua cùng một kênh truyền (tức là **đa kênh hóa**) vẫn tồn tại.

- **Mã hóa (Coding):** Các bộ điều hợp Ethernet hoạt động ở tần số xung nhịp 20 MHz, truyền vào môi trường các xung hình chữ nhật, tương ứng với các bit 1 và 0 từ dữ liệu của máy tính. Khi việc truyền khung (frame) bắt đầu, tất cả các bit được truyền vào mạng với tốc độ cố định là 10 Mbit/s (mỗi bit được truyền trong hai chu kỳ xung nhịp). Tốc độ này xác định băng thông (bandwidth) của kênh trong mạng Ethernet.

- **Độ tin cậy (Reliability):** Để cải thiện độ tin cậy của việc truyền dữ liệu trong Ethernet, một phương pháp tiêu chuẩn được sử dụng – tính **tổng kiểm tra (checksum)** và truyền nó ở cuối mỗi khung. Nếu bộ điều hợp nhận tính lại tổng kiểm tra và phát hiện lỗi trong dữ liệu của khung, khung đó sẽ bị loại bỏ. Việc truyền lại khung không được thực hiện ở cấp độ giao thức Ethernet – nhiệm vụ này phải được giải quyết bằng các phương tiện ở cấp độ giao thức cao hơn, chẳng hạn như **giao thức TCP (Transmission Control Protocol)** trong mạng TCP/IP.

- **Hàng đợi (Queues):** Trong các khoảng thời gian khi môi trường bị chiếm dụng bởi việc truyền khung từ các bộ điều hợp mạng khác, dữ liệu từ các ứng dụng (tải trọng đề xuất) vẫn tiếp tục đến bộ điều hợp mạng. Vì vậy, chúng không thể được truyền ngay lập tức, mà sẽ được lưu trữ trong bộ đệm nội bộ của bộ điều hợp Ethernet, tạo thành hàng đợi. Do đó, trong Ethernet, cũng như trong tất cả các mạng chuyển mạch gói, tồn tại các độ trễ biến đổi trong việc truyền khung.

---

<h3 id="chuong-4-chuan-hoa-va-phan-loai-mang">CHƯƠNG 4: Chuẩn hóa và phân loại mạng</h3>

#### 4.1 Phân rã nhiệm vụ của sự tương tác mạng

Kiến trúc mạng (network architecture) là một sơ đồ khái niệm về cách hoạt động của mạng máy tính (computer network), xác định các nguyên tắc làm việc của các thành phần phần cứng (hardware) và phần mềm mạng (network software), tổ chức các kết nối của chúng, các giao thức tương tác (interaction protocols), và cách thức truyền dữ liệu vật lý (physical data transmission).  

Kiến trúc mạng phản ánh sự phân rã của nhiệm vụ chung về tương tác giữa các máy tính (computers) thành các nhiệm vụ con (subtasks), những nhiệm vụ này được giải quyết bởi các thành phần riêng biệt của mạng — các nút cuối cùng (end nodes) (máy tính - computers) và các nút trung gian (intermediate nodes) (bộ chuyển mạch - switches và bộ định tuyến - routers).

---

##### 4.1.1 Cách tiếp cận nhiều cấp độ

Để giải quyết các nhiệm vụ phức tạp, bao gồm cả nhiệm vụ tương tác mạng (network interaction task), một phương pháp phổ biến và phổ quát được sử dụng là **phân rã (decomposition)**, tức là chia một nhiệm vụ phức tạp thành một số nhiệm vụ nhỏ hơn - các mô-đun nhiệm vụ (task-modules). Phân rã bao gồm việc xác định các chức năng của mỗi mô-đun (module functions), cũng như thứ tự tương tác của chúng (tức là các giao diện liên mô-đun - inter-module interfaces).  

Với cách tiếp cận này, mỗi mô-đun có thể được coi như một “hộp đen (black box)”, trừu tượng hóa khỏi các cơ chế bên trong của nó và tập trung vào cách các mô-đun tương tác. Kết quả của sự đơn giản hóa logic nhiệm vụ này là khả năng kiểm thử (testing), phát triển (development), và sửa đổi (modification) các mô-đun một cách độc lập. Chẳng hạn, bất kỳ mô-đun nào được chỉ ra trong Hình 4.1 có thể được viết lại.  

Hãy giả sử đó là mô-đun A, và nếu trong quá trình này các nhà phát triển giữ nguyên các giao diện liên mô-đun (trong trường hợp này – các giao diện A–B và A–C), thì điều này không yêu cầu bất kỳ thay đổi nào ở các mô-đun khác.

Một khái niệm hiệu quả hơn, phát triển từ ý tưởng phân rã, là **cách tiếp cận nhiều cấp độ (multi-level approach)**. Sau khi biểu diễn nhiệm vụ gốc dưới dạng tập hợp các mô-đun và nhóm chúng theo cấp độ, hình thành cấu trúc phân cấp. Theo nguyên tắc phân cấp, đối với mỗi cấp độ, có thể chỉ rõ cấp độ ngay trên và ngay dưới nó (Hình 4.2).  

Một mặt, theo cách tiếp cận này, mỗi nhiệm vụ cấp độ phải được mô tả bằng cách tham chiếu đến cấp độ ngay dưới nó. Mặt khác, các kết quả của việc phân rã, thuộc về một cấp độ nào đó, có thể được trình bày như là một thành phần của nhiệm vụ ở cấp độ trên. Sự phân cấp như vậy tạo điều kiện thuận lợi cho việc tổ chức phát triển và kiểm tra các giải pháp.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.1.png" alt="Hình 4.1. Ví dụ về phân tách nhiệm vụ" width="900">
</p>
<p align="center"><b>Hình 4.1. Ví dụ về phân tách nhiệm vụ</b></p>

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.2.png" alt="Hình 4.2. Phương pháp đa cấp — tạo dựng hệ thống phân cấp nhiệm vụ" width="900">
</p>
<p align="center"><b>Hình 4.2. Phương pháp đa cấp — tạo dựng hệ thống phân cấp nhiệm vụ</b></p>

**Giao diện giữa các cấp độ (inter-level interface)**, còn được gọi là **giao diện dịch vụ (service interface)**, xác định tập hợp các chức năng (functions) mà cấp dưới (lower level) cung cấp cho cấp trên (upper level) (Hình 4.3).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.3.png" alt="Hình 4.3. Khái niệm tương tác đa cấp" width="900">
</p>
<p align="center"><b>Hình 4.3. Khái niệm tương tác đa cấp</b></p>

**Cách tiếp cận này** cho phép thực hiện việc phát triển (development), kiểm thử (testing), và sửa đổi (modification) ở một cấp độ (level) riêng biệt mà không phụ thuộc vào các cấp độ khác.  

**Phân rã phân cấp (hierarchical decomposition)** cho phép, khi di chuyển từ cấp độ thấp hơn (lower level) đến cấp độ cao hơn (higher level), chuyển sang các mức độ ngày càng trừu tượng (abstract) hơn, do đó làm đơn giản hóa (simplify) việc trình bày nhiệm vụ gốc.

**Ví dụ**

Hãy xem xét nhiệm vụ đọc bản ghi logic từ một tệp được lưu trữ trên đĩa cục bộ. Nhiệm vụ này (rất đơn giản hóa) có thể được trình bày dưới dạng phân cấp của các nhiệm vụ nhỏ như sau:

1. **Tìm kiếm trong thư mục (catalog) theo tên ký hiệu của tệp và các đặc điểm của nó, cần thiết để truy cập dữ liệu (data):** thông tin về vị trí vật lý của tệp trên đĩa (disk), kích thước (size), v.v.

   Vì các chức năng của cấp độ này chỉ liên quan đến việc xem thư mục (directory), cách biểu diễn hệ thống tệp (file system) trên cấp độ này là cực kỳ trừu tượng: hệ thống tệp có cấu trúc dạng đồ thị (graph), trong đó các nút (nodes) là các thư mục và các lá (leaves) là các tệp. Các chi tiết về tổ chức vật lý và logic của dữ liệu trên đĩa không thuộc mối quan tâm của cấp độ này.

2. **Xác định phần cần đọc của tệp.**

   Để giải quyết nhiệm vụ này, cần giảm mức độ trừu tượng của hệ thống tệp. Các chức năng ở cấp độ này hoạt động với tệp như một tập hợp cụ thể của các khối vật lý liên kết với nhau (physical blocks).

3. **Đọc dữ liệu từ đĩa.**

   Sau khi xác định số của khối vật lý (physical block) tệp, hệ thống tệp liên hệ với hệ thống đầu vào/đầu ra (I/O system) để thực hiện các thao tác đọc. Ở cấp độ này, xuất hiện các chi tiết cụ thể của thiết bị hệ thống tệp, chẳng hạn như số xi lanh (cylinders), đường (tracks), và các sector.
   **Trong số các chức năng** mà một chương trình ứng dụng (application program) có thể yêu cầu khi gọi đến cấp cao nhất của hệ thống tệp (file system), có thể là, ví dụ:  

**ĐỌC 22 BẢN GHI LOGIC (logical records) TỪ TỆP DIR1/MY/FILE.TXT**  

Cấp độ trên cùng không thể tự thực hiện yêu cầu này "chỉ bằng khả năng của chính nó"; sau khi xác định địa chỉ vật lý (physical address) của tệp từ tên ký hiệu (symbolic name) DIR1/MY/FILE.TXT, nó sẽ chuyển yêu cầu đến cấp thấp hơn:  

**ĐỌC 22 BẢN GHI LOGIC TỪ TỆP CÓ ĐỊA CHỈ VẬT LÝ 174 VÀ KÍCH THƯỚC 235**  

  Khi nhận được yêu cầu, cấp độ thứ hai xác định rằng tệp có địa chỉ 174 chiếm trên đĩa năm vùng không liên tiếp, và bản ghi cần đọc nằm ở vùng thứ tư trong khối vật lý 345. Sau đó, nó gửi yêu cầu đến trình điều khiển (driver) để đọc bản ghi logic cần thiết.  

  Theo sơ đồ tương tác đơn giản hóa này, các cấp độ của hệ thống tệp là hướng một chiều — từ trên xuống (top-down). Tuy nhiên, thực tế phức tạp hơn đáng kể. Thật vậy, để xác định đặc điểm của tệp, cấp độ trên phải "giải nén" (unpack) tên ký hiệu của nó, tức là lần lượt đọc chuỗi thư mục được chỉ định trong tên tệp. Điều này có nghĩa là, thay vì chỉ chuyển yêu cầu đến cấp thấp hơn, cấp trên sẽ phải "yêu cầu" trình điều khiển đọc các dữ liệu cần thiết, và một số yêu cầu như vậy có thể xảy ra từ dưới lên (bottom-up).

**Nhiệm vụ tổ chức tương tác giữa các máy tính trong mạng** cũng có thể được trình bày dưới dạng tập hợp các mô-đun được tổ chức theo cấp bậc (hierarchically organized).  

Ví dụ, các mô-đun cấp thấp (lower-level modules) có thể đảm nhiệm các vấn đề liên quan đến việc truyền thông tin đáng tin cậy (reliable data transfer) giữa hai nút liền kề (adjacent nodes), trong khi các mô-đun của cấp tiếp theo, cao hơn (higher-level modules), đảm nhận việc vận chuyển thông điệp (message transport) trong toàn mạng.  

Rõ ràng, nhiệm vụ cuối cùng — tổ chức kết nối giữa hai nút bất kỳ, không nhất thiết phải liền kề — mang tính tổng quát hơn và do đó, có thể được giải quyết bằng cách thực hiện nhiều lần các yêu cầu tới cấp thấp hơn.  

Ví dụ, tổ chức tương tác giữa các nút A và B có thể được rút gọn thành việc lần lượt tổ chức tương tác giữa các cặp nút trung gian liền kề (Hình 4.4).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.4.png" alt="Hình 4.4. Tương tác của một cặp nút ngẫu nhiên" width="900">
</p>
<p align="center"><b>Hình 4.4. Tương tác của một cặp nút ngẫu nhiên</b></p>

---

##### 4.1.2 Giao thức và chồng giao thức

Cách biểu diễn nhiều cấp độ của các phương tiện tương tác mạng (network interaction) có một đặc điểm riêng, liên quan đến việc trong quá trình trao đổi thông điệp (message exchange), tham gia ít nhất hai phía (sides). Điều này đòi hỏi phải tổ chức công việc phối hợp của hai hệ thống cấp bậc (hierarchies) về phần cứng (hardware) và phần mềm (software) trên các máy tính khác nhau.

Cả hai phía tham gia trao đổi mạng đều phải chấp nhận một tập hợp các thỏa thuận (agreements). Ví dụ: họ cần thống nhất các tham số của tín hiệu điện (electrical signals), chiều dài thông điệp (message length), và các phương pháp kiểm tra tính chính xác (validity control), v.v. Nói cách khác, các thỏa thuận phải được thực hiện ở tất cả các cấp độ, bắt đầu từ cấp thấp nhất — cấp độ truyền bit (bit-level transmission) — và kết thúc ở cấp cao nhất, cung cấp dịch vụ cho người dùng mạng.

Hình 4.5 minh họa mô hình tương tác giữa hai nút. Ở mỗi phía, các phương tiện tương tác được trình bày qua bốn cấp độ. Mỗi cấp độ hỗ trợ giao diện (interfaces) của hai loại. Thứ nhất, đó là các giao diện dịch vụ (service interfaces) với cấp trên và cấp dưới trong hệ thống cấp bậc. Thứ hai, đó là giao diện ngang cấp (peer-to-peer interfaces) với các phương tiện tương tác của phía khác, nằm ở cùng một cấp độ trong hệ thống cấp bậc. Giao diện ngang cấp này được gọi là **giao thức (protocol)**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.5.png" alt="Hình 4.5. Tương tác giữa hai nút mạng" width="900">
</p>
<p align="center"><b>Hình 4.5. Tương tác giữa hai nút mạng</b></p>

**Thực chất, các thuật ngữ "protocol" (giao thức) và "interface" (giao diện) đều chỉ cùng một khái niệm – mô tả chính thức về thủ tục tương tác giữa hai đối tượng, nhưng trong lĩnh vực mạng, chúng được sử dụng trong các bối cảnh ưu tiên khác nhau: giao thức (protocol) quy định các quy tắc tương tác của các module cùng cấp (cùng hạng) ở các nút khác nhau, trong khi giao diện (interface) quy định các quy tắc tương tác của các module ở các cấp độ liền kề trong cùng một nút.**

**Tập hợp các giao thức (protocols) được tổ chức theo thứ bậc, đủ để tổ chức sự tương tác giữa các nút trong mạng, được gọi là chồng giao thức (protocol stack).**

Các giao thức (protocols) ở tầng thấp thường được hiện thực bằng sự kết hợp giữa phần mềm và phần cứng, trong khi các giao thức ở tầng cao, thông thường, được hiện thực bằng các phương tiện phần mềm. Module phần mềm hiện thực một giao thức cụ thể được gọi là thực thể giao thức (protocol entity), hoặc để ngắn gọn, cũng được gọi là giao thức (protocol). Rõ ràng, một giao thức cụ thể có thể được hiện thực với các mức độ hiệu quả khác nhau. Chính vì vậy, khi so sánh các giao thức, cần xem xét không chỉ logic hoạt động của chúng, mà còn cả chất lượng hiện thực phần mềm (quality of software implementation).

Hơn nữa, hiệu quả tương tác của các thiết bị trong mạng phụ thuộc vào chất lượng của toàn bộ tập hợp giao thức cấu thành chồng giao thức (protocol stack) – cụ thể là mức độ hợp lý khi phân bổ chức năng giữa các giao thức ở các tầng khác nhau (rational distribution of functions across layers) và mức độ rõ ràng trong định nghĩa các giao diện (interfaces) giữa chúng.**

Thực thể giao thức (protocol entity) ở một tầng nhất định trao đổi các thông điệp theo định dạng được xác định bởi giao thức tầng đó. Các thông điệp bao gồm phần tiêu đề (header) và phần dữ liệu (data field) (đôi khi có thể không có). Việc trao đổi thông điệp là một loại ngôn ngữ giao tiếp riêng, qua đó mỗi bên hiểu các chỉ thị từ phía bên kia để thực hiện các bước tương tác cần thiết. Công việc của mỗi module giao thức (protocol module) là diễn giải các tiêu đề của thông điệp đến và thực hiện các hành động liên quan.

Tiêu đề của các thông điệp thuộc các giao thức khác nhau có cấu trúc khác nhau, tương ứng với đặc thù của từng chức năng. Rõ ràng, cấu trúc tiêu đề càng phức tạp thì chức năng được giao cho giao thức tương ứng càng lớn.

Dưới đây là bản dịch đầy đủ và đúng chuyên ngành của nội dung từ hình ảnh:

---

#### 4.2 Mô hình OSI

Việc một giao thức (protocol) là một thỏa thuận được chấp nhận bởi hai nút mạng tương tác không có nghĩa rằng nó nhất thiết phải là một tiêu chuẩn (standard). Tuy nhiên, trên thực tế, khi triển khai mạng, người ta thường cố gắng sử dụng các giao thức tiêu chuẩn (standard protocols). Đây có thể là các tiêu chuẩn của công ty, quốc gia hoặc quốc tế.

Vào đầu những năm 1980, một số tổ chức quốc tế về tiêu chuẩn hóa, đặc biệt là Tổ chức Tiêu chuẩn hóa Quốc tế (International Standards Organization - ISO) và Liên minh Viễn thông Quốc tế (International Telecommunications Union - ITU), cùng với các tổ chức khác, đã phát triển một mô hình tiêu chuẩn để liên kết các hệ thống mở (Open System Interconnection - OSI). Mô hình này đóng một vai trò quan trọng trong sự phát triển của các mạng máy tính.

---

#####  4.2.1 Đặc điểm chung của mô hình OSI

Đến cuối những năm 1970, trên thế giới đã tồn tại một số lượng lớn các chồng giao thức (protocol stacks) độc quyền, chẳng hạn như DECnet, TCP/IP và IBM SNA. Sự đa dạng này đã dẫn đến vấn đề không tương thích (incompatibility) giữa các thiết bị sử dụng các giao thức khác nhau.

Một trong những cách giải quyết vấn đề này là tạo ra một chuyển đổi đồng nhất và phổ quát của tất cả các chồng giao thức (protocol stacks), vốn không được đáp ứng đầy đủ bởi các chồng giao thức hiện có. Cách tiếp cận học thuật này dẫn đến việc phát triển mô hình OSI, kéo dài từ năm 1977 đến năm 1984. Nhiệm vụ chính của mô hình OSI là cung cấp một biểu diễn tổng quát về các chức năng của các phương tiện tương tác (means of interaction), để nó có thể đóng vai trò như một hướng dẫn mang tính phổ quát cho các chuyên gia mạng trên toàn cầu.


> **Mô hình OSI** liên quan đến chồng giao thức (protocol stack) cho các mạng chuyển mạch gói (packet-switched networks). Mô hình OSI không chứa các mô tả về cách hiện thực (implementation) một tập hợp giao thức cụ thể. Nó chỉ xác định, thứ nhất, các tầng tương tác (interaction layers), thứ hai, tên gọi tiêu chuẩn của các tầng (standard layer names), và thứ ba, các chức năng (functions) mà mỗi tầng cần thực hiện.


Trong mô hình OSI, các phương tiện tương tác được chia thành bảy tầng:

- **Тầng ứng dụng** (application layer);
- **Тầng trình bày** (presentation layer);
- **Тầng phiên** (session layer);
- **Тầng vận chuyển** (transport layer);
- **Тầng mạng** (network layer);
- **Тầng liên kết dữ liệu** (data link layer);
- **Тầng vật lý** (physical layer).

Chính vì vậy, mô hình OSI còn được gọi là **mô hình bảy tầng (seven-layer model)**. Mỗi tầng liên quan đến một khía cạnh nhất định của tương tác giữa các thiết bị mạng.

Cần nhấn mạnh rằng mô hình OSI chỉ mô tả các phương tiện hệ thống để tương tác (system interaction means), bao gồm hệ điều hành (operating system), tiện ích hệ thống (system utilities), và phương tiện phần cứng (hardware means). Mô hình không bao gồm các phương tiện tương tác của ứng dụng dành cho người dùng cuối. Do đó, cần phân biệt rõ tầng ứng dụng và tầng ứng dụng trong mô hình bảy tầng.

Các ứng dụng có thể thực hiện các giao thức tương tác riêng, sử dụng tập hợp nhiều tầng của các phương tiện hệ thống. Chính vì lý do này, các lập trình viên được cung cấp **giao diện lập trình ứng dụng (Application Program Interface, API)**. Theo mô hình OSI, ứng dụng chỉ có thể gửi yêu cầu tới tầng cao nhất – tầng ứng dụng, nhưng trên thực tế, các chồng giao thức truyền thông (communication protocol stacks) cho phép lập trình viên tương tác trực tiếp với các dịch vụ và chức năng của các tầng thấp hơn.

Ví dụ, một số hệ quản trị cơ sở dữ liệu (Database Management Systems - DBMS) có các công cụ tích hợp để truy cập từ xa đến tệp. Khi sử dụng các công cụ này, ứng dụng hoạt động với tài nguyên từ xa mà không sử dụng dịch vụ hệ thống tệp; nó bỏ qua các tầng cao hơn của mô hình OSI và tương tác trực tiếp với phương tiện hệ thống để vận chuyển thông điệp qua mạng, nằm ở các tầng thấp hơn của mô hình OSI.

Trong các tiêu chuẩn ISO, để biểu thị đơn vị dữ liệu được trao đổi (data exchange unit) mà các giao thức của các tầng làm việc với, thuật ngữ **đơn vị dữ liệu giao thức (Protocol Data Unit, PDU)** được sử dụng. Để biểu thị đơn vị dữ liệu của các tầng cụ thể, thường sử dụng các thuật ngữ đặc thù, như **thông điệp (message), khung (frame), gói tin (packet), datagram, đoạn (segment)**.

Để minh họa cấu trúc logic của mô hình OSI, hãy xem xét tương tác giữa hai ứng dụng, **A** và **B**, được chạy trên hai máy tính, lần lượt là **1** và **2** (hình 4.6). Giả sử, ứng dụng **A** thu thập dữ liệu, dựa trên đó ứng dụng **B** tạo ra một báo cáo. Việc phối hợp hoạt động của hai ứng dụng này được đảm bảo thông qua việc trao đổi các thông điệp theo một giao thức (protocol) được các lập trình viên ứng dụng thiết kế riêng cho chúng. Các thông điệp giao thức phản ánh logic hoạt động của ứng dụng, và chúng có thể có nhiều dạng khác nhau, ví dụ: "Dữ liệu cho báo cáo N đã sẵn sàng", "Không khớp kiểu dữ liệu", v.v.

Các nhà phát triển của ứng dụng **A** và **B** quyết định rằng các thông điệp giao thức sẽ được truyền qua mạng dưới dạng tệp. Ví dụ, ứng dụng **A** gửi một thông điệp "Dữ liệu cho báo cáo N đã sẵn sàng" tới ứng dụng **B**. Để thực hiện điều này, ứng dụng sử dụng giao diện API và thực hiện một yêu cầu đến các phương tiện hệ thống ở **tầng ứng dụng (application layer)** của mô hình OSI (trong trường hợp này, là hệ thống tệp mạng) để yêu cầu chuyển tệp chứa thông điệp này đến máy tính từ xa **2**.

Trong quá trình xử lý yêu cầu từ ứng dụng **A**, client và máy chủ của hệ thống tệp mạng sẽ trao đổi chuỗi lệnh riêng của chúng – các thông điệp giao thức (protocol messages). Trong trường dữ liệu (data field) của một trong các lệnh đó, máy khách của hệ thống tệp mạng đóng gói thông điệp từ ứng dụng **A** vào phần dữ liệu, còn trong tiêu đề (header) (trong hình 4.6, tiêu đề thuộc tầng ứng dụng – tầng thứ 7) là thông tin dịch vụ dành cho máy chủ hệ thống tệp. Để thông điệp của tầng ứng dụng được gửi đến đích, cần phải giải quyết thêm nhiều nhiệm vụ khác mà trách nhiệm thuộc về các tầng thấp hơn trong mô hình tương tác mạng.

Tầng tiếp theo là **tầng trình bày (presentation layer)**. Module giao thức ở tầng ứng dụng, thông qua giao diện liên tầng, chuyển thông điệp của mình xuống tầng này, đồng thời yêu cầu thực hiện các dịch vụ cụ thể do tầng này cung cấp. Các phương tiện ở tầng trình bày thực hiện các nhiệm vụ cần thiết (ví dụ, mã hóa hoặc chuyển đổi định dạng dữ liệu) và hình thành thông điệp của mình bằng cách thêm vào thông điệp đã nhận các thông tin dịch vụ riêng (trong hình 4.6, tiêu đề của tầng trình bày – tầng 6).

Thông điệp được hình thành tại tầng trình bày sẽ được chuyển xuống theo chồng giao thức tới các phương tiện của **tầng phiên (session layer)**, tầng này, sau khi thực hiện các chức năng được định nghĩa cho nó, sẽ chuyển thông điệp của mình xuống các tầng **vận chuyển (transport layer)**, **mạng (network layer)** và sau đó là **liên kết dữ liệu (data link layer)**.

Cuối cùng, thông điệp đến các phương tiện ở tầng thấp nhất, **tầng vật lý (physical layer)**, nơi chúng sẽ chuyển thông điệp qua giao diện vật lý đầu ra của máy tính **1** và bắt đầu "hành trình" trên mạng. (Cho đến thời điểm này, thông điệp chỉ được truyền từ tầng này sang tầng khác trong phạm vi máy tính **1**).


Khi một thông điệp được truyền qua mạng và đến giao diện đầu vào của máy tính **2**, tầng vật lý (physical layer) tiếp nhận nó, sau đó thông điệp sẽ được chuyển tuần tự từ tầng này lên tầng khác. Các phương tiện ở mỗi tầng sẽ phân tích và xử lý tiêu đề của tầng mình, thực hiện các chức năng tương ứng, sau đó loại bỏ tiêu đề đó và chuyển thông điệp lên tầng cao hơn, cho đến khi nó được chuyển đến ứng dụng **B**. Ứng dụng **B** sẽ diễn giải thông điệp "Dữ liệu cho báo cáo N đã sẵn sàng", ví dụ, và chuẩn bị bộ đệm để tiếp nhận dữ liệu.

> Như có thể thấy từ mô tả, các thực thể giao thức (protocol entities) của một tầng không trực tiếp giao tiếp với nhau; quá trình giao tiếp luôn có sự tham gia của các tầng giao thức liền kề (adjacent layers). Chỉ các tầng vật lý (physical layers) của các nút khác nhau là tương tác trực tiếp với nhau.

Các giao thức của bốn tầng thấp hơn thường được gọi chung là **vận tải mạng (network transport)** hoặc **hệ thống con vận tải (transport subsystem)**, vì chúng hoàn toàn giải quyết nhiệm vụ vận chuyển thông điệp với một mức chất lượng được xác định trong các mạng phức hợp với topologies tùy ý và các công nghệ khác nhau.

Ba tầng trên cùng còn lại được thống nhất bởi việc chúng trực tiếp liên quan đến các **ứng dụng người dùng (user applications)**, cung cấp cho chúng các dịch vụ cấp cao để sử dụng tài nguyên và dịch vụ mạng. Tiếp theo, chúng ta sẽ xem xét các chức năng của tất cả bảy tầng, bắt đầu từ tầng thấp nhất, **tầng vật lý (physical layer)**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.6.png" alt="Hình 4.6. Mô hình tương tác của các hệ thống mở ISO/OSI" width="900">
</p>
<p align="center"><b>Hình 4.6. Mô hình tương tác của các hệ thống mở ISO/OSI</b></p>

---

##### 4.2.2 Tầng vật lý (Physical Layer)

**Tầng vật lý** của mô hình OSI liên quan đến việc truyền dòng bit qua các kênh truyền vật lý, chẳng hạn như cáp đồng trục (coaxial cable), cáp xoắn đôi (twisted pair), cáp quang (fiber optic cable), hoặc các đường truyền không dây (wireless communication line).


**Chức năng của tầng vật lý** được thực hiện trên tất cả các thiết bị kết nối với mạng. Từ phía máy tính, các chức năng này được thực hiện bởi bộ điều hợp mạng (network adapter), và từ phía các thiết bị mạng trung gian – bộ chuyển mạch (switch), bộ định tuyến (router), bộ ghép kênh (multiplexer), v.v., thông qua các giao diện đầu vào và đầu ra (input/output interfaces hoặc ports). 

Tầng vật lý không quan tâm đến ý nghĩa của thông tin được truyền. Đối với tầng này, dữ liệu đến từ tầng liên kết (data link layer) được coi là một dòng bit đồng nhất cần được truyền đi mà không bị méo mó, phù hợp với tần số đồng bộ hóa (clock rate) được thiết lập (khoảng cách giữa các bit liền kề) và phương pháp mã hóa được lựa chọn.

Ví dụ về một tiêu chuẩn thuộc tầng vật lý có thể là **Gigabit Ethernet**, quy định việc sử dụng cáp xoắn đôi không che chắn loại 5 (Category 5 UTP) với trở kháng sóng là 100 Ohm, đầu nối kiểu RJ-45, chiều dài tối đa của phân đoạn vật lý không quá 100m, mã Manchester để biểu diễn dữ liệu trong cáp, cũng như một số đặc điểm khác của môi trường và tín hiệu điện.

---

##### 4.2.3 Tầng liên kết dữ liệu (Data Link Layer)

**Tầng liên kết dữ liệu**, sử dụng các khả năng được cung cấp bởi tầng thấp hơn – tầng vật lý (physical layer), cung cấp các dịch vụ sau cho tầng trên – tầng mạng (network layer):  

- Thiết lập kết nối logic giữa các nút tương tác;  
- Đồng bộ hóa tốc độ giữa bộ truyền và bộ nhận thông tin trong khuôn khổ kết nối;  
- Đảm bảo truyền tải đáng tin cậy, phát hiện và sửa lỗi.

Trong các mạng dựa trên môi trường truyền chia sẻ, tầng vật lý còn thực hiện thêm một chức năng – kiểm tra tính khả dụng của môi trường chia sẻ. Chức năng này đôi khi được tách thành một phân tầng con gọi là **quản lý truy cập môi trường (Medium Access Control, MAC)**.

Giao thức tầng liên kết thường hoạt động trong giới hạn của một mạng cụ thể, là một phần của mạng lớn hơn được kết nối bởi các giao thức tầng mạng (network layer). Địa chỉ mà giao thức tầng liên kết hoạt động được sử dụng để chuyển các khung (frames) chỉ trong phạm vi của mạng đó, và để di chuyển gói tin (packets) giữa các mạng thì địa chỉ của tầng mạng được sử dụng.

Các giao thức của tầng liên kết được hiện thực ở cả các nút cuối (bộ điều hợp mạng và trình điều khiển của chúng), cũng như trên tất cả các thiết bị mạng trung gian (bộ chuyển mạch, bộ định tuyến, v.v.).

**Đơn vị dữ liệu giao thức** ở tầng liên kết là **khung (frame)**. Trong trường dữ liệu của khung, thông điệp từ tầng mạng được đặt, còn trong tiêu đề là thông tin dịch vụ, bao gồm **địa chỉ đích (destination address)**, dựa trên đó các bộ chuyển mạch sẽ chuyển tiếp gói tin.

Một trong những nhiệm vụ của tầng liên kết là **phát hiện và sửa lỗi (error detection and correction)**. Tầng liên kết có thể đảm bảo độ tin cậy của truyền tải, ví dụ, bằng cách cố định ranh giới của khung, thêm một dãy bit đặc biệt vào đầu và cuối khung, và sau đó thêm vào khung một giá trị kiểm tra (checksum). Kiểm tra được tính toán theo một thuật toán nào đó như một hàm của tất cả các byte của khung. Ở phía nhận, tầng liên kết nhóm các bit nhận được từ tầng vật lý vào các khung, tính lại giá trị kiểm tra dựa trên các bit nhận được và so sánh với giá trị kiểm tra trong khung. Nếu chúng trùng khớp, khung được coi là hợp lệ. Nếu không trùng, lỗi được phát hiện.

Chức năng của tầng liên kết dữ liệu (data link layer) không chỉ bao gồm việc phát hiện lỗi (error detection) mà còn cả sửa lỗi (error correction) thông qua việc truyền lại các khung bị lỗi trong phạm vi kết nối logic. Tuy nhiên, chức năng này không phải là bắt buộc, và trong một số hiện thực của tầng liên kết, nó không được sử dụng – chẳng hạn, trong Ethernet.

Trước khi chuyển một khung tới tầng vật lý để truyền trực tiếp dữ liệu vào mạng, phân tầng MAC (Medium Access Control) của tầng liên kết phải kiểm tra tính khả dụng của môi trường (media availability). Nếu môi trường chia sẻ (shared medium) sẵn sàng (khi không có ai sử dụng nó, kiểm tra này sẽ thành công), khung sẽ được gửi qua các phương tiện vật lý vào mạng.

Trong các mạng cục bộ (local area networks, LANs), tầng liên kết hỗ trợ một tập hợp chức năng mạnh mẽ và hoàn thiện để chuyển tiếp thông điệp giữa các nút trong mạng. Trong một số trường hợp, các giao thức tầng liên kết của mạng cục bộ hoạt động như các phương tiện truyền tải độc lập (self-contained transport mechanisms) và có thể cho phép ứng dụng hoặc giao thức tầng ứng dụng (application layer) hoạt động trực tiếp trên chúng mà không cần sử dụng các phương tiện của tầng mạng (network layer) hoặc tầng vận chuyển (transport layer). Tuy nhiên, để đảm bảo truyền tải chất lượng cao trong các mạng có cấu trúc topo tùy ý, các chức năng của tầng liên kết thường là chưa đủ.

---

##### 4.2.4 Tầng mạng (Network Layer)

**Tầng mạng** được sử dụng để tạo ra một hệ thống truyền tải thống nhất, kết nối nhiều mạng lại với nhau, được gọi là **mạng hợp thành (composite network)** hoặc **internet**.

> **Công nghệ cho phép kết nối nhiều mạng thành một mạng thống nhất, dựa trên các công nghệ khác nhau, được gọi là công nghệ tương tác mạng (internetworking).**

Trong hình 4.7, một số mạng được minh họa, mỗi mạng trong số đó sử dụng công nghệ logic tầng liên kết riêng, như: Ethernet, FDDI, Token Ring, ATM, hoặc Frame Relay. Dựa trên những công nghệ này, bất kỳ người dùng nào trong mạng có thể kết nối với nhau, nhưng chỉ trong giới hạn **mạng của họ**, và không thể truyền dữ liệu ra ngoài mạng đó.

Nguyên nhân của hạn chế này là sự khác biệt đáng kể giữa các công nghệ của một mạng và mạng khác. Thậm chí các công nghệ mạng LAN gần gũi nhất – như Ethernet, FDDI, hoặc Token Ring – dù có hệ thống địa chỉ (MAC address) giống nhau, nhưng vẫn khác biệt nhau về định dạng khung (frame format) và logic hoạt động của giao thức tầng liên kết. Còn nhiều khác biệt hơn nữa giữa các công nghệ mạng LAN và mạng WAN.

Để kết nối các mạng với nhau, cần sử dụng các công nghệ bổ sung được hiện thực ở **tầng mạng (network layer)**.

**Các chức năng của tầng mạng (Network Layer)** được thực hiện bởi:  
- **Nhóm các giao thức (group of protocols);**  
- **Các thiết bị chuyên dụng – bộ định tuyến (routers).**

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.7.png" alt="Hình 4.7. Minh họa về sự cần thiết của tầng mạng" width="900">
</p>
<p align="center"><b>Hình 4.7. Minh họa về sự cần thiết của tầng mạng</b></p>

Một trong các chức năng của bộ định tuyến (router) là **kết nối vật lý giữa các mạng (physical connection of networks)**. Bộ định tuyến có nhiều giao diện mạng (network interfaces), tương tự như các giao diện của máy tính, và mỗi giao diện có thể được kết nối với một mạng. Như vậy, các giao diện của bộ định tuyến có thể được coi là các nút của các mạng khác nhau.

Bộ định tuyến có thể được thực hiện dưới dạng phần mềm trên cơ sở một máy tính đa năng (universal computer) (ví dụ, cấu hình điển hình của Unix hoặc Windows bao gồm một module phần mềm của bộ định tuyến). Tuy nhiên, thường bộ định tuyến được triển khai dựa trên các nền tảng phần cứng chuyên dụng. Các chức năng phần mềm của bộ định tuyến bao gồm các module giao thức của tầng mạng (network layer protocols).

Vì vậy, để kết nối các mạng được hiển thị trong hình 4.7, cần phải kết nối tất cả các mạng qua các bộ định tuyến và cài đặt các module giao thức của tầng mạng trên các nút cuối của người dùng muốn kết nối với mạng hợp thành (composite network) (hình 4.8).

Dữ liệu cần được truyền qua mạng hợp thành sẽ được gửi tới tầng mạng (network layer) từ tầng vận chuyển (transport layer) phía trên. Các dữ liệu này được bổ sung bởi một tiêu đề của tầng mạng. Dữ liệu cùng với tiêu đề tạo thành **gói tin (packet)** – đây là đơn vị dữ liệu giao thức của tầng mạng.

Tiêu đề của gói tin tầng mạng (network layer packet) cùng với các thông tin dịch vụ khác mang dữ liệu về **địa chỉ đích (destination address)** của gói tin. Để các giao thức tầng mạng có thể chuyển gói tin đến bất kỳ nút nào trong mạng hợp thành (composite network), các nút này phải có các địa chỉ **duy nhất trong phạm vi toàn bộ mạng hợp thành**. Các địa chỉ này được gọi là **địa chỉ mạng (network addresses)** hoặc **địa chỉ toàn cầu (global addresses)**.

Mỗi nút trong mạng hợp thành, nếu muốn trao đổi dữ liệu với các nút khác trong mạng hợp thành, bên cạnh địa chỉ được chỉ định cho nó ở tầng liên kết (data link layer), cũng phải có một địa chỉ mạng. Ví dụ, trong hình 4.8, một máy tính trong mạng Ethernet thuộc mạng hợp thành có địa chỉ tầng liên kết MAC1 và địa chỉ tầng mạng NET-A1; tương tự, trong mạng ATM, một nút được định địa chỉ bằng các nhận diện kênh ảo ID1 và ID2, có địa chỉ mạng là NET-A2.

Trong gói tin, địa chỉ đích phải được chỉ định là **địa chỉ tầng mạng**, trên cơ sở đó tuyến đường của gói tin sẽ được xác định.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.8.png" alt="Hình 4.8. Ví dụ về mạng hợp thành" width="900">
</p>
<p align="center"><b>Hình 4.8. Ví dụ về mạng hợp thành</b></p>

**Xác định tuyến đường (routing)** là một nhiệm vụ quan trọng của tầng mạng (network layer). Tuyến đường được mô tả bởi chuỗi các mạng (hoặc bộ định tuyến), qua đó gói tin phải đi qua để đến đích. Ví dụ, trong hình 4.8, các đường gạch nối biểu thị ba tuyến đường mà dữ liệu có thể được truyền từ máy tính A đến máy tính B. Bộ định tuyến thu thập thông tin về cấu trúc liên kết (topology) của các kết nối giữa các mạng và trên cơ sở thông tin này xây dựng các bảng định tuyến (routing tables), trong trường hợp này được gọi cụ thể là **bảng định tuyến (routing tables)**.

Theo cách tiếp cận nhiều tầng, tầng mạng khi giải quyết nhiệm vụ của mình sẽ chuyển tiếp yêu cầu xuống tầng liên kết dữ liệu (data link layer). Toàn bộ hành trình qua mạng hợp thành được chia thành các đoạn từ một bộ định tuyến đến một bộ định tuyến khác, trong đó mỗi đoạn tương ứng với tuyến đường qua một mạng riêng lẻ.

Để truyền gói tin qua mạng tiếp theo, tầng mạng đặt gói tin vào trường dữ liệu của một khung (frame) thuộc công nghệ tầng liên kết tương ứng. Trong tiêu đề của khung, **địa chỉ tầng liên kết (data link address)** của giao diện bộ định tuyến tiếp theo được chỉ định. Mạng, sử dụng công nghệ tầng liên kết của mình, chuyển tiếp khung chứa gói tin được đóng gói (encapsulated) đến địa chỉ đã định. Bộ định tuyến giải nén gói tin từ khung đã nhận và sau khi xử lý cần thiết, tiếp tục truyền gói tin đến mạng tiếp theo, trước đó đã đóng gói nó vào một khung tầng liên kết mới, thường thuộc công nghệ khác.

Như vậy, tầng mạng đóng vai trò như một **người điều phối (coordinator)**, tổ chức sự hợp tác giữa các mạng được xây dựng trên các công nghệ khác nhau.

###### **Ví dụ - Sự tương đồng**

Có thể tìm thấy sự tương đồng giữa chức năng của tầng mạng (network layer) và dịch vụ bưu chính quốc tế, chẳng hạn như DHL hoặc TNT (hình 4.9). Hãy tưởng tượng rằng cần vận chuyển một kiện hàng từ thành phố Abra đến thành phố Kadabra, và hai thành phố này nằm trên các lục địa khác nhau. Để vận chuyển kiện hàng, dịch vụ bưu chính quốc tế sử dụng các phương tiện vận chuyển khu vực khác nhau:

- Đường sắt;  
- Vận tải đường biển;  
- Vận tải hàng không;  
- Vận tải đường bộ.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.9.png" alt="Hình 4.9. Hoạt động của dịch vụ bưu chính quốc tế" width="900">
</p>
<p align="center"><b>Hình 4.9. Hoạt động của dịch vụ bưu chính quốc tế</b></p>

Những nhà vận chuyển này có thể được xem như là tương đồng với các mạng thuộc tầng liên kết dữ liệu (data link layer), mỗi "mạng" ở đây được xây dựng dựa trên công nghệ riêng của nó. Từ các dịch vụ vận chuyển khu vực này, dịch vụ bưu chính quốc tế cần tổ chức một mạng hoạt động trơn tru và thống nhất.

Để làm được điều này, dịch vụ bưu chính quốc tế cần, trước tiên, lên kế hoạch tuyến đường vận chuyển thư tín; thứ hai, phối hợp hoạt động tại các điểm chuyển đổi nhà vận chuyển (ví dụ, dỡ thư từ toa tàu và đặt chúng vào khoang vận tải của máy bay). Mỗi nhà vận chuyển chỉ chịu trách nhiệm vận chuyển thư tín trên phần đường của mình và không chịu bất kỳ trách nhiệm nào về tình trạng của thư tín ngoài phạm vi phần đường của họ.

Trong trường hợp tổng quát, các chức năng của tầng mạng (network layer) không chỉ dừng lại ở việc đảm bảo trao đổi dữ liệu trong phạm vi mạng hợp thành (composite network). Tầng mạng còn thực hiện nhiệm vụ tạo ra các rào cản tin cậy và linh hoạt để ngăn chặn luồng dữ liệu không mong muốn giữa các mạng.

Kết luận, hãy lưu ý rằng ở tầng mạng có hai loại giao thức được xác định. Loại đầu tiên là **giao thức định tuyến (routed protocols)** – thực hiện việc chuyển tiếp các gói tin qua mạng. Đây chính là các giao thức thường được nhắc đến khi nói về các giao thức của tầng mạng. 

Tuy nhiên, thường ở tầng mạng cũng có một loại giao thức khác, được gọi là **giao thức định tuyến (routing protocols)** hoặc **giao thức định tuyến mạng (network routing protocols)**. Với sự trợ giúp của các giao thức này, các bộ định tuyến thu thập thông tin về cấu trúc liên kết của các kết nối mạng, trên cơ sở đó lựa chọn tuyến đường di chuyển cho các gói tin.

---

##### 4.2.5 Tầng vận chuyển (Transport Layer)

Trên đường truyền từ người gửi đến người nhận, các gói tin có thể bị méo mó hoặc mất mát. Mặc dù một số ứng dụng có các phương tiện riêng để xử lý lỗi, nhưng cũng có những ứng dụng khác ưu tiên việc sử dụng kết nối tin cậy.

**Tầng vận chuyển** đảm bảo cho các ứng dụng và các tầng trên cùng của chồng giao thức – tầng ứng dụng, trình bày và phiên – việc truyền dữ liệu với mức độ tin cậy mà chúng yêu cầu. Mô hình OSI xác định năm **lớp dịch vụ vận chuyển (transport service classes)** từ lớp 0 đến lớp 4. Các lớp dịch vụ này khác nhau về chất lượng dịch vụ được cung cấp: độ khẩn cấp, khả năng khôi phục kết nối bị gián đoạn, khả năng ghép kênh (multiplexing) nhiều kết nối giữa các giao thức ứng dụng qua cùng một phương tiện vận chuyển, và quan trọng nhất – khả năng phát hiện và sửa lỗi truyền tải như méo mó, mất hoặc trùng lặp gói tin.

**Việc lựa chọn lớp dịch vụ của tầng vận chuyển** phụ thuộc, một mặt, vào mức độ mà nhiệm vụ đảm bảo độ tin cậy được giải quyết bởi chính ứng dụng và các giao thức ở tầng cao hơn (tầng vận chuyển và trên). Mặt khác, sự lựa chọn cũng phụ thuộc vào mức độ tin cậy của hệ thống truyền tải dữ liệu trong mạng, được đảm bảo bởi các tầng thấp hơn – mạng, liên kết dữ liệu và vật lý. Ví dụ, nếu chất lượng của các kênh truyền tải rất cao và xác suất xảy ra lỗi được các giao thức ở các tầng thấp hơn phát hiện là nhỏ, thì có thể sử dụng một trong các dịch vụ nhẹ của tầng vận chuyển, không yêu cầu các kiểm tra phức tạp hoặc các biện pháp khác để đảm bảo độ tin cậy. Tuy nhiên, nếu các phương tiện truyền tải ở tầng thấp hơn không đáng tin cậy, thì việc sử dụng dịch vụ tầng vận chuyển tiên tiến hơn là hợp lý, bao gồm các cơ chế phát hiện và sửa lỗi, như thiết lập kết nối logic, kiểm soát giao hàng, kiểm tra lỗi, đánh số tuần tự cho các gói tin, đặt thời gian chờ giao hàng (timeouts), v.v.

Tất cả các giao thức, bắt đầu từ tầng vận chuyển trở lên, được thực hiện bằng **các phương tiện phần mềm của các nút mạng cuối (end systems)** – các thành phần của hệ thống mạng. Ví dụ về các giao thức vận chuyển bao gồm **TCP và UDP** của chồng giao thức TCP/IP, và giao thức **SPX** của chồng giao thức Novell.

---

##### 4.2.6 Tầng phiên (Session Layer)

**Tầng phiên** quản lý sự tương tác giữa các bên: xác định bên nào đang hoạt động tại một thời điểm và cung cấp các phương tiện để đồng bộ hóa phiên. Các phương tiện này cho phép lưu trữ thông tin về trạng thái của phiên truyền trong các lần truyền dài hạn, dưới dạng các điểm kiểm soát (checkpoints). Nhờ đó, trong trường hợp xảy ra lỗi, có thể quay lại điểm kiểm soát cuối cùng thay vì bắt đầu lại từ đầu.

Trong thực tế, ít ứng dụng sử dụng tầng phiên, và tầng này hiếm khi được triển khai dưới dạng các giao thức riêng biệt. Các chức năng của tầng này thường được kết hợp với các chức năng của tầng ứng dụng (application layer) và được hiện thực trong cùng một giao thức.

---

##### 4.2.7 Tầng trình bày (Presentation Layer)

**Tầng trình bày**, như tên gọi của nó, đảm bảo việc trình bày thông tin được truyền qua mạng, mà không thay đổi nội dung của thông tin đó. Nhờ tầng trình bày, thông tin do tầng ứng dụng của một hệ thống truyền đi luôn được hiểu bởi tầng ứng dụng của hệ thống khác.

Với sự trợ giúp của tầng này, các giao thức tầng ứng dụng có thể vượt qua sự khác biệt về cú pháp trong cách trình bày dữ liệu hoặc sự khác biệt trong mã ký tự, chẳng hạn như giữa mã ASCII và EBCDIC. Ở tầng này, có thể thực hiện việc mã hóa và giải mã dữ liệu, nhờ đó đảm bảo tính bảo mật của việc trao đổi dữ liệu ngay lập tức cho tất cả các dịch vụ tầng ứng dụng. Một ví dụ về giao thức như vậy là **SSL (Secure Socket Layer)**, giao thức này đảm bảo việc trao đổi thông tin bảo mật cho các giao thức của tầng ứng dụng trong chồng TCP/IP.

Để tăng hiệu quả của việc trao đổi văn bản và hình ảnh đồ họa, tầng trình bày có thể cung cấp các dịch vụ nén/giải nén thông tin. 

Các chức năng của tầng trình bày còn bao gồm việc mã hóa dữ liệu hình ảnh đồ họa, âm thanh và video theo các tiêu chuẩn khác nhau, chẳng hạn như JPEG, MPEG, hoặc TIFF.

---

##### 4.2.8 Tầng ứng dụng (Application Layer)

Các chức năng của **tầng ứng dụng** trong mô hình OSI được xác định là cung cấp các dịch vụ đa dạng cho các ứng dụng người dùng – chẳng hạn như truy cập vào các tài nguyên mạng chung (tệp, máy in, hoặc trang web) hoặc các dịch vụ mạng phân tán (thư điện tử, dịch vụ nhắn tin, cơ sở dữ liệu). Thông thường, các dịch vụ của tầng ứng dụng bao gồm nhận diện và xác thực (authentication) các bên tham gia tương tác mạng, kiểm tra khả năng truy cập và quyền hạn, cũng như xác định các yêu cầu về bảo mật của phiên trao đổi dữ liệu, v.v.

Để thực hiện các yêu cầu từ tầng ứng dụng, hệ thống sử dụng các lệnh gọi hệ thống (system calls) của hệ điều hành, hình thành giao diện lập trình ứng dụng (Application Programming Interface, API). Hệ điều hành thực hiện các quy trình truy cập dịch vụ tầng ứng dụng một cách minh bạch đối với ứng dụng người dùng, che giấu toàn bộ chi tiết về cấu trúc của hệ thống vận chuyển trong mạng, cũng như hoạt động của các tầng phiên (session layer) và trình bày (presentation layer).

Dưới đây là bản dịch đầy đủ và đúng chuyên ngành từ nội dung trong hình ảnh:

---

##### 4.2.9 Mô hình OSI và mạng chuyển mạch kênh

Như đã đề cập, mô hình OSI mô tả quá trình tương tác giữa các thiết bị trong mạng chuyển mạch gói (packet-switched networks). Vậy còn đối với các mạng **chuyển mạch kênh (circuit-switched networks)** thì sao? Liệu có một mô hình tham chiếu riêng dành cho chúng không? Có thể so sánh các chức năng của công nghệ chuyển mạch kênh với các tầng của mô hình OSI không?

Câu trả lời là có. Để biểu thị cấu trúc phương tiện tương tác trong các mạng chuyển mạch kênh, cũng sử dụng cách tiếp cận đa tầng (multi-layered approach), trong đó tồn tại các giao thức của nhiều tầng, tạo thành một hệ thống phân cấp. Tuy nhiên, không có một mô hình tham chiếu chung, tương tự mô hình OSI, cho các mạng chuyển mạch kênh. Ví dụ, các loại mạng điện thoại khác nhau có các bộ giao thức riêng, khác nhau về số lượng tầng và phân bố chức năng giữa chúng. Các hệ thống cấp thấp, như **SDH** hoặc **DWDM**, cũng sở hữu giao thức phân cấp riêng.

Tình hình trở nên đơn giản hơn ở chỗ, trong các mạng chuyển mạch kênh hiện đại, công nghệ này chỉ được sử dụng cho việc truyền tải dữ liệu người dùng, còn việc thiết lập kết nối và quản lý chung của mạng thường áp dụng công nghệ chuyển mạch gói. Các mạng như vậy bao gồm, chẳng hạn, **ISDN**, **SDH**, và **DWDM**.

> **Đối với các mạng chuyển mạch gói (packet-switched networks), các mạng chuyển mạch kênh (circuit-switched networks) cung cấp dịch vụ ở tầng vật lý (physical layer), mặc dù bản thân chúng được cấu trúc khá phức tạp và hỗ trợ một hệ thống phân cấp giao thức riêng.**


Hãy xem xét, ví dụ, trường hợp khi một số mạng cục bộ (LAN) dựa trên chuyển mạch gói được kết nối với nhau qua một mạng điện thoại kỹ thuật số. Rõ ràng, các chức năng tạo thành mạng hợp thành (composite network) được thực hiện bởi các giao thức tầng mạng (network layer). Do đó, chúng ta cần cài đặt một bộ định tuyến (router) trong mỗi mạng LAN. Bộ định tuyến phải được trang bị giao diện (interface) có khả năng thiết lập kết nối qua mạng điện thoại với một mạng LAN khác.

Sau khi thiết lập kết nối trong mạng điện thoại, một kênh dữ liệu được hình thành, truyền dữ liệu với tốc độ cố định. Kênh này cung cấp cho các bộ định tuyến dịch vụ của tầng vật lý (physical service). Để tổ chức truyền dữ liệu, các bộ định tuyến sử dụng trên kênh vật lý này một giao thức tầng liên kết dữ liệu (data link layer protocol) hai chiều bất kỳ.

---

#### 4.3 Tiêu chuẩn hóa mạng (Network Standardization)

Nguyên lý phổ quát về lợi ích của việc tiêu chuẩn hóa, đúng với mọi ngành, có một ý nghĩa đặc biệt trong lĩnh vực mạng máy tính. Bản chất của mạng là sự kết nối giữa các thiết bị khác nhau, và do đó, vấn đề tương thích (compatibility) trở thành một trong những thách thức lớn nhất. Nếu không có sự đồng thuận của tất cả các nhà sản xuất về các tiêu chuẩn chung cho thiết bị và giao thức, việc phát triển trong lĩnh vực "xây dựng" mạng sẽ trở nên bất khả thi. 

Do đó, sự phát triển của ngành công nghiệp máy tính, cuối cùng, được phản ánh trong các tiêu chuẩn – bất kỳ công nghệ mới nào chỉ có được trạng thái "hợp pháp" khi nội dung của nó được cố định trong một tiêu chuẩn tương ứng.

Trong mạng máy tính, nền tảng tư tưởng của việc tiêu chuẩn hóa là **mô hình kết nối các hệ thống mở (Open System Interconnection - OSI)** đã được đề cập ở trên.

---

##### 4.3.1 Khái niệm về hệ thống mở (Open System)

**Hệ thống mở** là gì?

Hệ thống mở có thể là bất kỳ hệ thống nào (máy tính, mạng tính toán, hệ điều hành, gói phần mềm, các thiết bị phần cứng và sản phẩm phần mềm khác) được xây dựng theo các đặc tả mở (open specifications).

Hãy nhớ rằng, trong lĩnh vực kỹ thuật tính toán, thuật ngữ **đặc tả (specification)** được hiểu là mô tả chính thức về các thành phần phần cứng hoặc phần mềm, cách thức hoạt động của chúng, sự tương tác với các thành phần khác, điều kiện sử dụng, và các đặc điểm cụ thể khác. Rõ ràng, không phải mọi đặc tả đều là một tiêu chuẩn.

> **Đặc tả mở (open specifications)** được hiểu là các đặc tả được công bố, phổ biến rộng rãi, tuân thủ các tiêu chuẩn, và được chấp nhận sau khi đạt được sự đồng thuận thông qua thảo luận công khai với tất cả các bên liên quan.

Việc sử dụng các đặc tả mở (open specifications) trong quá trình phát triển các hệ thống mở cho phép các bên thứ ba tạo ra các thiết bị phần cứng hoặc phần mềm khác nhau cho các hệ thống này, mở rộng và sửa đổi chúng. Ngoài ra, các hệ thống này còn hỗ trợ tích hợp các sản phẩm phần cứng và phần mềm từ nhiều nhà sản xuất khác nhau.

Tính mở của các tiêu chuẩn và đặc tả không chỉ quan trọng đối với các giao thức truyền thông mà còn đối với các thiết bị và chương trình đa dạng được sản xuất để xây dựng mạng. Cần lưu ý rằng phần lớn các tiêu chuẩn được chấp nhận ngày nay mang tính mở. Thời đại của các hệ thống đóng, nơi các đặc tả chính xác chỉ được biết đến bởi nhà sản xuất, đã qua đi. Người ta nhận ra rằng khả năng tương tác với các sản phẩm của đối thủ cạnh tranh không làm giảm giá trị sản phẩm mà ngược lại, làm tăng giá trị của nó, vì nó cho phép sử dụng trong nhiều mạng được xây dựng từ các sản phẩm của các nhà sản xuất khác nhau. Do đó, ngay cả các công ty trước đây chỉ phát hành hệ thống đóng, như IBM và Microsoft, ngày nay cũng tích cực tham gia vào việc phát triển các tiêu chuẩn mở và áp dụng chúng trong sản phẩm của họ.

Tuy nhiên, trong thực tế, sự mở hoàn toàn của các hệ thống là một lý tưởng khó đạt được. Thông thường, ngay cả trong các hệ thống được gọi là mở, định nghĩa này chỉ phù hợp với các phần hỗ trợ giao diện bên ngoài. Ví dụ, tính mở của họ Unix bao gồm, ngoài các yếu tố khác, sự tồn tại của giao diện lập trình chuẩn hóa giữa kernel và ứng dụng, cho phép dễ dàng di chuyển ứng dụng giữa các phiên bản Unix khác nhau.

Mô hình OSI chỉ liên quan đến một khía cạnh của tính mở, cụ thể là tính mở của các phương tiện tương tác giữa các thiết bị được kết nối với mạng máy tính. Trong ngữ cảnh này, hệ thống mở được hiểu là một thiết bị mạng có thể tương tác với các thiết bị mạng khác theo các quy tắc tiêu chuẩn, xác định định dạng, nội dung và ý nghĩa của các thông điệp gửi và nhận.

Nếu hai mạng được xây dựng tuân thủ nguyên tắc mở, điều này mang lại các lợi ích sau:
- **Khả năng xây dựng mạng từ các thiết bị phần cứng và phần mềm của các nhà sản xuất khác nhau, tuân thủ cùng một tiêu chuẩn;**
- **Dễ dàng thay thế các thành phần riêng lẻ bằng các thành phần tiên tiến hơn, cho phép mạng phát triển với chi phí tối thiểu;**
- **Dễ dàng kết nối các mạng khác nhau với nhau.**

---

##### 4.3.2 Nguồn gốc của các tiêu chuẩn

Luật **"Về quy định kỹ thuật"** ngày 27.12.2002 số 184-ФЗ định nghĩa khái niệm "tiêu chuẩn" như sau:

**"Tiêu chuẩn"** là một tài liệu, trong đó, nhằm mục đích sử dụng tự nguyện, xác định các đặc điểm của sản phẩm, các quy tắc thực hiện và đặc điểm của các quá trình thiết kế (bao gồm khảo sát), sản xuất, xây dựng, lắp ráp, vận hành, bảo trì, lưu trữ, vận chuyển, tiêu thụ và tái chế, thực hiện công việc hoặc cung cấp dịch vụ. Tiêu chuẩn cũng có thể chứa các quy tắc và phương pháp nghiên cứu (thử nghiệm) và đo lường, quy tắc chọn mẫu, yêu cầu về thuật ngữ, ký hiệu, bao bì, nhãn mác hoặc nhãn dán và các quy tắc áp dụng chúng."

Theo mặc định, **việc tuân thủ tiêu chuẩn không phải là bắt buộc** (trừ khi rõ ràng yêu cầu bắt buộc phải thực hiện). Tuy nhiên, có rất nhiều lý do khiến phần lớn các công ty, doanh nghiệp, cá nhân và tổ chức tự nguyện lựa chọn tuân thủ các tiêu chuẩn.

Như đã đề cập trước đó, tiêu chuẩn hóa là một phương tiện để đảm bảo khả năng tương thích giữa các công nghệ thông tin, sản phẩm và thuật ngữ. Việc tuân thủ các tiêu chuẩn cũng cho phép tạo ra các công nghệ, hệ thống và dịch vụ chất lượng hơn, cạnh tranh hơn, vì tiêu chuẩn là sự biểu hiện cô đọng của những ý tưởng kỹ thuật tiên tiến, tích lũy kiến thức lý thuyết hiện đại và được gọi là **"thực hành tốt nhất (best practices)"**.

Theo Luật Liên bang Nga **"Về quy định kỹ thuật"**, bất kỳ cá nhân hoặc tổ chức nào cũng có thể trở thành nhà phát triển tiêu chuẩn, nhưng thông thường, các tiêu chuẩn được phát triển bởi các nhóm làm việc (ủy ban kỹ thuật). Các nhóm này bao gồm đại diện từ các cơ quan hành pháp, tổ chức khoa học, thương mại và phi thương mại, và các hiệp hội xã hội. Một trong những nguyên tắc chính của tiêu chuẩn hóa là sự tham gia của những cá nhân và tổ chức quan tâm nhất đến tiêu chuẩn đang được phát triển. Do đó, rất thường xuyên, các nhà phát triển tiêu chuẩn chính là các công ty và tổ chức đã hoạt động thành công trong lĩnh vực mà tiêu chuẩn đó áp dụng.

Tùy thuộc vào tình trạng của tổ chức phát triển, các loại tiêu chuẩn sau được phân biệt:

- **Tiêu chuẩn của các công ty riêng lẻ**, ví dụ, chồng giao thức SNA của IBM hoặc giao diện đồ họa vật lý OPEN LOOK cho các hệ thống Unix của Sun;  
- **Tiêu chuẩn của các ủy ban và hiệp hội chuyên biệt**, được phát triển bởi một số công ty, ví dụ: tiêu chuẩn công nghệ ATM được phát triển bởi diễn đàn ATM Forum (với khoảng 100 thành viên tham gia) hoặc tiêu chuẩn của liên minh Fast Ethernet Alliance, liên quan đến công nghệ 100 Mbit Ethernet;  
- **Tiêu chuẩn quốc gia**, chẳng hạn như tiêu chuẩn FDDI, một trong nhiều tiêu chuẩn của viện ANSI (Mỹ), hoặc tiêu chuẩn an ninh cho hệ điều hành, được phát triển bởi trung tâm NCSC của Bộ Quốc phòng Hoa Kỳ;  
- **Tiêu chuẩn quốc tế**, ví dụ, mô hình và chồng giao thức truyền thông của Tổ chức Tiêu chuẩn hóa Quốc tế (ISO), các tiêu chuẩn của Liên minh Viễn thông Quốc tế (ITU), bao gồm tiêu chuẩn mạng chuyển mạch gói X.25, các tiêu chuẩn Frame Relay, ISDN, modem, và nhiều tiêu chuẩn khác.

Tại Nga, vai trò tổ chức chính trong việc tiêu chuẩn hóa thuộc về **Cơ quan Liên bang về Quy định Kỹ thuật và Đo lường (Rosstandart)**. Rosstandart thành lập và phối hợp các nhóm làm việc để phát triển tiêu chuẩn, tổ chức các cuộc thảo luận công khai và phê duyệt các tài liệu tiêu chuẩn, đồng thời xuất bản và phổ biến các tiêu chuẩn quốc gia.

Một số tiêu chuẩn, phát triển liên tục, có thể chuyển từ một loại này sang loại khác. Đặc biệt, các tiêu chuẩn của công ty, sau khi sản phẩm nhận được sự phổ biến rộng rãi, thường trở thành tiêu chuẩn quốc tế trên thực tế (de-facto). Ví dụ, yêu cầu của các nhà sản xuất sử dụng các sản phẩm từ các công ty khác buộc phải tuân thủ các tiêu chuẩn công ty để đảm bảo khả năng tương thích với các sản phẩm đã phổ biến.

Hơn nữa, do được sử dụng rộng rãi, một số tiêu chuẩn của công ty đã trở thành nền tảng cho các tiêu chuẩn quốc gia và quốc tế **de-jure**. Ví dụ, tiêu chuẩn **Ethernet**, ban đầu được phát triển bởi các công ty **Digital Equipment**, **Intel** và **Xerox**, sau một thời gian và với một số sửa đổi, đã được chấp nhận làm tiêu chuẩn quốc gia **IEEE 802.3**, và sau đó được tổ chức **ISO** phê chuẩn như một tiêu chuẩn quốc tế với mã hiệu **ISO 8802.3**.

---

##### 4.3.3 Tiêu chuẩn hóa Internet

Một ví dụ điển hình về hệ thống mở là **Internet**. Mạng quốc tế này đã phát triển hoàn toàn phù hợp với các yêu cầu đặt ra cho các hệ thống mở. Hàng nghìn chuyên gia đã tham gia vào việc phát triển các tiêu chuẩn của Internet – người dùng từ các trường đại học, tổ chức khoa học và công ty khác nhau – các nhà sản xuất phần cứng và phần mềm máy tính, hoạt động tại các quốc gia khác nhau. Chính tên gọi của các tiêu chuẩn xác định hoạt động của Internet – **Request For Comments (RFC)** – cho thấy tính chất minh bạch và mở của các tiêu chuẩn được áp dụng. Kết quả là, Internet đã có thể kết hợp trong mình nhiều thiết bị và phần mềm đa dạng của vô số mạng, được phân tán trên toàn thế giới.

Do sự phổ biến ngày càng tăng của Internet, các tài liệu RFC đã trở thành **tiêu chuẩn quốc tế de-facto**, nhiều trong số đó sau này có được trạng thái chính thức là **tiêu chuẩn quốc tế** thông qua sự phê chuẩn của các tổ chức tiêu chuẩn hóa, như **ISO** hoặc **ITU-T**.

Hiện có một số đơn vị tổ chức phụ trách sự phát triển và, đặc biệt, tiêu chuẩn hóa kiến trúc và giao thức của Internet. Trong số đó, đơn vị chính là **Cộng đồng Internet (Internet Society, ISOC)**, một tổ chức hành chính-khoa học bao gồm khoảng 100.000 thành viên, giải quyết các vấn đề xã hội, chính trị và kỹ thuật liên quan đến sự phát triển của Internet.

Dưới sự quản lý của ISOC có **Hội đồng Kiến trúc Internet (Internet Architecture Board, IAB)**. IAB giám sát hai nhóm chính:  
- **Nhóm Nhiệm vụ Nghiên cứu Internet (Internet Research Task Force, IRTF)**: điều phối các dự án nghiên cứu dài hạn về các giao thức như TCP/IP.  
- **Lực lượng Đặc nhiệm Kỹ thuật Internet (Internet Engineering Task Force, IETF)**: một nhóm kỹ thuật giải quyết các vấn đề kỹ thuật thực tế của Internet. Chính IETF xác định các tiêu chuẩn, sau đó trở thành **tiêu chuẩn chính thức của Internet**. Quá trình phát triển và thông qua tiêu chuẩn cho các giao thức Internet bao gồm một số giai đoạn bắt buộc, bao gồm thử nghiệm thực tế lâu dài.

Tuân thủ nguyên tắc mở, các tài liệu RFC luôn được cung cấp tự do, không giống như các tiêu chuẩn ISO. Danh sách các tài liệu RFC có thể được tìm thấy trên trang **www.rfc-editor.org**.

---

##### 4.3.4 Các chồng giao thức truyền thông tiêu chuẩn

Một hướng quan trọng nhất của việc tiêu chuẩn hóa trong lĩnh vực mạng máy tính là tiêu chuẩn hóa các **giao thức truyền thông (communication protocols)**. Những chồng giao thức nổi tiếng nhất bao gồm:  
- **OSI**  
- **TCP/IP**  
- **IPX/SPX**  
- **NetBIOS/SMB**  
- **DECnet**  
- **SNA**  

(Lưu ý rằng không phải tất cả trong số chúng vẫn được sử dụng trong thực tế ngày nay).

---

###### 4.3.4.1 Chồng giao thức OSI (OSI Stack)

Điều quan trọng là phải phân biệt giữa **mô hình OSI** và **chồng giao thức OSI**. Trong khi mô hình OSI là một khái niệm trừu tượng, thì chồng giao thức OSI, được xây dựng dựa trên mô hình OSI, đại diện cho một tập hợp các đặc tả cụ thể về các giao thức cũng như nhiều cách hiện thực phần mềm của các giao thức này.

Không giống như các chồng giao thức khác, **chồng OSI** hoàn toàn phù hợp với mô hình OSI, bao gồm các đặc tả về giao thức cho tất cả bảy tầng tương tác, được định nghĩa trong mô hình này (hình 4.10). Điều này hoàn toàn dễ hiểu – các nhà phát triển của chồng OSI đã sử dụng mô hình OSI như một hướng dẫn hành động trực tiếp.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.10.png" alt="Hình 4.10. Ngăn xếp giao thức OSI" width="900">
</p>
<p align="center"><b>Hình 4.10. Ngăn xếp giao thức OSI</b></p>

Các giao thức của chồng OSI được đặc trưng bởi sự phức tạp và tính không rõ ràng trong các đặc tả. Những đặc điểm này là kết quả của chính sách chung của các nhà phát triển chồng giao thức, nhằm mục đích tính đến trong các giao thức của họ mọi sự đa dạng của các công nghệ hiện có và mới xuất hiện.

Ở **tầng vật lý (physical layer)** và **tầng liên kết dữ liệu (data link layer)**, chồng OSI hỗ trợ các giao thức **Ethernet**, **Token Ring**, **FDDI**, cũng như các giao thức **LLC**, **X.25** và **ISDN**. Điều này có nghĩa là, giống như hầu hết các chồng giao thức khác, chồng OSI sử dụng các giao thức phổ biến đã được phát triển bên ngoài chồng giao thức này cho các tầng thấp.

**Tầng mạng (network layer)** bao gồm các giao thức tương đối ít được sử dụng như **Connection-oriented Network Protocol (CONP)** và **Connectionless Network Protocol (CLNP)**. Như tên gọi, giao thức đầu tiên định hướng kết nối (**connection-oriented**), trong khi giao thức thứ hai không dựa trên kết nối (**connectionless**).

Phổ biến hơn là các giao thức định tuyến của chồng OSI:
- Giữa hệ thống đầu cuối và hệ thống trung gian (**End System – Intermediate System, ES-IS**);
- Giữa các hệ thống trung gian (**Intermediate System – Intermediate System, IS-IS**).

**Tầng giao vận (Transport Layer)** của chồng OSI, tuân theo các chức năng được xác định trong mô hình OSI, che giấu sự khác biệt giữa các dịch vụ mạng dựa trên kết nối (**connection-oriented**) và không dựa trên kết nối (**connectionless**), đảm bảo rằng người dùng nhận được chất lượng dịch vụ mong muốn bất kể tầng mạng bên dưới hoạt động như thế nào. Để đảm bảo điều này, tầng giao vận yêu cầu người dùng xác định chất lượng dịch vụ cần thiết.

**Các dịch vụ của tầng ứng dụng (Application Layer)** đảm bảo truyền tệp, giả lập terminal, dịch vụ thư mục và thư tín. Trong số đó, những dịch vụ phổ biến nhất bao gồm:
- **Dịch vụ thư mục** (theo tiêu chuẩn X.500);
- **Thư điện tử** (X.400);
- **Giao thức terminal ảo (Virtual Terminal Protocol, VTP)**;
- **Giao thức truyền, truy cập và quản lý tệp** (File Transfer, Access and Management, FTAM);
- **Giao thức quản lý công việc** (Job Transfer and Management, JTM).

---

###### 4.3.4.2 Chồng NetBIOS/SMB

Chồng NetBIOS/SMB là kết quả của sự hợp tác giữa các công ty **IBM** và **Microsoft** (hình 4.11). Ở các tầng vật lý (**physical layer**) và tầng liên kết dữ liệu (**data link layer**) của chồng này, các giao thức đã được phổ biến rộng rãi như **Ethernet**, **Token Ring**, và **FDDI** được sử dụng. Ở các tầng cao hơn, chồng này sử dụng các giao thức đặc thù như **NetBEUI** và **SMB**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.11.png" alt="Hình 4.11. Ngăn xếp NetBIOS/SMB" width="900">
</p>
<p align="center"><b>Hình 4.11. Ngăn xếp NetBIOS/SMB</b></p>

**Giao thức Network Basic Input/Output System (NetBIOS)** được giới thiệu vào năm 1984 như một phần mở rộng mạng cho các chức năng tiêu chuẩn của hệ thống đầu vào/đầu ra cơ bản (BIOS) trên máy tính IBM PC, dành cho chương trình mạng PC Network của công ty IBM. Sau đó, giao thức này được thay thế bằng **giao thức giao diện người dùng mở rộng NetBEUI (NetBIOS Extended User Interface)**. Để đảm bảo tương thích với các ứng dụng, giao diện NetBIOS đã được giữ lại trong NetBEUI. NetBEUI được phát triển như một giao thức hiệu quả, sử dụng ít tài nguyên và được thiết kế cho các mạng với tối đa 200 trạm làm việc.

Giao thức này hỗ trợ nhiều chức năng mạng hữu ích, có thể gắn liền với các tầng giao vận (transport layer) và tầng phiên (session layer) trong mô hình OSI. Tuy nhiên, **NetBEUI không hỗ trợ định tuyến gói tin (packet routing)**. Điều này giới hạn việc sử dụng NetBEUI trong các mạng cục bộ (LAN), không tách rời theo phân đoạn, và khiến nó không thể sử dụng trong các mạng liên kết phức hợp.

**Giao thức Server Message Block (SMB)** hỗ trợ các chức năng của tầng phiên, tầng trình bày (presentation layer), và tầng ứng dụng (application layer). Dựa trên giao thức SMB, các dịch vụ chia sẻ tệp, dịch vụ in ấn và truyền thông tin giữa các ứng dụng được thực hiện.

---

###### 4.3.4.3 Chồng TCP/IP

Chồng TCP/IP được phát triển theo sáng kiến của **Bộ Quốc phòng Hoa Kỳ** hơn 20 năm trước để kết nối mạng thử nghiệm ARPAnet với các mạng khác như một tập hợp các giao thức chung cho các môi trường tính toán khác nhau. Đóng góp lớn vào sự phát triển của chồng TCP/IP, được đặt tên theo các giao thức phổ biến **IP** và **TCP**, đến từ **Đại học Berkeley**, khi họ triển khai các giao thức của chồng này trong phiên bản hệ điều hành UNIX của họ. Sự phổ biến của hệ điều hành này đã dẫn đến sự lan rộng rộng rãi của các giao thức **TCP**, **IP** và các giao thức khác của chồng.

Ngày nay, chồng này được sử dụng để kết nối các máy tính trên Internet cũng như trong vô số mạng doanh nghiệp. Chúng tôi sẽ xem xét chi tiết chồng giao thức TCP/IP trong **Phần IV** của cuốn sách này, nơi tập trung vào các mạng đồng danh.

---

##### 4.3.5 Sự tương thích của các stack giao thức (protocol stacks) phổ biến với mô hình OSI

Trong hình 4.12 cho thấy mức độ các stack giao thức phổ biến tương thích với các khuyến nghị của mô hình OSI (Open Systems Interconnection model). Như chúng ta thấy, điều này thường chỉ là tương thích tương đối. Trong hầu hết các trường hợp, các nhà phát triển stack ưu tiên tốc độ mạng (network speed) thay vì tính mô-đun hóa (modularity) — không một stack nào, ngoài stack OSI, được phân chia thành bảy tầng (seven layers). Thường thì trong stack chỉ rõ ràng có 3–4 tầng: tầng bộ điều hợp mạng (network adapter), nơi các giao thức (protocols) của tầng vật lý (physical layer) và tầng liên kết dữ liệu (data link layer) được thực hiện; tầng mạng (network layer); tầng vận chuyển (transport layer); và tầng dịch vụ (service layer), bao gồm các chức năng của tầng phiên (session layer), tầng trình bày (presentation layer) và tầng ứng dụng (application layer).

Cấu trúc của các stack giao thức thường không phù hợp với sự phân chia theo tầng được khuyến nghị trong mô hình OSI vì các lý do khác nhau. Hãy nhớ rằng một phân cấp nhiều tầng (multilayered decomposition) lý tưởng được đặc trưng bởi: một mặt, tuân theo nguyên tắc phân cấp (hierarchy); mỗi tầng bên trên chỉ truy cập các dịch vụ của tầng ngay bên dưới nó và tầng bên dưới chỉ cung cấp các dịch vụ của nó cho tầng ngay trên. Trong các stack giao thức, điều này dẫn đến PDU (Protocol Data Unit) của tầng bên trên luôn được đóng gói vào PDU của tầng bên dưới. Mặt khác, một phân cấp lý tưởng không có giải pháp thiết kế trong đó các chức năng thuộc về một tầng lại được chuyển sang tầng khác. Tuy nhiên, các yêu cầu như vậy thường mâu thuẫn trong thực tế. Ví dụ, chức năng chính của các giao thức tầng mạng như TCP/IP (cũng như trong mô hình OSI) là chuyển tiếp các gói tin (packet forwarding) thông qua một mạng. Giải pháp này đòi hỏi các giao thức như IP (Internet Protocol) tiếp tục xử lý việc định tuyến (routing), đặc biệt là RIP (Routing Information Protocol) và OSPF (Open Shortest Path First). Nếu theo nguyên tắc phân cấp của stack, giao thức IP và giao thức định tuyến phải được gán vào một tầng duy nhất. Nhưng nếu xem xét rằng các thông điệp của giao thức RIP được đóng gói trong các datagram của tầng vận chuyển (transport layer), còn thông điệp của giao thức OSPF thì trong các gói tin IP, thì về mặt hình thức, tuân theo nguyên tắc tổ chức phân cấp của stack, OSPF nên được gán vào tầng vận chuyển, còn RIP — vào tầng ứng dụng. Tuy nhiên, trong thực tế, các giao thức định tuyến thường được gán vào tầng mạng.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.12.png" alt="Hình 4.12. Tương ứng giữa các ngăn xếp giao thức phổ biến trong mô hình OSI" width="900">
</p>
<p align="center"><b>Hình 4.12. Tương ứng giữa các ngăn xếp giao thức phổ biến trong mô hình OSI</b></p>

---

#### 4.4 Dịch vụ thông tin và dịch vụ vận chuyển

Các dịch vụ trong mạng máy tính (computer network services) có thể được chia thành hai loại:  
- Dịch vụ vận chuyển (transport services);  
- Dịch vụ thông tin (information services).

**Dịch vụ vận chuyển (Transport services)** bao gồm việc truyền thông tin giữa các người dùng mạng mà không thay đổi nội dung. Trong trường hợp này, mạng nhận thông tin từ người dùng ở một trong các giao diện (interface) của nó, truyền thông tin qua các bộ chuyển mạch trung gian (intermediate switches) và chuyển đến người dùng khác qua một giao diện khác. Khi cung cấp dịch vụ vận chuyển, mạng không thực hiện bất kỳ thay đổi nào đối với thông tin được truyền đi, đảm bảo rằng thông tin được chuyển tới người nhận ở dạng ban đầu, giống như khi nó được gửi từ phía người gửi. Một ví dụ về dịch vụ vận chuyển trong mạng toàn cầu (global network) là việc liên kết các mạng cục bộ của các khách hàng (local client networks).

**Dịch vụ thông tin (Information services)** bao gồm việc cung cấp cho người dùng một số thông tin mới. Dịch vụ thông tin luôn liên quan đến các thao tác xử lý thông tin: lưu trữ thông tin ở một dạng được tổ chức nào đó (hệ thống tập tin - file system, cơ sở dữ liệu - database, trang web - website), tìm kiếm thông tin cần thiết và chuyển đổi thông tin.

Trong các mạng viễn thông (telecommunication networks) của thời kỳ "trước máy tính" (pre-computer era), dịch vụ vận chuyển (transport services) luôn chiếm ưu thế. Dịch vụ chính của mạng điện thoại (telephone network) là truyền tải lưu lượng thoại (voice traffic) giữa các thuê bao (subscribers), trong khi các dịch vụ tra cứu thông tin (reference services) chỉ là phụ. Với sự xuất hiện của máy tính, các dịch vụ thông tin (information services) đã trải qua một cuộc cách mạng, bởi vì máy tính đã được phát minh để xử lý thông tin tự động bằng phần mềm (automated programmatic information processing). Trong các mạng máy tính (computer networks), cả hai loại dịch vụ này đều quan trọng như nhau. Nhờ vào đặc điểm này, thế hệ mạng viễn thông mới đôi khi được gọi là **mạng thông tin liên lạc (infocommunication networks)**.

---

##### 4.4.1 Phân bố giao thức theo các thành phần mạng

Trong hình 4.13, các thành phần chính của mạng máy tính (computer network) được trình bày:  
- Các nút cuối (end nodes) — máy tính (computers);  
- Các nút trung gian (intermediate nodes) — bộ chuyển mạch (switches) và bộ định tuyến (routers).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.13.png" alt="Hình 4.13. Tương ứng các chức năng của các thiết bị mạng với các tầng của mô hình OSI" width="900">
</p>
<p align="center"><b>Hình 4.13. Tương ứng các chức năng của các thiết bị mạng với các tầng của mô hình OSI</b></p>

Từ hình vẽ có thể thấy rằng toàn bộ stack giao thức (protocol stack) chỉ được thực hiện tại các nút cuối (end nodes), trong khi các thiết bị truyền thông (communication devices) đủ chức năng để chuyển tiếp các gói tin (packet forwarding) ở ba tầng dưới. Hơn nữa, thiết bị truyền thông có thể chỉ hỗ trợ các giao thức của hai tầng dưới hoặc thậm chí chỉ một tầng vật lý (physical layer) — điều này phụ thuộc vào loại thiết bị.

Cụ thể, các thiết bị hoạt động ở tầng vật lý bao gồm, ví dụ, các bộ lặp mạng (network repeaters), còn được gọi là bộ tập trung (concentrators) hoặc hub. Chúng tái tạo các tín hiệu điện (electrical signals), truyền từ một giao diện của chúng đến các giao diện khác, cải thiện các đặc điểm của tín hiệu — công suất (power), hình dạng (form), và tính đồng bộ (synchronization) của chúng.

**Các bộ chuyển mạch mạng cục bộ (local network switches)** hỗ trợ các giao thức của hai tầng dưới, tầng vật lý và tầng liên kết dữ liệu (data link layer), điều này cho phép chúng hoạt động trong phạm vi các cấu trúc liên kết chuẩn (standard topologies).

---

**Các bộ định tuyến (routers)** phải hỗ trợ các giao thức của tất cả các tầng, vì tầng mạng (network layer) cần thiết để kết nối các mạng (networks) với các công nghệ khác nhau, và các tầng dưới (lower layers) để tương tác với các mạng cụ thể tạo thành một mạng ghép (composite network), ví dụ như Ethernet hoặc Frame Relay.

**Các bộ chuyển mạch mạng toàn cầu (global network switches)** (ví dụ, MPLS - Multiprotocol Label Switching), hoạt động trên cơ sở công nghệ kênh ảo (virtual channel technology), có thể hỗ trợ cả hai hoặc ba tầng giao thức. Giao thức tầng mạng (network layer protocol) chỉ cần thiết nếu chúng hỗ trợ quy trình thiết lập tự động các kênh ảo (virtual channel establishment). Vì vậy, trong các cấu hình topological của mạng toàn cầu, không thể bỏ qua giao thức tầng mạng. Nếu các kết nối ảo (virtual connections) được thiết lập thủ công bởi các quản trị viên mạng (network administrators), thì các bộ chuyển mạch mạng toàn cầu chỉ cần hỗ trợ các giao thức của tầng vật lý (physical layer) và tầng liên kết dữ liệu (data link layer) để truyền dữ liệu qua các kênh ảo đã được thiết lập.

**Máy tính (computers)**, nơi các ứng dụng mạng (network applications) hoạt động, phải hỗ trợ các giao thức của tất cả các tầng. Các giao thức tầng ứng dụng (application layer protocols), sử dụng dịch vụ của các giao thức tầng trình bày (presentation layer) và tầng phiên (session layer), cung cấp cho ứng dụng một tập hợp dịch vụ mạng (network services) dưới dạng giao diện lập trình ứng dụng mạng (API - Application Programming Interface). Giao thức tầng vận chuyển (transport layer protocols) cũng hoạt động ở tất cả các nút. Khi truyền dữ liệu qua hai mô-đun của giao thức vận chuyển hoạt động trên nút gửi và nút nhận, chúng tương tác với nhau để hỗ trợ dịch vụ vận chuyển ở chất lượng mong muốn. Các thiết bị truyền thông mạng truyền tải các thông điệp của giao thức vận chuyển một cách minh bạch, mà không cần can thiệp vào nội dung của chúng.

**Các nút cuối của mạng (end nodes)** (máy tính và các thiết bị tương tự, ví dụ điện thoại di động) luôn cung cấp cả dịch vụ thông tin (information services) và dịch vụ vận chuyển (transport services), trong khi các nút trung gian của mạng (intermediate network nodes) — chỉ hỗ trợ dịch vụ vận chuyển. Khi nói rằng mạng chỉ cung cấp **dịch vụ vận chuyển**, điều đó có nghĩa là các nút cuối nằm ngoài biên giới của mạng. Điều này thường áp dụng cho các mạng phục vụ khách hàng trong môi trường thương mại.

Nếu nói rằng mạng cũng cung cấp **dịch vụ thông tin**, điều đó có nghĩa là các máy tính, cung cấp các dịch vụ như vậy, được đưa vào thành phần mạng. Một ví dụ là trường hợp nhà cung cấp dịch vụ Internet (ISP) cũng hỗ trợ các máy chủ web (web servers) của chính họ.

---

##### 4.4.2 Các giao thức hỗ trợ (auxiliary protocols) của hệ thống vận chuyển

Đã đến lúc phải nói rằng trong hình 4.13 trình bày một phiên bản đơn giản hóa của việc phân bổ giao thức (protocol distribution) giữa các thành phần mạng. Trong các mạng thực tế, một số thiết bị truyền thông (communication devices) không chỉ hỗ trợ các giao thức của ba tầng dưới (lower layers), mà còn hỗ trợ các giao thức của các tầng trên (upper layers). Ví dụ, các bộ định tuyến (routers) thực hiện các giao thức định tuyến (routing protocols), cho phép tự động xây dựng các bảng định tuyến (routing tables), trong khi các bộ tập trung (concentrators) và các bộ chuyển mạch (switches) thường hỗ trợ các giao thức như SNMP (Simple Network Management Protocol) và Telnet, vốn không cần thiết cho việc thực hiện các chức năng chính của các thiết bị này, nhưng cho phép cấu hình và quản lý từ xa. Ngoài ra còn có các máy chủ DNS (Domain Name System servers), hiển thị tên miền (symbolic hostnames) tương ứng với các địa chỉ IP (IP addresses), và không có chúng, hoạt động bình thường trên Internet sẽ gần như không thể.

Phần lớn các giao thức hỗ trợ, về mặt hình thức, thuộc về tầng ứng dụng (application layer) trong mô hình OSI, vì trong hoạt động của chúng, chúng tương tác với các giao thức của các tầng dưới như TCP (Transmission Control Protocol), UDP (User Datagram Protocol) hoặc SSL (Secure Sockets Layer). Tuy nhiên, các giao thức hỗ trợ không truyền tải dữ liệu của người dùng (user data), có nghĩa là chúng không thực hiện các chức năng trực tiếp của giao thức tầng ứng dụng được mô tả trong mô hình OSI.

Rõ ràng, khi xem xét các giao thức hỗ trợ (auxiliary protocols), chúng ta đối mặt với tình huống trong đó việc phân chia giao thức theo các tầng phân cấp (hierarchical layers) (nghĩa là phân chia "theo chiều dọc") trong mô hình OSI không đủ. Việc phân chia giao thức thành các nhóm "theo chiều ngang" (horizontally) trở nên hữu ích.

Khi phân chia theo chiều ngang, tất cả các giao thức (bao gồm cả chính và hỗ trợ) được chia thành ba tầng (planes) (hình 4.14):  
- **Tầng người dùng (user plane)** bao gồm nhóm các giao thức chính, tức là các giao thức truyền tải lưu lượng người dùng (user traffic);  
- **Tầng điều khiển (control plane)** bao gồm các giao thức hỗ trợ cần thiết để hoạt động của các giao thức mạng chính, ví dụ: các giao thức định tuyến (routing protocols), các giao thức ánh xạ tên miền sang địa chỉ IP;  
- **Tầng quản lý (management plane)** kết hợp các giao thức hỗ trợ thực hiện các hoạt động quản lý (management operations) bởi quản trị viên mạng (network administrator), chẳng hạn như giao thức SNMP (Simple Network Management Protocol) để thu thập thông tin về lỗi (errors), các giao thức cấu hình thiết bị từ xa (remote device configuration protocols).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.14.png" alt="Hình 4.14. Ba nhóm giao thức" width="900">
</p>
<p align="center"><b>Hình 4.14. Ba nhóm giao thức</b></p>

Việc phân chia giao thức theo "chiều ngang" (horizontal division) giải quyết những phức tạp phát sinh khi liên kết một số giao thức với các tầng trong mô hình OSI. Ví dụ, trong các tài liệu của một số tác giả, các giao thức định tuyến (routing protocols) có thể được đặt ở tầng mạng (network layer), trong khi ở tài liệu của các tác giả khác, chúng lại nằm ở tầng ứng dụng (application layer). Điều này không phải do sự bất cẩn của các tác giả, mà xuất phát từ những khó khăn khách quan trong việc phân loại.

Mô hình OSI rất phù hợp cho việc chuẩn hóa các giao thức truyền tải lưu lượng người dùng (user traffic), tức là các giao thức thuộc tầng người dùng (user plane). Tuy nhiên, nó không phù hợp lắm cho việc xác định vị trí của các giao thức hỗ trợ (auxiliary protocols) trong mô hình hoạt động tổng thể của mạng. Do đó, nhiều tác giả đã phải đặt các giao thức định tuyến ở tầng mạng để phản ánh mối quan hệ chức năng gần gũi của các giao thức này với các hoạt động chuyển tiếp gói tin (packet forwarding operations).

---

#### 4.5 Phân loại mạng máy tính

**Phân loại (Classification)** là quá trình nhóm các đối tượng, tức là gán chúng vào một loại hoặc kiểu nào đó dựa trên các đặc điểm chung được nghiên cứu.

Mỗi đối tượng thực tế có thể có nhiều đặc điểm. Tính chủ quan của bất kỳ quá trình phân loại nào được thể hiện ở việc có một số yếu tố nhất định được chọn từ tập hợp các đặc điểm này để sử dụng làm cơ sở phân loại, tức là việc chọn **tiêu chí phân loại (criteria for classification)**. Phân loại mạng máy tính không phải là ngoại lệ — trong các nguồn tài liệu khác (và thậm chí trong cuốn sách này), bạn có thể tìm thấy các đặc điểm khác để phân loại mạng theo kiểu hoặc loại khác nhau.

Hãy bắt đầu với việc mạng máy tính — một phần của phân loại mạng viễn thông (telecommunication networks), dựa trên loại nội dung được truyền tải, được chia thành:  
- Mạng phát thanh (radio networks);  
- Mạng điện thoại (telephone networks);  
- Mạng truyền hình (television networks);  
- Mạng máy tính (computer networks).

Dựa trên **phạm vi vùng phủ sóng (coverage area)**, mạng máy tính có thể được chia thành ba nhóm:  
- **Mạng cục bộ (Local Area Network, LAN);**  
- **Mạng diện rộng (Wide Area Network, WAN);**  
- **Mạng đô thị (Metropolitan Area Network, MAN).**

Chúng tôi đã chỉ ra các đặc điểm của các nhóm mạng này, sẽ được xem xét trong chương 1 liên quan đến mạng máy tính. Cụ thể, trong các mạng cục bộ (LAN), chất lượng đường truyền giữa các nút thường cao hơn so với mạng diện rộng (WAN). Điều này được giải thích bởi các lý do khác nhau:  
- Độ dài ngắn hơn của các đường truyền (từ vài mét đến vài km), có nghĩa là ít méo tín hiệu (signal distortion) hơn và độ trễ truyền dẫn (transmission delay) thấp hơn;  
- Mức độ nhiễu bên ngoài (external interference) thấp hơn, vì các mạng cục bộ thường sử dụng cáp được đặt trong môi trường được bảo vệ đặc biệt như phòng cách âm, trong khi cáp của mạng diện rộng có thể phải đi qua các khu vực có nhiễu điện từ cao như gần đường dây điện, đường hầm liên lạc, hoặc các dây cáp ngầm;  
- Các cân nhắc kinh tế.

Chất lượng cao của đường truyền và mức độ nhiễu thấp cho phép đơn giản hóa quy trình truyền dẫn trong các công nghệ mạng cục bộ, từ bỏ các thuật toán khôi phục tín hiệu phức tạp được sử dụng trong các mạng diện rộng.

Lưu ý rằng quá trình hội tụ giữa công nghệ mạng cục bộ và mạng diện rộng đang dẫn đến việc sử dụng các giao thức chung cho cả hai loại mạng.

**Mạng MAN** được thiết kế để phục vụ lãnh thổ của một thành phố lớn — một **đô thị lớn** (metropolis) — và kết hợp các đặc điểm của cả mạng cục bộ (LAN) và mạng diện rộng (WAN). Từ loại mạng đầu tiên, chúng thừa hưởng mật độ kết nối cao của các nút cuối và tốc độ đường truyền cao, từ loại mạng sau, chúng thừa hưởng chiều dài lớn của các đường truyền.

Dựa trên các đặc điểm công nghệ, được xác định bởi **môi trường truyền dẫn (transmission medium)**, mạng máy tính được chia thành hai loại:  
- **Mạng có dây (wired networks)** — các mạng trong đó kênh truyền dẫn được xây dựng bằng cáp đồng (copper cables) hoặc cáp quang (optical cables);  
- **Mạng không dây (wireless networks)** — các mạng sử dụng các kênh truyền dẫn không dây, ví dụ: sóng vô tuyến (radio), sóng vi ba (microwave), tia hồng ngoại (infrared) hoặc kênh laser.

Bất kỳ môi trường không dây nào — dù là sóng vô tuyến, tia hồng ngoại hay tín hiệu sóng vi ba từ vệ tinh (satellite signals) — đều chịu ảnh hưởng mạnh mẽ hơn từ các yếu tố nhiễu bên ngoài (external interference) so với các đường truyền có dây. Mưa, sương mù, bão mặt trời, hoặc thiết bị hoạt động trong cùng dải tần số đều có thể gây ra sự suy giảm nghiêm trọng chất lượng kênh không dây. Do đó, công nghệ không dây phải tính đến những yếu tố này và xây dựng các hệ thống nhằm giảm thiểu tác động của chúng, ngay cả khi phải chịu sự suy giảm hiệu suất truyền tải. Đây là lý do tại sao trong mạng diện rộng và toàn cầu, khi đối mặt với ảnh hưởng chất lượng của đường truyền không dây, các công nghệ truyền dẫn có dây vẫn được ưu tiên trong nhiều ứng dụng.

Ngoài ra, còn có các đặc điểm riêng của mạng không dây, cho phép chúng được phân loại thành một nhóm riêng biệt, ví dụ như mạng di động (mobile networks); phân bổ dải tần số vô tuyến giữa các mạng cho các mục đích khác nhau như điện thoại di động hoặc mạng máy tính.

Dựa trên **phương thức chuyển mạch (switching method)**, mạng được chia thành hai loại cơ bản:  
- **Mạng chuyển mạch gói (packet-switched networks);**  
- **Mạng chuyển mạch kênh (circuit-switched networks).**

Hiện nay, trong các mạng máy tính, kỹ thuật **chuyển mạch gói (packet switching)** được sử dụng phổ biến, mặc dù kỹ thuật chuyển mạch kênh vẫn được áp dụng trong một số công nghệ cũ. Trong kỹ thuật chuyển mạch gói, các biến thể khác nhau xuất hiện, phân biệt bởi cách thức truyền tải dữ liệu:  
- **Mạng datagram**, ví dụ như Ethernet;  
- **Mạng dựa trên kết nối logic**, ví dụ như mạng IP trên TCP;  
- **Mạng dựa trên các kênh ảo (virtual channels)**, ví dụ như MPLS.

Các mạng có thể được phân loại thêm dựa trên **topology (cấu trúc liên kết)**. Các kiểu cấu trúc liên kết khác nhau được xác định bởi cách các nút kết nối với nhau. Trong phần này, chúng tôi chỉ liệt kê các ví dụ như: cấu trúc liên kết dạng bus (bus topology), vòng (ring topology) và sao (star topology).

Ngoài ra, một đặc điểm quan trọng của mạng là **dịch vụ cung cấp cho người dùng (user-provided services)**, như lưu trữ, xử lý, hoặc truyền tải dữ liệu.

**Mạng của các nhà cung cấp dịch vụ viễn thông (telecommunication operators' networks)** cung cấp dịch vụ công cộng (public services), nghĩa là bất kỳ cá nhân hoặc tổ chức nào ký hợp đồng thương mại phù hợp đều có thể trở thành khách hàng của mạng để sử dụng dịch vụ viễn thông cụ thể.

Các dịch vụ truyền thống của các nhà cung cấp viễn thông bao gồm dịch vụ điện thoại (telephony services) và cho thuê kênh liên lạc (communication channels) cho các tổ chức muốn xây dựng mạng riêng trên cơ sở các kênh này. Với sự phát triển của mạng máy tính, các nhà cung cấp viễn thông đã mở rộng đáng kể phạm vi dịch vụ của họ, bổ sung thêm các dịch vụ Internet (Internet services), mạng riêng ảo (VPN - Virtual Private Network), email, IP-telephony, cũng như phát sóng đa phương tiện (broadcasting) audio và video.

Ngày nay, Internet cũng là một trong các loại mạng được các nhà cung cấp dịch vụ viễn thông điều hành. Internet đã nhanh chóng chuyển đổi từ một mạng phục vụ một số ít cộng đồng học thuật sang một mạng công cộng toàn cầu, cung cấp bộ dịch vụ phổ biến nhất cho mọi người.


- **Mạng doanh nghiệp (corporate networks)** chỉ cung cấp dịch vụ cho nhân viên của tổ chức sở hữu mạng này. Mặc dù mạng doanh nghiệp có thể có bất kỳ quy mô nào, thông thường nó được hiểu là một mạng lớn của doanh nghiệp kết hợp các mạng cục bộ và toàn cầu của mình.

- **Mạng cá nhân (personal networks)** được sử dụng cho mục đích cá nhân. Chúng thường có ít nút, cấu trúc đơn giản và phạm vi hoạt động nhỏ (khoảng 30 mét). Các nút trong mạng cá nhân, bên cạnh máy tính bàn, có thể là điện thoại di động, máy tính bảng, hoặc laptop. Thường thì các mạng cá nhân được xây dựng dựa trên công nghệ không dây.

Dựa trên **vai trò chức năng (functional role)**, các mạng được phân thành mạng truy cập, mạng trục chính và mạng tập hợp lưu lượng (hình 4.15).  
Cụ thể:  
- **Mạng truy cập (access networks)** — đây là các mạng cung cấp kết nối truy cập cá nhân và doanh nghiệp từ nơi của họ (nhà, văn phòng) đến điểm đầu tiên trong mạng của nhà cung cấp dịch vụ hoặc mạng doanh nghiệp. Nói cách khác, đây là mạng chịu trách nhiệm mở rộng mạng toàn cầu đến nơi của khách hàng.  
- **Mạng trục chính (backbone networks)** — đây là các mạng có tốc độ cao nhất của mạng toàn cầu (global network core), kết hợp nhiều mạng truy cập vào một mạng duy nhất.  
- **Mạng tập hợp lưu lượng (aggregation networks)** — đây là các mạng tập hợp dữ liệu từ nhiều mạng truy cập để truyền chúng với lưu lượng nhỏ qua các kênh đến mạng trục chính. Các mạng này thường chỉ được sử dụng trong các mạng toàn cầu lớn, nơi chúng đóng vai trò trung gian, giúp mạng trục chính xử lý lưu lượng từ nhiều mạng truy cập một cách hiệu quả. Trong các mạng nhỏ, mạng truy cập thường tích hợp trực tiếp vào mạng trục chính.

Ngoài ra, còn có sự phân biệt giữa **mạng cơ bản (primary networks)** và **mạng phủ chồng (overlay networks)**:  
- **Mạng cơ bản** chiếm một vị trí đặc biệt. Nó bao gồm các mạng truyền dẫn hữu tuyến (wired networks), đóng vai trò là mạng hỗ trợ, cho phép tạo các mạng phủ chồng khác nhau trên cơ sở nó.  
- **Mạng phủ chồng** được tạo bằng cách sử dụng cơ sở hạ tầng của mạng cơ bản, ví dụ: các mạng cung cấp các kênh truyền dẫn riêng ảo (VPNs), các mạng điện thoại hoặc các mạng máy tính. Chúng dựa trên nguyên tắc mạng phủ chồng, trong đó các thành phần truyền dẫn vật lý của mạng cơ bản được sử dụng như một môi trường để tạo ra các kênh logic.

**Mạng phủ chồng (overlay networks)** trong phân loại này là tất cả các mạng khác, cung cấp dịch vụ cho người dùng cuối (end users) và được xây dựng dựa trên các kênh của mạng cơ bản (primary networks) — chúng "phủ chồng" lên các mạng này. Ví dụ, các mạng máy tính (computer networks), mạng điện thoại (telephone networks) và mạng truyền hình (television networks) đều được coi là mạng phủ chồng.

Cáp quang (fiber optic cables) hiện nay có đặc tính tốt nhất về khả năng truyền dữ liệu và được sử dụng cả trong các mạng có dây cục bộ (local wired networks) lẫn toàn cầu (global networks). Tuy nhiên, thuật ngữ **mạng quang học (optical networks)** thường được các chuyên gia về mạng máy tính và viễn thông sử dụng theo nghĩa hẹp như là đồng nghĩa với các mạng cơ bản (primary networks). Điều này được giải thích bởi thực tế rằng việc truyền dữ liệu qua cáp quang là cách hoạt động chính của các mạng cơ bản, trong khi việc sử dụng các phương tiện truyền dẫn khác không thể đáp ứng đầy đủ các yêu cầu hiện đại về tốc độ và độ tin cậy trong việc trao đổi thông tin giữa các nút ở xa.

**Internet** là một mạng duy nhất kết hợp gần như tất cả các mạng máy tính (computer networks) trên toàn thế giới (ngoại trừ, có lẽ, các mạng vẫn còn cách ly vì lý do bảo mật cao). Nếu áp dụng các tiêu chí phân loại đã mô tả vào Internet, có thể nói rằng đây là:  
- Một **mạng của các nhà cung cấp dịch vụ viễn thông (telecommunication operators' networks)**, cung cấp cả dịch vụ thông tin (information services) lẫn dịch vụ vận chuyển (transport services);  
- Một **mạng chuyển mạch gói (packet-switched network)**;  
- Một mạng bao gồm **mạng trục chính (backbone networks)**, **mạng tập hợp lưu lượng (aggregation networks)** và **mạng truy cập (access networks)**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/4.15.png" alt="Hình 4.15. Mạng truy cập, mạng tổng hợp lưu lượng và mạng trục" width="900">
</p>
<p align="center"><b>Hình 4.15. Mạng truy cập, mạng tổng hợp lưu lượng và mạng trục</b></p>

---

<h3 id="chuong-5-cac-dac-tinh-mang-va-chat-luong-dich-vu">CHƯƠNG 5: Các đặc tính mạng và chất lượng dịch vụ</h3>

Mạng máy tính là một hệ thống phức tạp và đắt đỏ, thực hiện các nhiệm vụ quan trọng và phục vụ một lượng lớn người dùng. Do đó, rất quan trọng để mạng không chỉ hoạt động mà còn hoạt động một cách chất lượng.

Khái niệm "chất lượng dịch vụ" (Quality of Service - QoS) có thể được hiểu rất rộng, bao gồm tất cả các đặc tính (properties) mong muốn và khả thi đối với người dùng và nhà cung cấp dịch vụ (service provider), những người hỗ trợ vận hành mạng. Để người dùng và nhà cung cấp dịch vụ có thể cụ thể hơn trong việc thảo luận các vấn đề về dịch vụ (service issues) và thiết lập mối quan hệ của họ trên cơ sở chính thức, có một số đặc tính chất lượng chung được công nhận mà mạng cung cấp. Trong chương này, chúng ta sẽ chỉ xem xét các đặc tính chất lượng của dịch vụ vận chuyển (transport services), vốn dễ dàng được hình thức hóa hơn so với các đặc tính chất lượng của dịch vụ thông tin (information services). Các đặc tính chất lượng của dịch vụ vận chuyển (transport quality attributes) phản ánh những thuộc tính (attributes) quan trọng nhất của mạng, chẳng hạn như hiệu suất (performance), độ tin cậy (reliability) và độ an toàn (security).

Một số đặc tính có thể được đánh giá định lượng và đo lường trong quá trình cung cấp dịch vụ. Người dùng và nhà cung cấp dịch vụ có thể ký kết thỏa thuận về mức độ dịch vụ (service level agreement - SLA), xác định rõ ràng các giá trị định lượng cho một số đặc tính nhất định, chẳng hạn như độ trễ (latency), băng thông (bandwidth) và tỷ lệ mất gói tin (packet loss rate).

---

#### 5.1 Các loại đặc tính

---

##### 5.1.1 Đánh giá chủ quan về chất lượng

Nếu hỏi người dùng về những gì họ mong đợi ở khái niệm dịch vụ mạng chất lượng, chúng ta có thể nhận được một loạt các câu trả lời rất rộng. Trong số đó, có thể thấy những ý kiến sau:  

- Mạng hoạt động nhanh, không có độ trễ (latency).  
- Lưu lượng (traffic) được truyền tải đáng tin cậy, dữ liệu không bị mất.  
- Dịch vụ được cung cấp liên tục theo chế độ 24 × 7 (nghĩa là 24 giờ mỗi ngày, bảy ngày một tuần).  
- Dịch vụ hỗ trợ (support service) hoạt động tốt, đưa ra các lời khuyên hữu ích và giúp giải quyết các vấn đề.  
- Dịch vụ được cung cấp theo mô hình linh hoạt (flexible scheme), tôi thích việc có thể tăng tốc độ truy cập (access speed) và mở rộng số điểm truy cập mạng (access points) bất kỳ lúc nào.  
- Nhà cung cấp không chỉ truyền tải lưu lượng của tôi mà còn bảo vệ mạng của tôi khỏi virus (viruses) và các cuộc tấn công từ kẻ xấu (malicious attacks).  
- Tôi luôn có thể kiểm soát (monitor) mạng của mình một cách nhanh chóng và không mất lưu lượng.  
- Nhà cung cấp cung cấp một loạt các dịch vụ (broad range of services), đặc biệt là ngoài truy cập Internet tiêu chuẩn, họ còn cung cấp dịch vụ lưu trữ (hosting) cho trang web cá nhân của tôi và dịch vụ thoại IP (IP telephony).  

Những đánh giá chủ quan này phản ánh mong muốn của người dùng đối với chất lượng của các dịch vụ mạng.  

---

##### 5.1.2 Yêu cầu về đặc điểm từ phía người dùng và nhà cung cấp dịch vụ

Người dùng mạng (users of the network) – mặc dù là một phía quan trọng, nhưng chỉ là một phần trong lĩnh vực kinh doanh của các mạng truyền dẫn dữ liệu (data transmission networks). Phía còn lại – nhà cung cấp dịch vụ (service providers): có thể là thương mại, nếu đây là mạng công cộng (public network), hoặc phi thương mại, nếu là mạng doanh nghiệp (corporate network). Để hai phía – người dùng và nhà cung cấp dịch vụ – có thể "nói cùng một ngôn ngữ", đã tồn tại các đặc tính định lượng được chuẩn hóa (formalized quantitative characteristics) về chất lượng dịch vụ mạng (network service quality).

Khi nhận các dịch vụ mạng (network services), người dùng sẽ đưa ra những yêu cầu nhất định đối với các đặc điểm của mạng (network characteristics). Ví dụ, người dùng có thể yêu cầu rằng tốc độ trung bình (average speed) truyền thông tin qua mạng không được thấp hơn 2 Mbit/s. Điều này có nghĩa là người dùng đã xác định dải giá trị (value range) cho tốc độ trung bình truyền thông tin qua mạng mà đối với họ biểu thị chất lượng tốt của dịch vụ (service quality).

Toàn bộ các đặc tính định lượng về chất lượng của dịch vụ vận chuyển trên mạng có thể được tổng hợp thành các mong muốn của người dùng về việc không có sự gián đoạn hay lỗi trong quá trình phục vụ (reliability – độ tin cậy), việc truyền tải thông tin với tốc độ xác định (performance – hiệu suất), và việc bảo vệ khỏi truy cập trái phép và sửa đổi thông tin (security – an toàn).

Hiển nhiên rằng nhà cung cấp dịch vụ mạng luôn cố gắng đáp ứng các yêu cầu của khách hàng, đồng thời cũng chú ý đến những đặc điểm riêng. Tuy nhiên, tồn tại một số đặc điểm quan trọng đối với nhà cung cấp mạng nhưng không quan trọng đối với người dùng. Do mạng phục vụ một số lượng lớn người dùng, các luồng thông tin (information flows) chia sẻ tài nguyên qua mạng – đường truyền (communication lines) và bộ chuyển mạch (routers and switches) – yêu cầu sự cân bằng cần thiết trong việc phân phối tài nguyên giữa các luồng cạnh tranh, để đảm bảo rằng yêu cầu của tất cả người dùng đều được tuân thủ. Nhiệm vụ này bao gồm việc lập kế hoạch (planning) và kiểm soát (control) việc sử dụng tài nguyên trong quá trình truyền tải lưu lượng thông tin của người dùng (user traffic).

Liên quan đến điều này, đối với nhà cung cấp, một trong những đặc điểm quan trọng thuộc về hiệu suất thiết bị mạng (network equipment performance) – ví dụ, hiệu suất của bộ chuyển mạch (switch performance) cho phép đánh giá được số lượng luồng người dùng mà bộ chuyển mạch có thể xử lý cùng một lúc. Đối với người dùng, hiệu suất của bộ chuyển mạch không có ý nghĩa gì nhiều – điều họ quan tâm là kết quả cuối cùng: liệu luồng dữ liệu có được xử lý chất lượng hay không.

--- 

##### 5.1.3 Đặc điểm dài hạn, trung hạn và ngắn hạn

**Đặc điểm dài hạn (Long-term characteristics)** (hoặc đặc điểm của các giải pháp thiết kế – design solution characteristics) được xác định trong các khoảng thời gian từ vài tháng đến vài năm. Ví dụ về các đặc điểm này bao gồm số lượng và sơ đồ kết nối (connection scheme) của các bộ chuyển mạch (switches) trong mạng, năng lực thông lượng (throughput capacity) của các đường truyền (communication lines), các mô hình cụ thể và các đặc điểm của thiết bị được sử dụng (network equipment characteristics). Những tham số này ảnh hưởng trực tiếp đến chất lượng của dịch vụ mạng (network service quality). Hiển nhiên rằng, việc thay thế toàn bộ hoặc nâng cấp sâu mạng lưới sẽ liên quan đến chi phí tài chính và thời gian lớn, vì vậy chúng không thể xảy ra thường xuyên, do đó, các tham số đã được lựa chọn một lần sẽ tiếp tục ảnh hưởng đến chất lượng vận hành của mạng trong một thời gian dài.

**Đặc điểm trung hạn (Medium-term characteristics)** được xác định trong các khoảng thời gian từ vài giờ đến vài ngày. Như một ví dụ, trong khoảng thời gian này, việc phục vụ một lượng lớn gói tin (packets) có thể diễn ra. Một đặc điểm trung hạn có thể là giá trị trung bình của độ trễ gói tin (average packet delay) trên mẫu dữ liệu được lấy trong vòng 24 giờ.

**Đặc điểm ngắn hạn (Short-term characteristics)** liên quan đến tốc độ xử lý các gói tin riêng lẻ (individual packet processing speed) trong phạm vi từ micro giây (microseconds) đến mili giây (milliseconds). Ví dụ, việc đệm (buffering) hoặc định tuyến (routing) một gói tin được xem là đặc điểm của nhóm này. Để phân tích và đảm bảo mức độ yêu cầu đối với các đặc điểm ngắn hạn, đã phát triển nhiều phương pháp, được gọi là phương pháp kiểm soát và ngăn ngừa tình trạng quá tải (methods of congestion control and prevention).

---

##### 5.1.4 Thỏa thuận về mức độ dịch vụ

Cơ sở chính cho sự hợp tác bình thường giữa nhà cung cấp dịch vụ (service provider) và người dùng (user) là hợp đồng (contract). Loại hợp đồng này luôn được ký kết, tuy nhiên không phải lúc nào trong đó cũng nêu rõ các yêu cầu định lượng (quantitative requirements) đối với hiệu suất của dịch vụ được cung cấp (service performance). Rất thường xuyên, dịch vụ được xác định, ví dụ, như "cung cấp quyền truy cập Internet" và tương tự.

Tuy nhiên, còn tồn tại một loại hợp đồng khác, gọi là **thỏa thuận về mức độ dịch vụ (Service Level Agreement, SLA)**. Trong loại thỏa thuận này, nhà cung cấp dịch vụ và khách hàng mô tả chất lượng của dịch vụ được cung cấp (service quality) bằng các thuật ngữ định lượng, sử dụng các đặc tính hiệu suất của mạng (network performance characteristics). Ví dụ, trong SLA có thể quy định rằng nhà cung cấp phải truyền dữ liệu của khách hàng không mất mát (without loss) và với tốc độ trung bình (average speed) mà khách hàng gửi vào mạng. Đồng thời, SLA quy định rằng thỏa thuận này chỉ có hiệu lực nếu tốc độ trung bình của lưu lượng người dùng (user traffic) không vượt quá, ví dụ, 3 Mbit/s; nếu không, nhà cung cấp có quyền không truyền tải lưu lượng vượt mức đó.

Để đảm bảo rằng mỗi bên có thể kiểm soát sự tuân thủ thỏa thuận, cần chỉ định khoảng thời gian mà tốc độ trung bình sẽ được đo lường, ví dụ: ngày, giờ hoặc giây. Ngoài ra, một SLA trở nên rõ ràng hơn khi nó chỉ định các phương tiện và phương pháp đo lường các đặc tính của mạng (network characteristics) – để không có sự bất đồng giữa nhà cung cấp và người dùng khi kiểm soát thỏa thuận.

**SLA** có thể được ký kết không chỉ giữa các nhà cung cấp dịch vụ thương mại (commercial service providers) và khách hàng mà còn giữa các bộ phận khác nhau của một công ty. Trong trường hợp này, nhà cung cấp dịch vụ mạng có thể là, ví dụ, bộ phận công nghệ thông tin (IT department), và người dùng là bộ phận sản xuất (production department).

---

#### 5.2 Hiệu suất và độ tin cậy của mạng  

---

##### 5.2.1 Mạng lý tưởng và thực tế

Trong chương 3 (mục "So sánh định lượng về độ trễ"), chúng ta đã xem xét các thành phần khác nhau của độ trễ (delay) trong mạng chuyển mạch gói (packet-switched network), cụ thể:  
- Thời gian truyền dữ liệu vào kênh (thời gian nối tiếp – serialization time);  
- Thời gian lan truyền tín hiệu (signal propagation time);  
- Thời gian chờ gói tin trong hàng đợi (queue waiting time);  
- Thời gian chuyển mạch gói tin (packet switching time).

Hai thành phần đầu tiên của độ trễ được xác định hoàn toàn bởi khả năng truyền dẫn (transmission capacity) của kênh truyền dữ liệu và là các giá trị cố định (fixed values) đối với gói tin có độ dài cố định (fixed-length packets). Hai thành phần cuối cùng phụ thuộc vào mức tải của các bộ chuyển mạch (switch load) và khả năng xử lý của chúng, và đối với gói tin có độ dài cố định, chúng thường là các giá trị thay đổi (variable values).

Giả sử rằng mạng chuyển mạch gói hoạt động lý tưởng (ideal packet-switched network) nếu nó truyền từng bit thông tin với tốc độ không đổi, bằng tốc độ lan truyền ánh sáng (speed of light) trong môi trường vật lý được sử dụng. Nói cách khác, mạng lý tưởng không tạo ra bất kỳ độ trễ bổ sung nào trong việc truyền dữ liệu ngoài các độ trễ liên quan đến kênh truyền dẫn; do đó, hai thành phần độ trễ cuối cùng bằng không.

Kết quả của việc truyền gói tin qua mạng lý tưởng như vậy được minh họa trong Hình 5.1. Trên trục trên cùng, thời gian gửi gói tin vào mạng từ nút gửi (sender node) được hiển thị, và trên trục dưới cùng, thời gian nhận gói tin tại nút đích (destination node) được biểu diễn. Vì vậy, trục trên tương ứng với tải trọng dự kiến (predicted load), còn trục dưới tương ứng với kết quả tải qua mạng.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.1.png" alt="Hình 5.1. Truyền gói tin qua mạng lý tưởng" width="900">
</p>
<p align="center"><b>Hình 5.1. Truyền gói tin qua mạng lý tưởng</b></p>

Xác định **thời gian trễ của gói tin (packet delay time)** như khoảng thời gian giữa thời điểm gửi **bit đầu tiên (first bit)** của gói tin vào kênh liên lạc (communication channel) tại nút gửi (sending node) và thời điểm bit đầu tiên của gói tin đến nút đích (destination node).  

Trên hình minh họa, các khoảng trễ được biểu diễn bằng $$d_1$$, $$d_2$$ và $$d_3$$ tương ứng với các gói tin 1, 2 và 3. Do đó, thời gian trễ của gói tin bằng với **thời gian lan truyền tín hiệu (signal propagation time)**.

Như minh họa trong hình, mạng lý tưởng (ideal network) chuyển tất cả các gói tin đến nút đích (destination node):  
- Không mất bất kỳ gói tin nào (và không làm sai lệch thông tin trong bất kỳ gói tin nào);  
- Theo đúng thứ tự mà chúng được gửi đi;  
- Với cùng một độ trễ tối thiểu có thể (ví dụ, $$d_1 = d_2$$ và v.v.).

Điều quan trọng là tất cả các khoảng thời gian giữa các gói tin liền kề được mạng giữ nguyên. Ví dụ, nếu khoảng thời gian giữa gói tin thứ nhất và thứ hai tại thời điểm gửi là $$\tau_1$$ giây, và giữa gói tin thứ hai và thứ ba là $$\tau_2$$, thì các khoảng thời gian này vẫn giữ nguyên tại nút đích.

Việc chuyển giao đáng tin cậy (reliable delivery) của tất cả các gói tin với độ trễ tối thiểu và duy trì các khoảng thời gian không đổi giữa chúng sẽ đáp ứng nhu cầu của bất kỳ người dùng mạng nào, bất kể loại lưu lượng (traffic type) của ứng dụng mà họ truyền tải qua mạng – dù đó là dịch vụ web (web service) hay điện thoại IP (IP telephony).

---

**Ghi chú**

> Cũng tồn tại các định nghĩa khác về thời gian trễ của gói tin (packet delay time). Ví dụ, giá trị này có thể được xác định là khoảng thời gian giữa thời điểm gửi **bit đầu tiên** của gói tin vào kênh liên lạc (communication channel) tại nút gửi (sending node) và thời điểm **bit cuối cùng** của gói tin đến nút đích (destination node) tương ứng. (Định nghĩa này được sử dụng trong tài liệu RFC 2679, mô tả các đặc tính trễ của gói IP – IP packet delay characteristics). Không khó để nhận thấy rằng trong định nghĩa này, thời gian trễ của gói tin bao gồm thời gian nối tiếp (serialization time).

Bây giờ, hãy xem xét những sai lệch nào so với lý tưởng có thể xảy ra trong **mạng thực tế (real network)** và những đặc tính nào có thể được sử dụng để mô tả các sai lệch này (Hình 5.2).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.2.png" alt="Hình 5.2. Truyền gói tin qua mạng thực tế" width="900">
</p>
<p align="center"><b>Hình 5.2. Truyền gói tin qua mạng thực tế</b></p>

Các gói tin được mạng chuyển đến nút đích (destination node) với các độ trễ khác nhau (different delays). Đây là một đặc điểm không thể tách rời của các mạng chuyển mạch gói (packet-switched networks).

**Tính ngẫu nhiên (random nature)** của quá trình hình thành hàng đợi dẫn đến **độ trễ ngẫu nhiên (random delay)**, trong đó độ trễ của các gói tin riêng lẻ có thể rất đáng kể, lớn hơn nhiều so với giá trị trung bình của độ trễ $$(d_1 \neq d_2 \neq d_3 \dots)$$. Sự không đồng đều của độ trễ làm thay đổi vị trí tương đối của các gói tin trong luồng đầu ra, điều này có thể gây ảnh hưởng nghiêm trọng đến chất lượng hoạt động của một số ứng dụng. Ví dụ, trong truyền tải giọng nói số (digital voice transmission), một luồng lạnh (cold stream) đại diện cho một chuỗi gói tin đều đặn cách nhau, mang dữ liệu âm thanh. Sự không đồng đều (jitter) trong khoảng thời gian giữa các gói tin trong luồng đầu ra dẫn đến **biến dạng đáng kể của giọng nói (voice distortion)**.

Các gói tin có thể được chuyển đến nút đích (destination node) **không theo thứ tự (out of order)** mà chúng được gửi đi — ví dụ, trong hình 5.2, gói tin số 4 đến nút đích trước gói tin số 3. Các tình huống như vậy thường xảy ra trong mạng dữ liệu dạng gói (packet-switched networks), khi các gói tin của một luồng được truyền qua các tuyến đường khác nhau, và vì thế, chịu sự xử lý khác nhau tại các nút mạng với các mức độ tải khác nhau. Rõ ràng, gói tin số 3 đi qua một nút mạng bị quá tải hoặc qua tuyến đường có độ trễ lớn đến mức tổng thời gian trễ của nó vượt qua thời gian trễ của gói tin số 4, dẫn đến sự sắp xếp ngược thứ tự.

Các gói tin cũng có thể **bị mất (packet loss)** trong mạng hoặc đến nút đích với dữ liệu bị sai lệch (**corrupted data**), điều này tương đương với việc mất gói tin, bởi vì hầu hết các giao thức không thể khôi phục dữ liệu bị sai lệch. Những dữ liệu này chỉ được xác định là không hợp lệ dựa trên giá trị của **checksum trong tiêu đề gói (checksum in packet header)**.

Các gói tin cũng có thể **bị nhân đôi (duplicated packets)** vì nhiều lý do, chẳng hạn như các nỗ lực truyền lại gói tin bị lỗi (retransmission) do giao thức thực hiện, nhằm đảm bảo tính tin cậy trong việc trao đổi dữ liệu.

Trong mạng thực tế, tốc độ của luồng thông tin ở đầu vào nút đích có thể khác với tốc độ luồng đầu ra, hướng vào mạng từ nút gửi (sender node). Nguyên nhân chính là các độ trễ xảy ra tại hàng đợi và lộ trình mạng. Như trong ví dụ trong hình 5.2, **tốc độ trung bình của luồng đầu ra (average outgoing stream rate)** bị giảm do mất gói tin số 5. Càng nhiều gói tin bị mất hoặc sai lệch xảy ra trong mạng, tốc độ luồng thông tin trung bình càng giảm.

Để đánh giá hiệu suất của mạng thực tế, người ta thường sử dụng các **đặc tính hiệu suất mạng (network performance metrics)**. Một số trong số đó liên quan đến tốc độ và độ trễ, một số khác liên quan đến mất mát và sai lệch, hoặc đến tính bảo mật của việc truyền dữ liệu. Tầm quan trọng tương đối của từng đặc tính phụ thuộc vào loại ứng dụng, lưu lượng mà mạng cần xử lý. Chẳng hạn, có các ứng dụng đặc biệt nhạy cảm với độ trễ, nhưng không nhạy cảm với mất mát gói tin, ví dụ: truyền phát giọng nói qua các dịch vụ thoại qua mạng (VoIP - Voice over IP). Vì vậy, trong từng trường hợp cụ thể, cần xác định các đặc tính mạng phù hợp nhất để phản ánh đúng ảnh hưởng của các yếu tố “không mong muốn” lên công việc của ứng dụng.

---

##### 5.2.2 Đánh giá thống kê các đặc tính mạng (Statistical Evaluation of Network Characteristics)

Để đánh giá các đặc tính của **quá trình ngẫu nhiên (random processes)**, các phương pháp thống kê (statistical methods) được sử dụng, bởi vì bản chất của các quá trình truyền gói tin qua mạng là ngẫu nhiên. Chính các đặc tính hiệu suất mạng, chẳng hạn như **độ trễ gói tin (packet delay)**, là những **biến ngẫu nhiên (random variables)**. 

Các đặc tính thống kê (statistical characteristics) cho phép phát hiện các quy luật trong hành vi của mạng, mà chỉ có thể xuất hiện ổn định trong các khoảng thời gian dài. Khi nói đến một khoảng thời gian dài (long period of time), ý chúng ta là một khoảng thời gian lớn hơn hàng triệu lần so với **thời gian truyền một gói tin (packet transmission time)**, vốn trong mạng hiện đại được đo bằng micro giây.

Ví dụ, thời gian truyền một gói tin qua **Gigabit Ethernet** là khoảng 10 micro giây. Vì vậy, để thu được các kết quả ổn định (reliable results), cần quan sát hành vi của mạng ít nhất trong vài phút, và tốt nhất là trong vài giờ.

Công cụ chính trong thống kê (statistics) là **biểu đồ tần suất (histogram)** của phân phối giá trị ngẫu nhiên được đánh giá. Hãy xem xét, ví dụ, biểu đồ tần suất của **độ trễ gói tin (packet delay)**. Giả sử rằng chúng ta đã đo được độ trễ truyền tải của mỗi gói tin trong 2600 gói tin, được truyền giữa hai nút trong mạng, và lưu lại các kết quả đo được. Mỗi kết quả đo là một **giá trị đơn lẻ của biến ngẫu nhiên (single value of a random variable)**, và tất cả chúng tạo thành **mẫu (sample)** các giá trị của biến ngẫu nhiên.

Để xây dựng biểu đồ tần suất phân phối, chúng ta cần chia toàn bộ phạm vi các giá trị đo được thành nhiều khoảng (intervals) và đếm số lần các giá trị thuộc vào từng khoảng. Giả sử tất cả các giá trị độ trễ nằm trong khoảng 20–90 ms. Ta chia phạm vi này thành bảy khoảng, mỗi khoảng rộng 10 ms. Trong từng khoảng này, bắt đầu từ 20–30 ms và tiếp tục như vậy, số lượng gói tin là 100 ($$n_1$$), 200 ($$n_2$$), 300 ($$n_3$$), 300 ($$n_4$$), 400 ($$n_5$$), 800 ($$n_6$$) và 500 ($$n_7$$) gói tin tương ứng.

Biểu diễn các số liệu này dưới dạng các cột ngang, chúng ta thu được biểu đồ tần suất (histogram) được trình bày trong hình 5.3, giúp mô tả ngắn gọn các đặc tính thống kê của độ trễ trong 2600 gói tin.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.3.png" alt="Hình 5.3. Biểu đồ phân bố độ trễ" width="900">
</p>
<p align="center"><b>Hình 5.3. Biểu đồ phân bố độ trễ</b></p>

**Biểu đồ tần suất của độ trễ (Delay Histogram)** cung cấp một cái nhìn rõ ràng về hiệu suất của mạng (network performance). Từ đó, có thể đánh giá mức độ trễ nào có khả năng xảy ra cao hơn và mức độ nào ít xảy ra hơn. Khoảng thời gian càng dài (observation period) để thu thập dữ liệu nhằm xây dựng biểu đồ tần suất, thì dự đoán về hành vi của mạng trong tương lai sẽ càng chính xác hơn.

Ví dụ, sử dụng biểu đồ tần suất trong hình 5.3, có thể nói rằng, trong tương lai, khi đo độ trễ của các gói tin, 65% số gói tin sẽ có độ trễ vượt quá 60 ms. Để đưa ra đánh giá này, chúng ta đã cộng tổng số gói tin mà độ trễ của chúng rơi vào tất cả các khoảng vượt quá 60 ms (1700 phép đo) và chia số này cho tổng số gói tin (2600 phép đo).

Dự đoán như vậy có chính xác không? Chúng ta đã thu thập đủ dữ liệu thực nghiệm để đưa ra các dự đoán đáng tin cậy hay chưa? **Thống kê (statistics)** cho phép đánh giá điều này, tuy nhiên, ở đây chúng ta sẽ không xem xét vấn đề thú vị này (những ai quan tâm có thể tham khảo các sách chuyên ngành về thống kê).

Khi tăng số lượng khoảng (intervals) và thời gian quan sát, biểu đồ tần suất (histogram) dần chuyển thành một hàm liên tục, được gọi là **mật độ phân phối (probability density function)** của độ trễ truyền tải gói tin (được biểu thị bằng đường nét đứt). Theo lý thuyết xác suất (probability theory), xác suất để giá trị của biến ngẫu nhiên (random variable) rơi vào một khoảng nhất định bằng với tích phân của mật độ phân phối (density integral) từ giới hạn dưới đến giới hạn trên của khoảng này. Như vậy, giá trị xác suất của độ trễ gói tin có thể được tính toán.

Biểu đồ tần suất cung cấp một hình ảnh trực quan về các đặc tính liên quan, nhưng thường thì các **đánh giá thống kê (statistical evaluations)** của đặc tính này được sử dụng nhiều hơn. Những đánh giá này cho phép biểu diễn đặc tính dưới dạng một giá trị duy nhất (single number) dựa trên việc xử lý toán học các mẫu dữ liệu hiện có.

Để mô tả các đặc tính mạng, các **đánh giá thống kê (statistical evaluations)** sau đây được sử dụng:

- **Giá trị trung bình (Mean, $$D$$)** được tính bằng tổng tất cả các giá trị của biến ngẫu nhiên ($$d_i$$) chia cho tổng số lần đo ($$N$$):
  
$$
  D = \frac{\sum d_i}{N}
$$

  Ví dụ, đối với dữ liệu được trình bày trong hình 5.3, giá trị trung bình là:

$$
  D = \frac{(100 \times 25 + 200 \times 35 + 300 \times 45 + 300 \times 55 + 400 \times 65 + 800 \times 75 + 500 \times 85)}{2600} = 64,6 \text{ ms}
$$

  (Trong tính toán này, các giá trị trung bình của các khoảng đã được sử dụng).

- **Median (Trung vị):** Trung vị là giá trị chia mẫu sắp xếp (ordered sample) thành hai phần bằng nhau, sao cho số lần đo có giá trị nhỏ hơn hoặc bằng trung vị bằng với số lần đo có giá trị lớn hơn hoặc bằng trung vị. Trong ví dụ này, trung vị là 70 ms, bởi vì số lần đo nhỏ hơn hoặc bằng 70 ms là 1300, và số lần đo lớn hơn hoặc bằng 70 ms cũng là 1300.

- **Độ lệch chuẩn (Standard Deviation) hoặc phương sai ($$J$$):** Độ lệch chuẩn biểu thị độ lệch trung bình của mỗi lần đo khỏi giá trị trung bình của biến ngẫu nhiên:

$$
  J = \sqrt{\frac{\sum (d_i - D)^2}{N - 1}}
$$

  Rõ ràng, nếu không có sự khác biệt giữa các độ trễ (tất cả $$d_i = D$$), phương sai sẽ bằng 0 ($$J = 0$$).

- **Hệ số biến thiên (Coefficient of Variation, $$CV$$):** Đây là một đại lượng không thứ nguyên, biểu thị tỷ lệ giữa độ lệch chuẩn và giá trị trung bình của biến ngẫu nhiên:

$$
  CV = \frac{J}{D}
$$

Hệ số biến thiên (Coefficient of Variation, $$CV$$) đặc trưng cho biến ngẫu nhiên mà không phụ thuộc vào giá trị tuyệt đối của nó. Ví dụ, một luồng gói tin lý tưởng, được phân bố đều, luôn có hệ số biến thiên bằng 0. Hệ số biến thiên của độ trễ gói tin bằng 1 biểu thị **luồng giao thông xung nhịp (pulsating traffic)**, khi độ lệch chuẩn của các khoảng bằng giá trị trung bình của khoảng thời gian giữa các gói tin.

- **Phân vị (Quantile, Percentile):** Đây là giá trị của biến ngẫu nhiên, chia mẫu sắp xếp thành hai phần sao cho tỷ lệ phần trăm các lần đo có giá trị nhỏ hơn hoặc bằng phân vị bằng với tỷ lệ phần trăm đã định trước. Trong định nghĩa này, một con số đã định trước được đưa ra: tỷ lệ phần trăm đã định trước, và các giá trị trong mẫu được so sánh với giá trị phân vị đó. Không khó để nhận ra rằng **phân vị 50% (50th percentile)** trùng với trung vị (median). Đối với các đặc tính mạng, các phân vị với giá trị phần trăm cao hơn thường được sử dụng, chẳng hạn **phân vị 99% (99th percentile)**, cho phép đánh giá các giá trị đặc biệt cao nhất của đặc tính được đo lường.

Các phương pháp thống kê (statistical methods) được áp dụng để phân tích các đặc tính hiệu suất mạng khác nhau, chẳng hạn như: tốc độ truyền dữ liệu (data transmission speed), độ trễ (delay), thời gian chờ trong bộ đệm (buffer delay), thời gian chuyển mạch (switching time), số lượng gói tin bị mất (packet loss), v.v., vì tất cả các yếu tố này đều là biến ngẫu nhiên (random variables).

**Thứ tự thực hiện các phép đo (Measurement sequence):** Được khuyến nghị tiến hành tại các thời điểm ngẫu nhiên, tuân theo phân phối Poisson (Poisson distribution). Thứ tự chọn ngẫu nhiên như vậy giúp tránh sự đồng bộ hóa không mong muốn giữa các phép đo và bất kỳ biến động tuần hoàn nào trong hành vi của mạng, điều này có thể làm thay đổi đáng kể các kết quả đo lường quan sát được.

---

##### 5.2.3 Đo lường chủ động và thụ động trong mạng (Active and Passive Measurements in a Network)

Để đánh giá một số đặc tính hiệu suất của mạng (network performance characteristics), cần tiến hành các phép đo đối với luồng gói tin đến một giao diện cụ thể của thiết bị mạng. Có hai loại phép đo trong mạng: **chủ động (active)** và **thụ động (passive)**.

---

- **Đo lường chủ động (Active Measurements):** Dựa trên việc tạo ra tại nút nguồn (source node) các gói tin đặc biệt, gọi là **gói đo lường (measurement packets)**. Các gói tin này cần phải đi qua mạng giống như các gói tin thông thường mà đặc tính của chúng ta muốn đánh giá. Các phép đo tại nút đích (destination node) được thực hiện dựa trên trình tự của các gói đo lường.

---

Hình 5.4 minh họa ý tưởng của phép đo chủ động. Giả sử cần đo **độ trễ gói tin (packet delay)** đối với các gói tin được truyền từ máy khách của ứng dụng $$A$$ đến máy chủ của ứng dụng $$A$$ qua mạng. Thay vì sử dụng các gói tin của ứng dụng thực để đo độ trễ, chúng ta thiết lập thêm hai máy chủ bổ sung: **máy chủ phát sinh (traffic generator server)** và **máy chủ đo lường (measurement server)**. Máy chủ phát sinh tạo ra các gói đo lường (được biểu diễn trên hình với màu xám), trong khi máy chủ đo lường thực hiện đo độ trễ của các gói này.

Để các giá trị đo được gần với giá trị độ trễ của các gói tin ứng dụng $$A$$, cần đảm bảo rằng các gói đo lường đi qua mạng theo cùng lộ trình mà các gói tin của ứng dụng $$A$$ thực hiện. Trong ví dụ này, mục tiêu này được đạt được thông qua việc kết nối các máy chủ bổ sung đến cùng các switch $$S_1$$ và $$S_2$$, nơi các nút gốc được kết nối.

Ngoài ra, cần đảm bảo rằng các gói đo lường giống với các gói tin gốc nhất có thể — về kích thước (size), đặc điểm (attributes), và các thông tin được chèn vào tiêu đề gói tin (headers).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.4.png" alt="Hình 5.4. Sơ đồ đo lường chủ động" width="900">
</p>
<p align="center"><b>Hình 5.4. Sơ đồ đo lường chủ động</b></p>

Các gói đo lường (measurement packets) không nên được tạo ra quá thường xuyên, nếu không tải trọng của mạng (network load) có thể thay đổi đáng kể, và kết quả đo có thể khác với những kết quả thu được khi không có gói đo lường. Nói cách khác, các phép đo không được làm thay đổi điều kiện hoạt động của mạng. Thông thường, tần suất phát sinh gói đo lường không vượt quá 20–50 gói mỗi giây.

Một câu hỏi tự nhiên được đặt ra: tại sao cần phải giải quyết nhiều vấn đề như vậy — bố trí thêm thiết bị, tạo các điều kiện đặc biệt cho gói đo lường sao cho gần giống với điều kiện xử lý các gói tin thực tế, đồng thời không làm thay đổi tải trọng của mạng? Liệu có đơn giản hơn không nếu đo các tham số trên các gói tin thực tế? Câu trả lời nằm ở chỗ: **phương pháp chủ động (active scheme)** giúp đơn giản hóa quá trình đo lường và cho phép đạt được **độ chính xác cao (high accuracy)**.

- Thứ nhất, vì máy chủ phát sinh (traffic generator server) tạo ra các gói tin đặc biệt dành cho phép đo, nên có thể dễ dàng thêm thông tin cần thiết vào phần dữ liệu điều khiển, chẳng hạn như **dấu thời gian (timestamp)** khi gửi gói tin, để máy chủ đo lường (measurement server) sử dụng thông tin này trong tính toán độ trễ.

- Thứ hai, để các phép đo độ trễ được chính xác, cần có sự đồng bộ hóa (synchronization) tốt giữa máy chủ phát sinh và máy chủ đo lường. Vì các phương pháp đo lường chủ động sử dụng các nút chuyên biệt, việc đồng bộ hóa này dễ dàng hơn nhiều so với việc đồng bộ hóa giữa máy khách và máy chủ của ứng dụng $$A$$, vốn thường chỉ được cài đặt trên các máy tính thông thường.

- Thứ ba, trong một số trường hợp, việc thực hiện các phép đo trên các gói tin thực tế không khả thi, ví dụ: không thể truy cập vào các máy tính đang chạy ứng dụng hoặc không thể thay đổi chương trình ứng dụng để thực hiện các phép đo cần thiết.

- Thứ tư, các vấn đề liên quan đến quyền truy cập (access control) và khả năng hoạt động của nền tảng (platform capability) thường được giải quyết tốt hơn khi sử dụng các thiết bị chuyên dụng được tối ưu hóa cho các phép đo, thay vì phải thực hiện các thay đổi trực tiếp lên ứng dụng (ví dụ: thay đổi hàng đợi tại máy chủ hoặc xử lý trung tâm).

Tuy nhiên, các ưu điểm của **phương pháp đo lường chủ động (active measurement scheme)** không phải lúc nào cũng tuyệt đối. Trong một số tình huống, **phương pháp đo lường thụ động (passive measurement scheme)** được ưu tiên hơn.

---

- **Đo lường thụ động (Passive Measurements):** Dựa trên việc đo các đặc tính của **luồng dữ liệu thực tế (real traffic)** (hình 5.5).

---

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.5.png" alt="Hình 5.5. Sơ đồ đo lường thụ động" width="900">
</p>
<p align="center"><b>Hình 5.5. Sơ đồ đo lường thụ động</b></p>

Khi trình bày các lập luận ủng hộ phương pháp **đo lường chủ động (active measurement scheme)**, chúng ta thực chất đã mô tả các vấn đề phải đối mặt khi sử dụng **phương pháp đo lường thụ động (passive measurement scheme)**: sự phức tạp của việc đồng bộ hóa giữa máy khách và máy chủ (synchronization between client and server), các độ trễ bổ sung và không xác định được gây ra bởi hệ điều hành đa nhiệm (multi-programming operating systems) của các máy tính này, cũng như việc không có trường dành cho **dấu thời gian (timestamp)** trong tiêu đề của các gói tin ứng dụng khi truyền qua mạng.

Một phần những vấn đề này được giải quyết thông qua việc sử dụng một **máy chủ đo lường riêng biệt (dedicated measurement server)**. Máy chủ này nhận luồng gói tin giống như một trong các nút tham gia trao đổi gói tin (như trường hợp khi máy chủ đo lường được cài đặt song song với máy chủ của ứng dụng $$A$$). Để máy chủ đo lường nhận được cùng một luồng gói tin đầu vào như nút gốc, người ta thường sử dụng phương pháp **sao chép lưu lượng đo lường (traffic mirroring)** trên cổng mà máy chủ đo lường được kết nối. Chức năng này, được gọi là **port mirroring (sao chép cổng)**, được hỗ trợ bởi nhiều bộ chuyển mạch mạng cục bộ (LAN switches). Máy chủ đo lường hoạt động dưới sự quản lý của một hệ điều hành được tối ưu hóa đặc biệt cho việc thực hiện các phép đo thời gian chính xác.

Giải quyết vấn đề đồng bộ hóa (synchronization) phức tạp hơn. Một số giao thức truyền dấu thời gian vào các trường dữ liệu điều khiển (control fields), nhờ đó, nếu ứng dụng $$A$$ sử dụng giao thức như vậy, một phần vấn đề có thể được giải quyết. Tuy nhiên, ngay cả trong trường hợp này, vấn đề về độ chính xác của hệ thống thời gian trên máy tính khách và ứng dụng $$A$$ vẫn còn, vì độ chính xác thường không cao. Do đó, trong chế độ đo lường thụ động, chỉ các đặc tính không yêu cầu đồng bộ hóa giữa bộ phát và bộ nhận (transmitter and receiver) mới được đo lường, chẳng hạn như **tỷ lệ mất gói tin (packet loss rate)**.

Một cách tiếp cận khác trong phương pháp đo lường thụ động là không sử dụng máy chủ đo lường riêng biệt. Một số ứng dụng tự đo lường độ trễ của các gói tin đến, ví dụ: các ứng dụng **IP-telephony (điện thoại qua IP)** và **video conferencing (hội nghị truyền hình)**, nơi thông tin về độ trễ gói tin giúp xác định khả năng xảy ra các vấn đề ảnh hưởng đến chất lượng hoạt động của ứng dụng.

---

##### 5.2.4 Các đặc tính về độ trễ của gói tin (Packet Delay Characteristics):

Để đánh giá hiệu suất của mạng (network performance), các đặc tính độ trễ sau đây được sử dụng:

- Độ trễ một chiều của gói tin (**One-Way Delay Metric, OWD**);
- Độ biến thiên của độ trễ gói tin (**Packet Delay Variation**);
- Thời gian phản hồi của mạng (**Network Reaction Time**);
- Thời gian quay vòng của gói tin (**Packet Round-Trip Time**).

> **Định nghĩa độ trễ một chiều của gói tin (One-Way Delay Metric):** Đây là khoảng thời gian giữa thời điểm bit đầu tiên của gói tin được đưa vào đường truyền tại nút gửi (sender node) và thời điểm bit cuối cùng của gói tin được nhận tại nút đích (receiver node).

Khi xác định loại gói tin, cần hiểu rằng mỗi gói tin có một tập hợp các thuộc tính được xác định trước, chẳng hạn như kích thước gói tin (packet size), loại ứng dụng tạo ra gói tin, giao thức tầng vận chuyển (transport layer protocol) truyền gói tin, và một số thuộc tính khác.

Do định nghĩa này có tính đến thời gian đệm (serialization) của gói tin tại nút nhận, độ trễ phụ thuộc vào kích thước gói tin. Để có được các kết quả so sánh được, cần chỉ định một kích thước gói tin nhất định khi xác định loại gói tin. Việc này sẽ giúp đơn giản hóa phép đo thời gian đệm của gói tin, vì có thể đo thời gian hoàn tất ghi dữ liệu gói tin vào bộ đệm của hệ điều hành. Ngoài ra, nếu chỉ có một gói tin được nhận, không thể xác định rõ liệu gói tin đó có thuộc loại cần phân tích hay không.

**Biến thiên độ trễ (Delay Variation):** Đối với một số ứng dụng, biến thiên độ trễ của gói tin, còn gọi là **jitter**, đóng vai trò rất quan trọng. Ví dụ, trong phát lại video clip, bản thân việc gói tin bị trễ không quá đáng kể — chẳng hạn, nếu các gói tin bị trễ đúng 10 giây, chất lượng phát lại vẫn không giảm sút vì video được phát liên tục theo thời gian đã định trước. Tuy nhiên, nếu biến thiên độ trễ không ổn định và dao động từ vài mili giây đến vài giây trong một khoảng thời gian nhất định, chất lượng phát lại sẽ bị giảm sút rõ rệt. Trong trường hợp như vậy, cần phải có bộ đệm dự đoán trước để bù đắp biến thiên độ trễ vượt ngưỡng.

> **Định nghĩa độ biến thiên độ trễ:** Độ biến thiên độ trễ được xác định theo chuẩn như là sự khác biệt giữa độ trễ một chiều của các gói tin trong một khoảng thời gian đo lường $$T$$.

Cũng giống như đối với độ trễ một chiều (**One-Way Delay**), loại gói tin có thể được xác định bởi bất kỳ thuộc tính nào, với điều kiện kích thước của cả hai gói tin phải giống nhau. Việc lựa chọn cặp gói tin trong khoảng thời gian đo lường $$T$$ cần được thực hiện theo một quy tắc đã được định trước.

Ví dụ, các cặp gói tin có thể được hình thành từ tất cả các gói tin liên tiếp nhận được trong khoảng thời gian. Một ví dụ khác là việc chọn gói tin theo các số thứ tự cụ thể trong dãy các gói nhận được, chẳng hạn các gói có số thứ tự 1, 5, 10, 15, v.v.

> **Thời gian phản hồi của mạng (Network Reaction Time)** được định nghĩa là khoảng thời gian giữa việc gửi một yêu cầu của người dùng đến một dịch vụ mạng nào đó và nhận được phản hồi cho yêu cầu đó.

Thời gian phản hồi của mạng là một đặc tính tích hợp phản ánh hiệu suất của mạng từ quan điểm của người dùng. Chính đặc tính này là điều người dùng nghĩ đến khi họ nói: "Hôm nay mạng hoạt động chậm." Thời gian phản hồi có thể được biểu diễn như tổng của nhiều thành phần, ví dụ (hình 5.6):

- Thời gian chuẩn bị yêu cầu trên máy tính khách (**$$t_{\text{client1}}$$**);
- Thời gian truyền yêu cầu từ máy khách đến máy chủ qua mạng (**$$t_{\text{net}}$$**);
- Thời gian xử lý yêu cầu trên máy chủ (**$$t_{\text{server}}$$**);
- Thời gian truyền phản hồi từ máy chủ đến máy khách qua mạng (lại là **$$t_{\text{net}}$$**);
- Thời gian xử lý phản hồi nhận được từ máy chủ trên máy tính khách (**$$t_{\text{client2}}$$**).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.6.png" alt="Hình 5.6. Thời gian phản hồi và thời gian vòng lặp" width="900">
</p>
<p align="center"><b>Hình 5.6. Thời gian phản hồi và thời gian vòng lặp</b></p>


Thời gian phản hồi của mạng (**Network Reaction Time**) đặc trưng cho toàn bộ mạng, bao gồm cả chất lượng hoạt động của phần cứng và phần mềm của các máy chủ. Để đánh giá riêng khả năng vận chuyển của mạng, một đặc tính khác được sử dụng — **thời gian quay vòng gói tin (Round Trip Time, RTT)**.

> **Thời gian quay vòng gói tin (RTT):** Được định nghĩa là khoảng thời gian giữa việc gửi **bit đầu tiên (first bit)** của gói tin thuộc một loại xác định từ nút gửi đến nút nhận và nhận lại **bit cuối cùng (last bit)** của gói tin này tại nút gửi, sau khi gói tin đã được nhận và gửi lại từ nút nhận.

Thời gian quay vòng gói tin là một thành phần của thời gian phản hồi mạng. Đây là thời gian "thuần túy" dành cho việc truyền dữ liệu từ nút gửi đến nút nhận và quay trở lại, không tính đến thời gian cần thiết tại nút nhận để chuẩn bị phản hồi:

$$
RTT = 2 \times t_{\text{net}}
$$

RTT rất thuận tiện để đo lường các đặc tính mạng, vì để đo RTT không cần sự đồng bộ hóa giữa nút gửi và nút nhận. Nút gửi chỉ cần chèn **dấu thời gian (timestamp)** vào gói tin khi gửi, và khi gói tin quay lại, so sánh dấu thời gian đó với thời gian hệ thống hiện tại. Tuy nhiên, giá trị RTT chỉ cung cấp thông tin tổng hợp, không phân tách rõ ràng các thành phần độ trễ, điều này có thể gây khó khăn trong việc xác định chính xác vấn đề trong mạng.

Đối với mỗi đặc tính được xem xét, các giá trị thường được tính toán dựa trên các đánh giá thống kê (**statistical evaluations**), bao gồm giá trị lớn nhất (**maximum**), nhỏ nhất (**minimum**), giá trị trung bình (**mean**), trung vị (**median**), và phân vị (**quantile**).

---

##### 5.2.5 Đặc tính tốc độ truyền dữ liệu (Information Rate Characteristics):

**Tốc độ truyền dữ liệu (Information Rate):** Được đo trên một khoảng thời gian cụ thể và tính bằng cách chia khối lượng dữ liệu được truyền trong khoảng thời gian đó cho độ dài của khoảng thời gian. Tốc độ này có thể được đo bằng khung tin (**frames**), gói tin (**packets**), bit, hoặc byte trên giây. Đặc tính này luôn được hiểu là **tốc độ trung bình (average rate)**. Tuy nhiên, tùy thuộc vào độ dài của khoảng thời gian đo, tốc độ này thường được phân biệt thành hai khái niệm: **tốc độ trung bình (Sustained Information Rate, SIR)** và **tốc độ tức thời (Instantaneous Information Rate, IIR)**.

- **Tốc độ trung bình (Sustained Information Rate, SIR):** Là một đặc tính trung hạn, được tính trên một khoảng thời gian đủ lớn để mô tả hành vi bền vững của một biến ngẫu nhiên, trong trường hợp này là tốc độ. Giá trị này cần được sử dụng cùng với tham số mô tả **chu kỳ đo (measurement period)**, ví dụ: 10 giây. Điều này có nghĩa là tốc độ của luồng dữ liệu được tính mỗi 10 giây. Nếu các phép đo như vậy không được thực hiện, người dùng có thể gặp khó khăn khi yêu cầu nhà cung cấp dịch vụ bồi thường trong một số tình huống tranh chấp. Ví dụ: nếu nhà cung cấp không truyền đủ lưu lượng trong một ngày cụ thể, nhưng lại bù đắp trong những ngày khác và tốc độ trung bình hàng tháng đạt chuẩn, thì người dùng không thể yêu cầu bồi thường.

- **Tốc độ tức thời (Instantaneous Information Rate, IIR):** Là một đặc tính ngắn hạn, được tính tại một thời điểm cụ thể. Giá trị này bằng tốc độ trung bình trong một khoảng thời gian rất ngắn, ví dụ: trong khoảng thời gian truyền một gói tin. Trên tầng vật lý của mạng (**physical layer protocol**), tốc độ tức thời thường là một hằng số, chẳng hạn: tốc độ truyền bit của gói tin 1 **Gigabit Ethernet** là 1 Gbps.

**Lưu ý:**

> Trong các nội dung trên, chúng ta đã thảo luận về tốc độ của một luồng dữ liệu cụ thể, nhưng cần phân biệt với **tốc độ của từng gói tin riêng lẻ (per-packet rate)**. Ví dụ, khi đo tốc độ trung bình trên một khoảng thời gian dài, số lượng gói tin được truyền là yếu tố quyết định tốc độ. Tuy nhiên, nếu tốc độ truyền của từng gói tin khác nhau trên các kênh mạng, thì cần phân tích thêm khả năng của kênh.

**Biến thiên của tốc độ tức thời (Instantaneous Rate Variation):** Đây là mức độ chênh lệch giữa các giá trị tốc độ tức thời so với tốc độ trung bình, đặc trưng cho sự không đồng đều của lưu lượng mạng.

Hình 5.7 minh họa một biểu đồ thực tế về sự thay đổi của **tốc độ lưu lượng đầu ra (outgoing traffic rate)**, được truyền từ một khuôn viên trường đại học đến các máy chủ của nhà cung cấp dịch vụ trong một ngày làm việc (đường dưới biểu diễn lưu lượng đầu vào). Trên biểu đồ có các đoạn có hình dạng giống như các **xung nhịp (pulsations)**, được đánh dấu là xung nhịp 1 và xung nhịp 2. Mỗi xung nhịp được đặc trưng bởi **chu kỳ xung nhịp (pulsation period)** và **tốc độ đỉnh (Peak Information Rate, PIR)**.

**Tốc độ đỉnh của dữ liệu (Peak Information Rate, PIR):** Là tốc độ trung bình trong chu kỳ xung nhịp. Đây là một đặc tính ngắn hạn, phản ánh khả năng của mạng trong việc xử lý các tải cao điểm (peak loads), đặc trưng cho lưu lượng mạng có tính chất xung nhịp và có thể dẫn đến hiện tượng **tắc nghẽn (congestion)**. Nếu khoảng thời gian trung bình được chọn đủ nhỏ để xác định tốc độ đỉnh, có thể nói rằng tốc độ đỉnh là giới hạn trên được đặt trước cho **tốc độ tức thời của lưu lượng người dùng (instantaneous user traffic rate)**.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.7.png" alt="Hình 5.7. Tốc độ truyền tải lưu lượng. Dao động" width="900">
</p>
<p align="center"><b>Hình 5.7. Tốc độ truyền tải lưu lượng. Dao động</b></p>

**Độ lớn của xung nhịp (Burst Size, $$B$$)** (thường được ký hiệu là $$B$$ từ tiếng Anh "Burst") được sử dụng để đánh giá dung lượng bộ đệm của bộ chuyển mạch (switch buffer capacity) cần thiết để lưu trữ dữ liệu trong quá trình tắc nghẽn. Độ lớn của xung nhịp bằng tổng khối lượng dữ liệu được gửi tới bộ chuyển mạch trong thời gian của chu kỳ xung nhịp $$T$$, với tốc độ đỉnh (**PIR**):

$$
B = PIR \times T
$$

Một đặc tính khác của sự không đồng đều trong truyền tải dữ liệu là **hệ số xung nhịp lưu lượng (Traffic Burstiness Coefficient)** — đây là tỷ lệ giữa tốc độ đỉnh tối đa (**maximum peak rate**) và tốc độ trung bình (**average rate**) của lưu lượng, được đo trên một khoảng thời gian dài. Sự không đồng đều về độ dài của các chu kỳ thời gian làm cho hệ số xung nhịp trở thành một đặc tính chất lượng (**qualitative characteristic**) của lưu lượng.

Các đặc tính tốc độ truyền dữ liệu đóng vai trò quan trọng trong mối quan hệ giữa nhà cung cấp dịch vụ và khách hàng. Trong **thỏa thuận cấp độ dịch vụ (Service Level Agreement, SLA)**, nhà cung cấp chỉ định các giới hạn đối với lưu lượng được truyền bởi khách hàng, chẳng hạn như **tốc độ trung bình tối đa (maximum sustained rate)** và **tốc độ đỉnh tối đa (maximum peak rate)** trong các khoảng thời gian trung bình đã xác định. Đôi khi trong SLA, khoảng thời gian trung bình được đề cập có thể dài hơn, cho phép các giới hạn tốc độ được xác định linh hoạt hơn, ví dụ: trên các chu kỳ thời gian ngắn hơn hoặc dài hơn, điều này giúp mô tả chính xác hơn quá trình truyền tải lưu lượng xung nhịp qua mạng.

Hình 5.8 minh họa các giới hạn của nhà cung cấp đối với **tốc độ trung bình tối đa cho phép (maximum allowable sustained rate)** và **tốc độ đỉnh tối đa cho phép (maximum allowable peak rate)** của lưu lượng người dùng.

Tốc độ truyền dữ liệu có thể được đo giữa bất kỳ hai nút hoặc điểm nào trong mạng, ví dụ: giữa máy khách và máy chủ, hoặc giữa các cổng đầu vào và đầu ra của một bộ định tuyến.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.8.png" alt = "Hình 5.8. Hạn chế của nhà cung cấp dịch vụ về tốc độ lưu lượng người dùng" width="900">
</p>
<p align="center"><b>Hình 5.8. Hạn chế của nhà cung cấp dịch vụ về tốc độ lưu lượng người dùng</b></p>

---

##### 5.2.6 Đặc tính độ tin cậy của mạng (Network Reliability Characteristics)

Trong trường hợp một gói tin (packet) không đến được nút đích trong một khoảng thời gian đủ dài (giá trị cụ thể do nhà phát triển hệ thống đo lường xác định), gói tin này được coi là bị mất (lost).

Là một đặc tính để đo mức độ mất mát gói tin, **tỷ lệ gói tin mất (packet loss ratio)**, ký hiệu là $$ L $$, được tính bằng tỷ lệ giữa số lượng gói tin mất $$ N_L $$ so với tổng số gói tin được truyền đi $$ N $$:

$$
L = \frac{N_L}{N}.
$$

Có thể sử dụng các đặc tính tương tự, không dựa trên số lượng gói tin mất và truyền, mà dựa trên khối lượng dữ liệu (data volume) được chứa trong các gói tin này.

Để mô tả độ tin cậy (reliability) của các thiết bị riêng lẻ, thường sử dụng các chỉ số độ tin cậy như:
- **Thời gian trung bình giữa các lần hỏng hóc (Mean Time Between Failures - MTBF)**;
- **Xác suất xảy ra lỗi (Probability of Failure)**;
- **Cường độ lỗi (Failure Intensity)**.

Tuy nhiên, các chỉ số này chỉ phù hợp để đánh giá độ tin cậy của các phần tử hoặc thiết bị đơn giản, nơi mà lỗi ở bất kỳ thành phần nào sẽ dẫn đến trạng thái không hoạt động (inoperable). Các hệ thống phức tạp (complex systems), bao gồm nhiều thành phần, có thể duy trì khả năng hoạt động (operability) ngay cả khi một hoặc một số thành phần bị lỗi. Do đó, để đánh giá độ tin cậy của các hệ thống phức tạp, một tập hợp các đặc tính khác được sử dụng.

**Khả dụng (Availability)**

**Khả dụng (availability)** có nghĩa là tỷ lệ thời gian mà hệ thống hoặc dịch vụ ở trạng thái hoạt động (operational).

Khả dụng là một đặc tính thống kê dài hạn, vì vậy nó được đo lường trên một khoảng thời gian dài, có thể là ngày, tháng hoặc năm. Ví dụ, đối với các thiết bị truyền thông thuộc mạng điện thoại, các thiết bị tốt nhất đạt được khả dụng được gọi là **"năm chín" (five nines)**. Điều này có nghĩa là mức khả dụng đạt 0.99999, tương ứng với việc chỉ không hoạt động trong hơn 5 phút trong một năm. Lưu ý rằng các thiết bị và dịch vụ hiện tại đang cố gắng đạt được mức **"ba chín" (three nines)**, nhưng mức **"năm chín"** vẫn là một mục tiêu cao.

Khả dụng của dịch vụ là một đặc tính mang tính chất toàn diện (universal), quan trọng cả đối với người dùng và nhà cung cấp dịch vụ.

 **Khả năng chịu lỗi (Fault Tolerance)**

Một đặc tính khác về độ tin cậy của các hệ thống phức tạp là **khả năng chịu lỗi (fault tolerance)**, nghĩa là khả năng của hệ thống che giấu hoặc hạn chế ảnh hưởng của lỗi ở một số phần tử.

**Ví dụ về khả năng chịu lỗi (Fault Tolerance Example)**

Ví dụ, nếu một bộ chuyển mạch (switch) được trang bị hai trung tâm chuyển mạch (switching centers) hoạt động song song, thì việc một trong hai trung tâm bị lỗi sẽ không dẫn đến sự ngừng hoạt động hoàn toàn của bộ chuyển mạch. Tuy nhiên, hiệu suất (performance) của bộ chuyển mạch sẽ giảm, và nó sẽ xử lý các gói tin (packets) chậm hơn gấp đôi. Trong các hệ thống chịu lỗi (fault-tolerant systems), lỗi của một trong các phần tử dẫn đến việc giảm chất lượng hoạt động (quality degradation) chứ không phải là dừng hoàn toàn. Một ví dụ khác là việc sử dụng hai kênh vật lý (physical channels) để kết nối bộ chuyển mạch. Trong chế độ hoạt động bình thường, lưu lượng (traffic) được truyền qua hai kênh với tốc độ 6 Mbit/s. Khi một trong hai kênh bị lỗi, lưu lượng sẽ được truyền qua kênh còn lại với tốc độ 3 Mbit/s. Tuy nhiên, ngay cả với tình huống này, trong nhiều trường hợp, việc xác định mức độ suy giảm (degradation) của hệ thống hoặc dịch vụ một cách định lượng là khá khó khăn. Do đó, khả năng chịu lỗi thường được sử dụng như một đặc tính định tính (qualitative characteristic).


#### 5.3 Đặc tính mạng của nhà cung cấp dịch vụ (Network Characteristics of Service Providers)

Hãy xem xét các đặc tính chính mà nhà cung cấp dịch vụ (service provider) sử dụng để đánh giá hiệu quả mạng (network efficiency) của họ. Các đặc tính này – **khả năng mở rộng (expandability)**, **khả năng mở rộng quy mô (scalability)**, **tính quản lý (manageability)**, và **tính tương thích (compatibility)** – là các đặc tính định tính (qualitative), tức là chúng không thể được biểu thị bằng các con số hoặc tỷ lệ.

 **Khả năng mở rộng (Expandability)**

Thuật ngữ **"khả năng mở rộng" (expandability)** và **"khả năng mở rộng quy mô" (scalability)** đôi khi được sử dụng như các từ đồng nghĩa, nhưng điều này không chính xác. Sự khác biệt về ý nghĩa chủ yếu được thể hiện như sau:

> **Khả năng mở rộng (expandability)** có nghĩa là khả năng bổ sung thêm các thành phần riêng lẻ vào mạng (users, computers, applications, services), mở rộng độ dài của các phân đoạn cáp (cable segments), và thay thế các thiết bị hiện có bằng các thiết bị mạnh hơn.

Điều quan trọng là khả năng mở rộng hệ thống phải nằm trong các giới hạn nhất định. Ví dụ, mạng cục bộ Ethernet được xây dựng trên cơ sở một phân đoạn cáp đồng trục chia sẻ (shared coaxial cable segment) có khả năng mở rộng hạn chế, nghĩa là có thể kết nối thêm các trạm (stations). Tuy nhiên, mạng này có một giới hạn về số lượng trạm (stations) không vượt quá 30–40. Mặc dù có thể kết nối thêm các phân đoạn cáp (segments) và tăng số lượng trạm lên đáng kể (ví dụ, đến 100), hiệu suất (performance) của mạng sẽ giảm mạnh. Sự hiện diện của các giới hạn như vậy là một dấu hiệu của khả năng mở rộng kém (poor expandability).

 **Khả năng mở rộng quy mô (Scalability)**

> **Khả năng mở rộng quy mô (scalability)** có nghĩa là mạng có khả năng tăng số lượng nút (nodes) và độ dài của các liên kết (connections) trong phạm vi rất rộng mà không làm giảm hiệu suất mạng (network performance).

Để đảm bảo khả năng mở rộng (scalability) của mạng, cần phải sử dụng thêm các thiết bị truyền thông (communication equipment) và cấu trúc hóa mạng theo một cách đặc biệt. Thông thường, giải pháp mở rộng (scalable solution) có cấu trúc phân cấp đa tầng (multi-level hierarchical structure), cho phép thêm các thành phần vào từng cấp độ trong hệ thống mà không làm thay đổi ý tưởng chính của dự án. Ví dụ điển hình về mạng có khả năng mở rộng là Internet, công nghệ của nó (TCP/IP) đã chứng minh khả năng hỗ trợ mạng trên quy mô toàn cầu, tức là ở cấp độ hành tinh.

Không chỉ bản thân mạng cần có tính mở rộng, mà cả các thiết bị (devices) trong mạng trục (backbone network) cũng cần phải có đặc tính này, vì sự phát triển của mạng không nên yêu cầu thay thế thiết bị liên tục. Do đó, các bộ chuyển mạch (switches) trong mạng trục thường được xây dựng theo nguyên tắc mô-đun (modular principle), cho phép tăng số lượng giao diện (interfaces) và khả năng xử lý gói tin (packet processing) trong phạm vi rộng.

**Quản lý mạng (Network Management)** bao gồm khả năng tập trung hóa (centralization) để giám sát trạng thái (monitoring) của các thành phần chính của mạng, phát hiện và giải quyết các vấn đề phát sinh trong quá trình hoạt động của mạng, phân tích hiệu suất (performance analysis) và lập kế hoạch phát triển (planning) mạng. Việc quản lý yêu cầu có sự tích hợp một số công cụ tự động hóa (automation tools) như hệ thống quản trị (administration system), tương tác với phần mềm và phần cứng thông qua các giao thức truyền thông (communication protocols). 

Một trong các chức năng chính của hệ thống quản trị là **giám sát (monitoring)** và **kiểm soát (control)** từng phần của mạng. Hệ thống có thể kích hoạt các hành động cụ thể, ví dụ: gửi thông báo (notifications) và cảnh báo (alerts) cho người quản trị về các vấn đề phát sinh. Một hệ thống quản trị tốt phải tích lũy dữ liệu (data accumulation), trên cơ sở đó có thể lập kế hoạch phát triển (development planning) mạng. Cuối cùng, hệ thống quản trị phải độc lập với nhà sản xuất (vendor-independent) và có giao diện thân thiện (user-friendly interface), cho phép thực hiện tất cả các tác vụ từ một bảng điều khiển duy nhất (single console).

Việc giải quyết các vấn đề tác vụ hàng ngày của người quản trị và nhân viên kỹ thuật (technical staff) liên quan đến duy trì hoạt động của mạng đòi hỏi phải có các giải pháp kịp thời. Nhân viên quản trị mạng phải nhanh chóng phản hồi các yêu cầu từ người dùng (users) hoặc xử lý các sự cố (incidents), bao gồm cả việc triển khai các công cụ tự động hóa quản trị (administration automation tools). Dần dần, các vấn đề phức tạp hơn trở nên rõ ràng, chẳng hạn như về hiệu suất (performance), cấu hình (configuration), xử lý lỗi (fault handling), và bảo mật dữ liệu (data security), đòi hỏi một cách tiếp cận chiến lược, tức là việc **lập kế hoạch mạng (network planning)**.

Lập kế hoạch không chỉ bao gồm dự báo (forecasting) các yêu cầu của người dùng đối với mạng mà còn cả khả năng thích ứng (adaptability) với các công nghệ mạng mới (new networking technologies). 

Hệ thống quản trị đặc biệt quan trọng trong các mạng lớn (corporate or public global networks). Không có hệ thống quản trị, việc vận hành các mạng như vậy sẽ yêu cầu một đội ngũ lớn các nhân viên hỗ trợ (support staff). Tuy nhiên, hiện nay, hầu hết các công cụ quản trị hiện đại chỉ cung cấp chức năng **giám sát (monitoring)** và **ghi nhận (logging)** các sự kiện, thay vì xử lý chủ động (active handling). Hiếm khi các hệ thống quản trị thực hiện các hành động tự động, giúp giảm thiểu hậu quả của các sự cố không mong muốn.

**Tính tương thích (compatibility)** hay **tính tích hợp (integration)** của mạng có nghĩa là khả năng tích hợp các phần mềm và phần cứng đa dạng từ các nhà sản xuất khác nhau (multi-vendor software and hardware). Điều này cho phép mạng hỗ trợ các giao thức khác nhau (protocols), cũng như các thiết bị phần cứng của nhiều nhà cung cấp. Cách tốt nhất để xây dựng các mạng tích hợp là sử dụng các mô-đun (modules) tuân thủ các tiêu chuẩn và thông số kỹ thuật mở (open standards and specifications).

---

#### 5.4 Ứng dụng và chất lượng dịch vụ

Do các ứng dụng hiện có thường đưa ra những yêu cầu khác nhau về chất lượng dịch vụ (QoS - Quality of Service), nhiệm vụ quan trọng là phân loại chúng theo khía cạnh này.  
Các tiêu chí phân loại sẽ sử dụng các đặc điểm sau của ứng dụng:  
- **Mức độ đồng đều của lưu lượng mà ứng dụng sinh ra;**  
- **Độ nhạy của ứng dụng với độ trễ của gói tin (packet delay);**  
- **Độ nhạy của ứng dụng với mất mát (packet loss) và méo mó gói tin (packet distortion).**

---

##### 5.4.1 Mức độ đồng đều của lưu lượng sinh ra

Về mức độ đồng đều của lưu lượng sinh ra, các ứng dụng được chia thành hai loại:  
- **Ứng dụng với lưu lượng dòng (stream traffic);**  
- **Ứng dụng với lưu lượng xung (burst traffic).**

**Ứng dụng với lưu lượng dòng**

Các ứng dụng với lưu lượng dòng (stream traffic) tạo ra một dòng dữ liệu đồng đều, được truyền vào mạng với **tốc độ bít không đổi (Constant Bit Rate, CBR)**.  
Trong trường hợp chuyển mạch gói (packet switching), lưu lượng của ứng dụng là một chuỗi các gói dữ liệu có kích thước bằng nhau (**B bit**) và được truyền đi cách đều nhau bởi một khoảng thời gian **T (xem Hình 5.9, a)**. 

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.9.png" alt ="Hình 5.9. Lưu lượng dạng dòng (a) và lưu lượng dạng xung (b)." width="900">
</p>
<p align="center"><b>Hình 5.9. Lưu lượng dạng dòng (a) và lưu lượng dạng xung (b).</b></p>

**CBR (lưu lượng dòng)** có thể được tính bằng cách lấy trung bình trên một khoảng thời gian:  

$$
CBR = \frac{B}{T} \text{ (bit/s)}  
$$

**Ứng dụng với lưu lượng xung**

Ứng dụng với lưu lượng xung (**burst traffic**) đặc trưng bởi mức độ không đồng đều cao. Trong các ứng dụng này, các khoảng thời gian im lặng được xen kẽ với các khoảng thời gian lưu lượng dữ liệu được truyền đi với mật độ cao, trong đó các gói tin "sát nhau". Do đó, lưu lượng này được đặc trưng bởi **tốc độ bít thay đổi (Variable Bit Rate, VBR)**, minh họa trong Hình 5.9, b.  

Ví dụ: khi ứng dụng dịch vụ tệp (file service) hoạt động, cường độ lưu lượng do ứng dụng tạo ra có thể giảm xuống 0 khi không có tệp nào được truyền. Ngược lại, cường độ này có thể tăng lên đến mức tối đa khả dụng của mạng khi tệp được máy chủ truyền đi.

Hình minh họa ví dụ khi:  
- Trong khoảng thời gian **5T**, 3 gói dữ liệu (có kích thước bằng nhau **B**) được truyền đi;  
- Sau đó, trong khoảng **T**, truyền thêm 5 gói;  
- Trong khoảng thời gian **6T − 2**, chỉ có 2 gói được truyền.

**Tốc độ đỉnh của lưu lượng (Peak Information Rate, PIR)** là tốc độ trong khoảng thứ hai, khi 5 gói được truyền trong thời gian **T**, do đó: 

$$
PIR = \frac{5B}{T}
$$  

**Tốc độ trung bình (Sustained Information Rate, SIR)** cho toàn bộ thời gian quan sát là:  

$$
SIR = \frac{10B}{12T} = \frac{5B}{6T}
$$ 

Hệ số xung (**burstiness coefficient**) có thể được tính từ tỷ lệ giữa **PIR** và **SIR**. Với ví dụ trên, hệ số xung là:  

$$
\text{Hệ số xung} = \frac{PIR}{SIR} = \frac{\frac{5B}{T}}{\frac{5B}{6T}} = 6
$$

Hầu như tất cả các loại lưu lượng, ngay cả lưu lượng dòng (stream traffic), đều có hệ số xung khác 0. Tuy nhiên, giá trị hệ số này khác biệt đáng kể giữa các loại lưu lượng dòng và lưu lượng xung.  
- Ứng dụng với lưu lượng xung thường có hệ số nằm trong khoảng **2–100**.  
- Lưu lượng dòng thường có hệ số gần **1**.

Trong các mạng thực tế, hệ số xung thường cao hơn ở các mạng nhỏ hơn, bởi vì mạng lõi toàn cầu thường truyền lưu lượng tổng hợp từ nhiều nguồn, theo định luật số lớn, làm giảm đáng kể sự biến thiên của lưu lượng.

---

##### 5.4.2 Độ nhạy của ứng dụng với độ trễ gói tin

Một tiêu chí phân loại khác của ứng dụng là **độ nhạy của chúng với độ trễ của gói tin (packet delay)** và các biến thể của độ trễ. Dưới đây là các loại ứng dụng được liệt kê theo mức độ nhạy tăng dần với độ trễ:

1. **Ứng dụng không đồng bộ (asynchronous applications)**  
   - Gần như không bị giới hạn bởi độ trễ (còn gọi là **lưu lượng đàn hồi - elastic traffic**).  
   - Ví dụ: **thư điện tử (email)**.

2. **Ứng dụng tương tác (interactive applications)**  
   - Độ trễ có thể được người dùng nhận thấy nhưng không ảnh hưởng nghiêm trọng đến chức năng của ứng dụng.  
   - Ví dụ: **trình soạn thảo văn bản hoạt động với tệp từ xa**.

3. **Ứng dụng thời gian thực (isochronous applications)**  
   - Có mức độ nhạy cao với biến thể của độ trễ. Nếu vượt qua một ngưỡng nhất định, chức năng của ứng dụng sẽ bị suy giảm nghiêm trọng.  
   - Ví dụ: **truyền giọng nói**, khi độ trễ vượt quá 100–150 ms, âm thanh sẽ bị méo và giọng nói trở nên khó nghe.

4. **Ứng dụng siêu nhạy với độ trễ (ultra-sensitive applications)**  
   - Với những ứng dụng này, độ trễ trong việc truyền dữ liệu có thể làm cho chúng mất toàn bộ chức năng.  
   - Ví dụ: **ứng dụng điều khiển các thiết bị kỹ thuật trong thời gian thực (real-time)**.  
   - Nếu tín hiệu điều khiển bị chậm trễ, sự cố nghiêm trọng có thể xảy ra tại đối tượng điều khiển.

**Tính tương tác (interactivity)** của ứng dụng luôn làm tăng độ nhạy với độ trễ.  
- Ví dụ: **phát thanh quảng bá (broadcasting)** có thể chịu được độ trễ đáng kể khi truyền gói tin (dù vẫn nhạy với biến thể của độ trễ).  
- Nhưng các cuộc hội thoại **điện thoại hoặc truyền hình tương tác** thì không thể chịu được độ trễ lớn. Điều này đặc biệt rõ khi cuộc hội thoại được truyền qua vệ tinh: những khoảng tạm dừng dài trong hội thoại gây nhầm lẫn cho đối phương, khiến họ thường mất kiên nhẫn và bắt đầu nói chồng lên nhau.

Ngoài cách phân loại này, một cách khác để phân biệt độ nhạy với độ trễ của ứng dụng là chia chúng thành **ứng dụng không đồng bộ (asynchronous)** và **ứng dụng đồng bộ (synchronous)**:  
- **Ứng dụng không đồng bộ:** ít nhạy cảm với độ trễ, thường có thể hoạt động trên các khoảng thời gian truyền tải rộng.  
- **Ứng dụng đồng bộ:** yêu cầu mức độ đồng bộ chính xác hơn, có độ nhạy cao với độ trễ, ví dụ như truyền âm thanh hoặc video thời gian thực.

---

##### 5.4.3 Độ nhạy cảm của ứng dụng đối với mất mát và biến dạng gói tin (packet loss and distortion)

Và cuối cùng, tiêu chí phân loại ứng dụng là độ nhạy cảm của chúng đối với mất mát gói tin (packet loss). Trong ngữ cảnh này, các ứng dụng thường được chia thành hai nhóm:

1. **Ứng dụng nhạy cảm với mất mát dữ liệu (data loss-sensitive applications).**  
   Hầu như tất cả các ứng dụng truyền tải dữ liệu chữ và số (alphabetic-numeric data), chẳng hạn như tài liệu văn bản (text documents), mã chương trình (program code), mảng số (numeric arrays), v.v., đều có độ nhạy cảm cao với việc mất mát các phần dữ liệu (data fragments), dù là rất nhỏ. Loại mất mát này thường dẫn đến việc không thể xử lý hoặc sử dụng thông tin đã nhận. Ví dụ, việc thiếu một byte dữ liệu (byte) trong chương trình có thể khiến chương trình không thể hoạt động (inoperable). Tất cả các ứng dụng mạng truyền thống (traditional network applications) như dịch vụ tệp tin (file service), cơ sở dữ liệu (database), email, v.v., đều thuộc loại này.

2. **Ứng dụng chống chịu với mất mát dữ liệu (data loss-resilient applications).**  
   Nhóm này bao gồm nhiều ứng dụng truyền tải lưu lượng chứa thông tin về các quá trình vật lý nội tại (inherent physical processes). Khả năng chống chịu với mất mát dữ liệu được giải thích bởi việc một lượng nhỏ dữ liệu bị mất có thể không ảnh hưởng đáng kể đến mục tiêu của ứng dụng. Ví dụ, khi mất một gói tin (packet), một số mẫu âm thanh liên tiếp (sequential audio samples) trong dữ liệu âm thanh số hóa (digitized audio data) có thể được thay thế bằng các giá trị trung bình (average values). Phần lớn các ứng dụng làm việc với lưu lượng đa phương tiện (multimedia traffic) (âm thanh - audio và video - video) thuộc nhóm này. Độ nhạy cảm với mất mát dữ liệu của chúng thường thấp hơn đáng kể so với các ứng dụng thuộc nhóm đầu tiên. Cần lưu ý rằng bất kỳ ứng dụng đa phương tiện nào cũng có thể đặt ra ngưỡng về tỷ lệ mất gói tin không được vượt quá (packet loss rate threshold), ví dụ, không quá 1%. Cũng cần chú ý rằng các ứng dụng âm thanh và video nén (compressed audio and video applications) thuộc nhóm nhạy cảm với mất mát dữ liệu nhiều hơn và được xếp vào loại đầu tiên.  

---

#### 5.5 Phương pháp đảm bảo chất lượng dịch vụ (Quality of Service - QoS)

Các phương pháp đảm bảo chất lượng dịch vụ (Quality of Service, viết tắt là QoS) hiện nay đóng vai trò quan trọng trong lĩnh vực công nghệ mạng chuyển mạch gói (packet-switched networks), vì chúng đảm bảo hoạt động ổn định của các ứng dụng đa phương tiện hiện đại (multimedia applications) như VoIP (IP-telephony), video và phát thanh qua mạng (video and radio broadcasting), học từ xa tương tác (interactive distance learning), v.v.

Trong các phương pháp QoS, nhiều cơ chế khác nhau được sử dụng để giảm tác động tiêu cực của tình trạng tắc nghẽn tạm thời (temporary congestion) xảy ra trong mạng chuyển mạch gói. Các cơ chế này được chia thành:  

1. **Cơ chế quản lý tắc nghẽn (congestion management):**  
   Các cơ chế này bắt đầu hoạt động khi đã xảy ra tắc nghẽn; chúng bao gồm quản lý hàng đợi (queue management).

2. **Cơ chế ngăn chặn tắc nghẽn (congestion avoidance):**  
   Như tên gọi, các cơ chế này tập trung vào việc áp dụng biện pháp ngăn ngừa tắc nghẽn trước khi nó xảy ra. Chúng bao gồm điều hòa lưu lượng (traffic conditioning), phân bổ băng thông (bandwidth allocation), dự trữ tài nguyên (resource reservation) và kỹ thuật quản lý lưu lượng (traffic engineering).

Hàng đợi (queue) là thuộc tính không thể thiếu của các mạng chuyển mạch gói. Nguyên tắc hoạt động của mạng kiểu này bao gồm việc sử dụng bộ đệm (buffer) tại các giao diện đầu vào và đầu ra (input and output interfaces) của các thiết bị chuyển mạch (switching devices). Quá trình đệm gói tin (packet buffering) trong các tình huống tắc nghẽn là cơ chế chính, đảm bảo hiệu suất cao (high performance) cho mạng thuộc loại này.

Tuy nhiên, hàng đợi cũng gây ra việc giảm chất lượng dịch vụ (quality of service degradation) do độ trễ (delay) và mất mát gói tin (packet loss) trong quá trình truyền dữ liệu, đặc biệt khi hàng đợi trong bộ đệm của bộ định tuyến (router buffer) hoặc bộ chuyển mạch (switch buffer) bị đầy.

Do đó, các nhà cung cấp mạng chuyển mạch gói rất quan tâm đến việc điều chỉnh lưu lượng (traffic control) để đạt được sự cân bằng (trade-off) giữa tải cao (high load) và yêu cầu về chất lượng dịch vụ từ phía khách hàng.

Trong các phương pháp QoS, một loạt cơ chế được sử dụng để giảm thiểu các tác động tiêu cực của việc các gói tin bị trì hoãn (packet delay) trong hàng đợi, đồng thời vẫn đảm bảo các đặc điểm tích cực của hàng đợi. Phần lớn các cơ chế này tính đến sự tồn tại của các loại lưu lượng (traffic types) khác nhau, mỗi loại có yêu cầu riêng về đặc điểm kỹ thuật (technical characteristics) và độ tin cậy (reliability). Tuy nhiên, việc đạt được sự tuân thủ tạm thời (temporary compliance) với **tất cả** các đặc tính QoS cho **tất cả** các loại lưu lượng là rất khó.

Một trong những yếu tố quan trọng nhất ảnh hưởng đến các đặc tính QoS là mức độ sử dụng khả năng truyền tải (link utilization level), hay gọi là khả năng thông lượng của mạng (network throughput). Nhắc lại, khả năng thông lượng (throughput capacity) là thông số đặc trưng cho băng thông của kênh, tức là tốc độ tối đa có thể truyền dữ liệu (maximum transmission speed).

Khả năng thông lượng của mạng có thể thay đổi, nhưng không dễ dàng, vì nó phụ thuộc vào khả năng nâng cấp nhanh chóng của thiết bị mạng (networking equipment). Việc tăng thông lượng mạng là một quá trình tốn kém (costly operation), thường đi kèm với việc thay thế các thiết bị hiện có (existing equipment), điều này diễn ra không thường xuyên (vài năm một lần).

Nếu mức độ sử dụng khả năng truyền tải (link utilization level) của mạng luôn ở mức đủ thấp, thì hầu hết lưu lượng (traffic) của các ứng dụng sẽ được xử lý với chất lượng cao (high quality).  

Tuy nhiên, những tình huống tắc nghẽn mạng tạm thời (short-term network congestion), dẫn đến độ trễ (delay) và mất gói tin (packet loss), vẫn có thể xảy ra, dù tần suất rất thấp. Trạng thái mạng như vậy được gọi là "mạng không tải" (underloaded network) hoặc dùng thuật ngữ "mạng với khả năng truyền tải dư thừa" (network with overprovisioning). Việc duy trì tất cả các phần của mạng trong trạng thái không tải rất tốn kém, đặc biệt đối với các thành phần quan trọng nhất của mạng, chẳng hạn như các liên kết đường trục (backbone links). Cách tiếp cận này liên quan đến việc giám sát liên tục mức độ tải (load) của các liên kết đường trục và nâng cấp thiết bị với khả năng truyền tải cao hơn khi tải mạng gần đạt mức nguy hiểm. Tuy nhiên, các phương pháp QoS dựa trên một cách tiếp cận khác.  

> **Ý tưởng chính của tất cả các phương pháp hỗ trợ QoS** là đảm bảo tổng năng lực của mỗi tài nguyên (resource) được phân bổ giữa các loại lưu lượng (traffic classes) một cách phân biệt (differentiated), có xét đến các yêu cầu cụ thể của các ứng dụng thuộc các lớp khác nhau.  

Rõ ràng rằng những phương pháp này làm phức tạp thêm các thiết bị mạng, vì chúng cần "biết" các yêu cầu của từng loại lưu lượng, cũng như khả năng phân bổ khả năng truyền tải (capacity allocation) giữa chúng. Tính năng này thường được thực hiện bằng cách sử dụng nhiều hàng đợi (queues) cho mỗi giao diện đầu ra (output interface) của thiết bị mạng, thay vì chỉ một hàng đợi. Đồng thời, các thuật toán quản lý hàng đợi (queue management algorithms) được sử dụng để phân biệt việc xử lý lưu lượng của các lớp khác nhau. Do đó, các phương pháp QoS thường liên quan đến kỹ thuật quản lý hàng đợi (queue management techniques).  

Ngoài việc tổ chức hàng đợi, các phương pháp QoS còn bao gồm các phương pháp kiểm soát luồng (traffic flow control), nhằm đảm bảo rằng các lưu lượng mạng được xử lý phù hợp với một tập hợp các ràng buộc (constraints) đã định. Nhóm phương pháp này được gọi là các phương pháp điều hòa lưu lượng (traffic conditioning methods).  

Một vai trò đặc biệt thuộc về các phương pháp phản hồi ngược (feedback methods), được thiết kế để thông báo cho nguồn phát lưu lượng (traffic source) về tình trạng tắc nghẽn trong mạng. Các phương pháp này đảm bảo rằng nguồn phát giảm tốc độ gửi các gói tin (packet transmission rate) vào mạng, qua đó loại bỏ tắc nghẽn.  

Các phương pháp QoS hiện đại áp dụng các kỹ thuật kỹ thuật lưu lượng tiên tiến (advanced traffic engineering), trong đó các tuyến truyền dữ liệu (data transmission paths) được điều chỉnh động (dynamically adjusted) để giảm thiểu tải trên các đoạn mạng đang bị quá tải. Điều này giúp tối ưu hóa việc sử dụng tài nguyên mạng (network resource utilization) và cải thiện chất lượng dịch vụ ngay cả trong điều kiện tải nặng.  

---

#### 5.6 Quản lý hàng đợi (Queue Management)

Người dùng đưa ra các yêu cầu về chất lượng dịch vụ (QoS - Quality of Service) dưới dạng các giá trị giới hạn của các đặc tính QoS, mà không được vượt quá. Ví dụ, họ có thể yêu cầu rằng giá trị giới hạn của độ biến thiên độ trễ gói (packet delay variation) không được vượt quá 50 ms với xác suất 0,99. Nhưng làm thế nào để đảm bảo hệ thống xử lý được yêu cầu này? Những biện pháp nào cần được thực hiện để độ biến thiên độ trễ thực sự không vượt quá giá trị này? Để hiểu cơ chế hỗ trợ QoS, điều quan trọng là phải nghiên cứu quá trình hình thành hàng đợi trong các thiết bị mạng (network devices). Trong Chương 3 (phần "Bộ đệm hóa gói" - Packet Buffering), chúng ta đã thảo luận một số nguyên nhân hình thành hàng đợi trong các thiết bị chuyển mạch (switching devices).

Hãy xem xét lại Hình 3.8, trong đó minh họa sơ đồ đơn giản nhất của bộ định tuyến (router). Thành phần trung tâm của thiết bị chuyển mạch là khối chuyển mạch (switching block), nơi truyền dữ liệu giữa ba giao diện mạng (network interfaces) của nó. Nếu cường độ của các luồng đầu vào (input flows) và hiệu suất của khối chuyển mạch như vậy mà khối này không thể xử lý tất cả các gói đầu vào, thì các gói dư thừa được lưu giữ trong hàng đợi đầu vào (input queue) hoặc bộ đệm (buffer) để chờ xử lý. Khi khối chuyển mạch giải phóng, một khối đặc biệt của bộ chuyển mạch - trình sắp xếp hàng đợi (arbiter of queues) (không được hiển thị trong hình) - theo một quy tắc xác định, chọn một gói từ hàng đợi và chuyển nó đến khối chuyển mạch để xử lý. Quy tắc này có thể là, ví dụ, FIFO ("First In, First Out" - "Vào trước, ra trước") hoặc một thuật toán phức tạp hơn có tính đến các ưu tiên (priorities).

Các gói đi qua khối chuyển mạch được hướng đến một trong các giao diện đầu ra (output interfaces). Do tính ngẫu nhiên của các khoảng thời gian giữa các gói trong luồng và khả năng truyền tải hạn chế của các giao diện đầu ra, có thể xảy ra tình trạng tắc nghẽn (congestion), khi một luồng dữ liệu đầu ra bùng nổ. Khi đó, gói tin sẽ không được giao diện đầu ra chấp nhận để truyền. Do đó, cần thiết lập một bộ đệm trước mỗi giao diện đầu ra - hàng đợi đầu ra (output queue) - để lưu trữ các gói trong thời gian tắc nghẽn. Các gói được chọn từ hàng đợi đầu ra và được truyền đến luồng liên quan của giao diện đầu ra của bộ chuyển mạch theo quy tắc mà trình sắp xếp hàng đợi đầu ra (arbiter of output queues) tuân thủ.

Kích thước bộ đệm (buffer size) của thiết bị phải được đặt để đảm bảo chiều dài tối đa của hàng đợi đang chờ không vượt quá một giá trị xác định. Nếu gói đến khi bộ đệm đầy, nó sẽ đơn giản bị loại bỏ.

---

##### 5.6.1 Phân tích hàng đợi (Queue Analysis)

Có một nhánh của toán học ứng dụng, đối tượng của nó là các quá trình hình thành hàng đợi (queue formation). Ngành khoa học này được gọi là **lý thuyết hàng đợi (queue theory)**. Chúng ta sẽ không đi sâu vào các cơ sở toán học của lý thuyết này mà chỉ tập trung vào một số kết luận quan trọng đối với vấn đề QoS (Quality of Service) mà chúng ta đang xem xét.

Lý thuyết hàng đợi xem xét các quá trình hình thành hàng đợi trong bộ đệm (buffer) của một thiết bị trừu tượng, nơi mà một luồng ngẫu nhiên các yêu cầu (requests) đến để được xử lý. Các mô hình lý thuyết hàng đợi cho phép ước lượng độ dài trung bình của hàng đợi (average queue length) và thời gian chờ trung bình của các yêu cầu trong hàng đợi (average waiting time), dựa trên đặc tính của luồng đầu vào (input flow) và thời gian xử lý (processing time).

Khi áp dụng lý thuyết hàng đợi vào phân tích các quá trình xảy ra trong các thiết bị tính toán, các yêu cầu để được xử lý thường đại diện cho dữ liệu hoặc gói tin (packets), và các thiết bị xử lý là các **thiết bị mạng** - như các chương trình phần mềm (software programs), thiết bị mạng (network devices) hoặc các giao diện đầu ra (output interfaces). Hình 5.10 minh họa mô hình của một trong các giao diện đầu ra của bộ chuyển mạch (switch).

Luồng yêu cầu đầu vào (input request flow) hiển thị trong Hình 5.10 tương ứng với luồng các gói tin giữa khối chuyển mạch (switching block) và một trong các giao diện đầu ra (output interface) của bộ chuyển mạch, như đã được mô tả trong Hình 3.8. Luồng này được đặc trưng bởi **cường độ trung bình** (average intensity) λ (lambda), tức là khoảng thời gian trung bình giữa các yêu cầu bằng $$T = 1 / \lambda$$. **Cường độ xử lý trung bình** (average processing intensity) của luồng yêu cầu được xử lý bởi thiết bị xử lý là $$μ = 1 / b$$, trong đó $$b$$ là thời gian trung bình để xử lý một yêu cầu.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.10.png" alt ="Hình 5.10. Mô hình giao diện đầu ra của bộ chuyển mạch như một tài nguyên chia sẻ." width="900">
</p>
<p align="center"><b>Hình 5.10. Mô hình giao diện đầu ra của bộ chuyển mạch như một tài nguyên chia sẻ.</b></p>

> **Hệ số tải (utilization factor)**, ký hiệu là $$ρ$$, là một trong các yếu tố quan trọng trong mô hình. Nó bằng tỷ lệ giữa cường độ trung bình $$λ$$ của yêu cầu đến và cường độ xử lý trung bình $$μ$$, cụ thể là $$ρ = λ / μ$$.

Trong lý thuyết phục vụ hàng loạt (mass-service theory), một số loại mô hình cho phép xác định các phụ thuộc phân tích, chẳng hạn thời gian chờ trung bình $$W$$ trong hàng đợi, phụ thuộc vào hệ số tải $$ρ$$. Một trong những phụ thuộc này, mô tả hệ thống với hàng đợi đơn (single queue) theo nguyên tắc FIFO (First In, First Out - Vào trước, Ra trước), được thể hiện trong Hình 5.11.

Từ đồ thị, có thể thấy rằng hệ số tải $$ρ$$ đóng vai trò quan trọng trong việc hình thành hàng đợi. Nếu $$ρ$$ gần bằng 0, thời gian chờ trung bình trong hàng đợi rất gần bằng 0. Điều này có nghĩa là các gói gần như không bao giờ phải chờ xử lý trong bộ đệm (buffer). Ngược lại, khi $$ρ$$ tăng gần đến 1, thời gian chờ tăng rất mạnh và tiến đến vô hạn. Sự phụ thuộc này có ý nghĩa trực quan, vì khi khoảng cách giữa các yêu cầu đầu vào nhỏ hơn thời gian xử lý chúng, thiết bị xử lý không thể đáp ứng tải (overload).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.11.png" alt ="Hình 5.11. Mối quan hệ giữa thời gian chờ trung bình của yêu cầu và hệ số tải của tài nguyên." width="900">
</p>
<p align="center"><b>Hình 5.11. Mối quan hệ giữa thời gian chờ trung bình của yêu cầu và hệ số tải của tài nguyên.</b></p>

Các kỹ sư mạng (**network engineers**) rất quen thuộc với loại lưu lượng được thể hiện trong hình 5.12, vì nó phản ánh hành vi của các đường cong mà họ thường thấy khi phân tích kết quả giám sát độ trễ (**latency monitoring**) và mất gói (**packet loss**) trong mạng thực tế. Cụ thể, nó minh họa sự suy giảm đáng kể chất lượng dịch vụ (**Quality of Service, QoS**) khi **hệ số sử dụng thông lượng (utilization coefficient)** của các giao diện mạng đạt đến một giá trị ngưỡng nhất định.

Biểu đồ này có một đặc điểm bất ngờ. Thật khó tưởng tượng rằng một thiết bị đang vận hành (tài nguyên mạng, **network resource**) hầu như ngừng hoạt động hiệu quả khi hệ số sử dụng của nó tiệm cận giá trị 1. Điều đáng nói là tải không vượt quá khả năng của thiết bị mà chỉ tiệm cận giá trị đó. Ngoài ra, cũng không rõ ràng về lý do tại sao hàng đợi (**queue**) xuất hiện đáng kể khi hệ số $$\rho$$ nằm xung quanh giá trị 0.5. Mặc dù lưu lượng xử lý tăng gấp đôi so với lưu lượng tải, các hàng đợi vẫn xuất hiện! Hiện tượng nghịch lý này, thoạt nhìn, là đặc trưng của các hệ thống mà trong đó các quá trình ngẫu nhiên (**random processes**) diễn ra. Vì chỉ **lưu lượng trung bình (average flow rate)** trên các khoảng thời gian lớn được xem xét, nên ở các khoảng thời gian ngắn, các giá trị có thể **đáng kể khác biệt (significantly deviate)** so với các giá trị trung bình này.

Một tham số quan trọng khác có ảnh hưởng trực tiếp đến việc hình thành hàng đợi trong mạng là **biến thiên (variation)** của các khoảng thời gian của luồng gói tin đầu vào (**incoming traffic intervals**). Tham số này phản ánh tính chất xung nhịp (**burstiness**) của luồng gói đầu vào. Hình 5.12 minh họa mối quan hệ giữa **thời gian chờ trung bình (W)** và hệ số $$\rho$$ cho các giá trị khác nhau của **hệ số biến thiên (Coefficient of Variation, CV)**.

Từ biểu đồ, có thể thấy rằng, khi luồng đầu vào ít có tính xung nhịp (CV tiến gần về 0), thì **hiệu ứng hình thành hàng đợi dạng thác lũ (avalanche queue formation)** khi hệ số tải tài nguyên tiến gần đến 1 ít xảy ra hơn. Ngược lại, khi CV càng lớn, hiệu ứng này xuất hiện sớm hơn (tại các giá trị $$\rho$$ nhỏ hơn).

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.12.png" alt ="Hình 5.12. Ảnh hưởng của mức độ dao động của lưu lượng đến độ trễ." width="900">
</p>
<p align="center"><b>Hình 5.12. Ảnh hưởng của mức độ dao động của lưu lượng đến độ trễ.</b></p>

**"Để giảm độ trễ, cần giảm cả hệ số tải tài nguyên (utilization coefficient) lẫn tính xung nhịp của luồng (burstiness of traffic)."**

Cần nhấn mạnh rằng các mô hình lý thuyết hàng đợi (**queueing theory models**) do sự đơn giản hóa các quá trình diễn ra trong các thiết bị mạng (**communication devices**) chỉ cung cấp một hình ảnh mang tính chất định tính (**qualitative picture**) về mối quan hệ giữa độ trễ (**latency**) và mất gói (**packet loss**) với các tham số lưu lượng và hiệu suất của thiết bị. Kết quả chính xác hơn có thể đạt được thông qua mô phỏng (**simulation modeling**), nhưng đáng tin cậy nhất vẫn là đo lường độ trễ và mất gói trong mạng thực tế bằng các hệ thống và thiết bị đo lường chuyên dụng (**network testers**).

---

##### 5.6.2 Hàng đợi và các loại lưu lượng khác nhau

Hãy xem cách áp dụng kiến thức về hành vi của hàng đợi dựa trên hệ số tải để thực hiện các ý tưởng cơ bản của **phương pháp QoS (Quality of Service)**, cụ thể là phân biệt dịch vụ giữa các loại lưu lượng với yêu cầu khác nhau về hiệu suất và độ tin cậy của mạng. Để đơn giản, chúng ta tạm chia tất cả các luồng thành hai loại:

1. **Nhạy cảm với độ trễ (delay-sensitive traffic):** Đây là các loại lưu lượng thời gian thực (**real-time traffic**), ví dụ: thoại qua mạng (**voice traffic**).
2. **Đàn hồi (elastic traffic):** Loại lưu lượng cho phép độ trễ lớn hơn và không nhạy cảm với mất gói (**packet loss**).

Nếu đảm bảo rằng hệ số tải tài nguyên cho lưu lượng nhạy cảm với độ trễ không vượt quá 0.2, thì rõ ràng, các hàng đợi sẽ rất nhỏ và phù hợp với hầu hết các ứng dụng thuộc loại này. Đối với lưu lượng đàn hồi, có thể cho phép hệ số tải cao hơn, ví dụ: không vượt quá 0.9. Để tránh mất dữ liệu ở loại lưu lượng này, cần cung cấp đủ bộ đệm (**buffer memory**) để lưu trữ tất cả các gói tin trong chu kỳ xung nhịp (**burst period**). Hiệu quả của việc phân bổ tải này được minh họa trong hình 5.13.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.13.png" alt ="Hình 5.13. Xử lý lưu lượng linh hoạt và nhạy cảm với độ trễ." width="900">
</p>
<p align="center"><b>Hình 5.13. Xử lý lưu lượng linh hoạt và nhạy cảm với độ trễ.</b></p>

**Độ trễ của lưu lượng nhạy cảm với độ trễ ($$w_s$$)** và độ trễ của lưu lượng đàn hồi ($$w_e$$):  

Để đạt được các hệ số sử dụng tài nguyên khác nhau cho các lớp lưu lượng khác nhau, cần phải duy trì hai hàng đợi riêng biệt cho mỗi tài nguyên tại mỗi bộ chuyển mạch (**switch**). **Thuật toán chọn gói từ hàng đợi (queue selection algorithm)** phải ưu tiên xử lý các gói tin nhạy cảm với độ trễ. Nếu các gói tin thuộc hàng đợi đầu tiên luôn được xử lý trước, thì các gói tin trong hàng đợi thứ hai chỉ được xử lý khi hàng đợi đầu tiên rỗng. Điều này dẫn đến việc lưu lượng từ hàng đợi thứ hai thực tế ngừng tồn tại.

Trong trường hợp ngược lại, nếu cường độ trung bình của lưu lượng nhạy cảm ($$\lambda_1$$) và khả năng phục vụ ($$μ$$) được duy trì ở mức hệ số tải $$\rho = 0.2$$, thì lưu lượng nhạy cảm sẽ luôn được xử lý trước. Đối với lưu lượng đàn hồi, hệ số tải $$\rho = 0.9$$, thì cần duy trì cường độ lưu lượng đàn hồi ở mức $$\lambda_2$$ sao cho tổng tải của cả hai là:

$$
\rho = \frac{\lambda_1 + \lambda_2}{μ}
$$

Nếu $$\rho = 0.9$$ và $$\lambda_1 = 0.2$$, thì tỷ lệ $$\lambda_2 / μ = 0.7$$.

Có thể phân bổ thêm trọng số giữa các lớp dịch vụ để đảm bảo rằng mỗi lớp hoạt động trên phần đường cong độ trễ tương ứng của nó. Nếu vấn đề này được giải quyết, có thể cải thiện đặc tính QoS (Quality of Service) thông qua các phương pháp khác, ví dụ như giảm tính xung nhịp (**burstiness**) của lưu lượng. Vẫn còn câu hỏi cần làm rõ là làm thế nào để đảm bảo các điều kiện tương ứng cho từng lớp lưu lượng tại mỗi nút mạng.

---

##### 5.6.3 Kỹ thuật quản lý hàng đợi (Queue Management Techniques)

Quản lý hàng đợi được sử dụng để tối ưu hóa hiệu suất của các thiết bị trong giai đoạn tắc nghẽn tạm thời (**temporary congestion**), khi chúng không thể xử lý việc truyền dữ liệu đến giao diện đầu ra (**output interface**) cùng tốc độ như lúc nhận dữ liệu đầu vào. Các thuật toán quản lý hàng đợi không ngăn chặn hoàn toàn tắc nghẽn mà chỉ phân bổ tài nguyên một cách "công bằng" trong điều kiện thiếu tài nguyên, bằng cách phân chia tài nguyên giữa các luồng dữ liệu hoặc các lớp lưu lượng khác nhau.

---

###### Hàng đợi FIFO (First In, First Out):

Trong hàng đợi FIFO, khi tắc nghẽn xảy ra, tất cả các gói tin được đưa vào **một hàng đợi duy nhất (single queue)** và được chọn xử lý theo thứ tự chúng đến (nguyên tắc "đến trước, xử lý trước"). FIFO thường được sử dụng mặc định trong các bộ chuyển mạch (**switches**) vì tính đơn giản của nó và không yêu cầu cấu hình phức tạp.

Tuy nhiên, FIFO có một nhược điểm lớn: **không thể phân biệt dịch vụ giữa các lưu lượng khác nhau (non-differentiated traffic processing)**. Ví dụ, các gói tin nhạy cảm với độ trễ như thoại qua mạng (**voice traffic**) có thể bị trễ nhiều hơn do phải xếp hàng cùng với các gói lưu lượng ít nhạy cảm hơn. Điều này có thể gây ảnh hưởng tiêu cực đến các dịch vụ thời gian thực (**real-time services**).

---

###### Dịch vụ ưu tiên (Priority Queuing)

Hàng đợi ưu tiên (**Priority Queuing, PQ**) rất phổ biến trong nhiều lĩnh vực kỹ thuật máy tính, đặc biệt trong hệ điều hành (**operating systems**) khi một ứng dụng cần được ưu tiên xử lý trước các ứng dụng khác trong môi trường đa chương trình (**multiprogramming environment**). Loại hàng đợi này cũng được sử dụng để xử lý ưu tiên cho một số lớp lưu lượng trong mạng.

Cơ chế dịch vụ ưu tiên dựa trên việc phân chia lưu lượng mạng thành một số ít lớp và gán một giá trị số — **mức độ ưu tiên (priority)** — cho mỗi lớp.

- **Ưu tiên (Priority):** Là một giá trị số biểu thị mức độ ưu tiên của một lớp lưu lượng khi sử dụng tài nguyên mạng. Cấp độ ưu tiên càng cao, thời gian gói tin của lớp đó phải chờ trong hàng đợi càng ít.

- **Phân loại lưu lượng (Traffic Classification):** Là một nhiệm vụ riêng biệt. Gói tin có thể được phân loại vào các lớp ưu tiên dựa trên nhiều tiêu chí khác nhau, chẳng hạn như:
  - **Địa chỉ đích (destination address);**
  - **Địa chỉ nguồn (source address);**
  - **Nhận dạng ứng dụng (application identifier);**
  - **Loại giao thức (protocol type).**

  Quy tắc phân loại, thường phản ánh **chính sách quản trị mạng (administrative policy)**, được thực hiện bởi các thiết bị phân loại (**classifiers**). Các thiết bị này có thể nằm ở nhiều cấp độ khác nhau trong mạng, ví dụ: tại điểm đầu vào của mạng doanh nghiệp (**corporate network**) hoặc các bộ định tuyến biên (**edge routers**) của nhà cung cấp dịch vụ.

Ưu tiên được gán vào một trường đặc biệt trong tiêu đề gói (**packet header**) để các thiết bị xử lý khác trong mạng có thể nhận biết và thực hiện xử lý phù hợp. Nếu mạng không hỗ trợ xử lý ưu tiên, các thiết bị mạng sẽ bỏ qua trường này và xử lý các gói tin theo các quy tắc mặc định của chúng.

Trong thiết bị mạng hỗ trợ hàng đợi ưu tiên, có nhiều hàng đợi khác nhau — mỗi hàng đợi dành cho một lớp ưu tiên cụ thể. Gói tin nhận được trong giai đoạn tắc nghẽn được đặt vào hàng đợi tương ứng với mức độ ưu tiên của nó. Ví dụ: trên hình 5.14, có các hàng đợi dành cho mức ưu tiên **cao (high)**, **trung bình (medium)**, **bình thường (normal)**, và **thấp (low)**.

Gói tin từ hàng đợi ưu tiên cao nhất sẽ được xử lý trước. Thiết bị chỉ chuyển sang xử lý các gói tin trong hàng đợi ưu tiên thấp hơn khi tất cả các hàng đợi ưu tiên cao hơn đã trống. Do đó, các gói tin trong hàng đợi ưu tiên thấp chỉ được xử lý khi tất cả các hàng đợi cao hơn đã rỗng hoàn toàn.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.14.png" alt ="Hình 5.14. Hàng đợi ưu tiên" width="900">
</p>
<p align="center"><b>Hình 5.14. Hàng đợi ưu tiên</b></p>

Thông thường, mặc định, các hàng đợi ưu tiên (**priority queues**) được cấp phát bộ đệm (**buffer**) có cùng kích thước, nhưng nhiều thiết bị cho phép quản trị viên mạng chỉ định kích thước bộ đệm riêng cho từng hàng đợi. Trong trường hợp lý tưởng, kích thước bộ đệm được xác định sao cho đủ chứa các hàng đợi có chiều dài trung bình với một lượng dự phòng nhất định. 

Tuy nhiên, việc xác định chính xác kích thước này rất khó. Do đó, các quản trị viên mạng thường dựa trên các nguyên tắc sau: lưu lượng càng quan trọng đối với doanh nghiệp, với cường độ (**intensity**) và tính xung nhịp (**burstiness**) càng cao, thì kích thước bộ đệm cần thiết càng lớn. Trong ví dụ minh họa trên hình 5.14, lưu lượng thuộc các lớp ưu tiên cao và trung bình được cấp bộ đệm lớn hơn, trong khi hai lớp ưu tiên còn lại nhận bộ đệm nhỏ hơn. Quyết định này rõ ràng là phù hợp cho các lớp lưu lượng ưu tiên cao và trung bình, do tính xung nhịp cao và hệ số xung nhịp (**burstiness coefficient**) đáng kể của chúng.

Dịch vụ ưu tiên (**priority service**) đảm bảo chất lượng cao cho các gói tin trong hàng đợi ưu tiên cao nhất. Nếu cường độ trung bình của các gói tin đến thấp hơn khả năng xử lý của thiết bị, thì các gói tin ưu tiên cao luôn nhận được băng thông (**bandwidth**) cần thiết. Thời gian chờ của các gói tin ưu tiên cao trong hàng đợi cũng rất ngắn. Tuy nhiên, không phải lúc nào nó cũng bằng không — mức độ xung nhịp của lưu lượng càng lớn, khả năng xuất hiện hàng đợi "cục bộ" cùng các gói tin ưu tiên cao càng cao. Lưu lượng thuộc các lớp ưu tiên khác gần như "trong suốt (**transparent**)" đối với các gói tin ưu tiên cao. Từ "gần như" ám chỉ các tình huống khi gói tin ưu tiên cao buộc phải chờ xử lý các gói tin ưu tiên thấp đã bắt đầu được xử lý.

Đối với các lớp ưu tiên khác, chất lượng dịch vụ sẽ thấp hơn so với các gói tin của lớp ưu tiên cao nhất. Mức độ giảm này có thể khác nhau đáng kể. Nếu hệ số xung nhịp (**burstiness coefficient**) của các gói tin ưu tiên cao tiệm cận đến 1, thì lưu lượng của các lớp ưu tiên thấp hơn có thể tạm dừng hoàn toàn trong một khoảng thời gian nào đó. Do đó, cần đảm bảo kích thước bộ đệm đủ lớn để duy trì lưu lượng trong lớp ưu tiên thấp hơn.

Ví dụ, đối với một lớp lưu lượng có hệ số xung nhịp không đáng kể (**low burstiness coefficient**), các dịch vụ cung cấp một kích thước bộ đệm nhỏ sẽ không ảnh hưởng nhiều đến lưu lượng đó. Chẳng hạn, việc sử dụng bộ đệm chỉ cần đủ lưu trữ từ 8–16 KB cho mỗi cổng có thể giảm thiểu tối đa tác động đến chất lượng của lưu lượng thuộc lớp này.

---

###### Hàng đợi có trọng số (Weighted Queues)

**Cơ chế hàng đợi có trọng số (Weighted Queuing Mechanism)** được phát triển để đảm bảo rằng tất cả các lớp lưu lượng (**traffic classes**) nhận được một mức tối thiểu nhất định về **băng thông (bandwidth)**. Trọng số của một lớp được hiểu là tỷ lệ băng thông được phân bổ cho lớp lưu lượng đó so với **tổng băng thông của giao diện đầu ra (total bandwidth of the output interface)**.

Trong dịch vụ hàng đợi có trọng số, cũng giống như dịch vụ ưu tiên (**priority queuing**), lưu lượng được chia thành nhiều lớp, mỗi lớp được xử lý trong một hàng đợi riêng biệt. Tuy nhiên, đối với mỗi hàng đợi, thay vì chỉ dựa vào mức ưu tiên, băng thông được phân bổ dựa trên tỷ lệ trọng số đã định trước. 

**Trọng số (Weight):** Được liên kết với một lớp lưu lượng và tỷ lệ phần trăm băng thông tài nguyên được đảm bảo cho lớp lưu lượng đó trong trường hợp tắc nghẽn tài nguyên. Trong các bộ chuyển mạch (**switches**), tài nguyên chính là khối giao tiếp (**switching fabric**) cho luồng đầu vào và giao diện đầu ra (**output interface**) cho luồng đầu ra.

Để làm rõ hơn, thuật toán quản lý hàng đợi này được minh họa trong ví dụ sau. Trong hình 5.15, năm hàng đợi được hỗ trợ trên một giao diện đầu ra của bộ chuyển mạch. Trong trường hợp tắc nghẽn, băng thông được phân bổ như sau: 10%, 10%, 30%, 20%, và 30% tổng băng thông của giao diện đầu ra.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.15.png" alt ="Hình 5.15. Hàng đợi có trọng số" width="900">
</p>
<p align="center"><b>Hình 5.15. Hàng đợi có trọng số</b></p>

Mục tiêu được đạt được thông qua việc các hàng đợi (**queues**) được xử lý tuần tự và theo chu kỳ (**cyclically**). Trong mỗi chu kỳ, từ mỗi hàng đợi, một số byte (**bytes**) được chọn tương ứng với trọng số (**weight**) của hàng đợi đó. Ví dụ, nếu chu kỳ xử lý hàng đợi trong ví dụ này là một giây, và tốc độ của giao diện đầu ra (**output interface**) là 1000 Mbps, thì trong trường hợp tắc nghẽn, mỗi chu kỳ, hàng đợi đầu tiên được cấp phát 10% thời gian, tức là 0.1 giây, tương ứng với việc chọn 100 MB dữ liệu. Tương tự, từ hàng đợi thứ hai — cũng 100 MB, từ hàng đợi thứ ba — 300 MB, từ hàng đợi thứ tư — 200 MB, và từ hàng đợi thứ năm — 300 MB.

**Kết quả:** Mỗi lớp lưu lượng (**traffic class**) nhận được **băng thông tối thiểu được đảm bảo (guaranteed minimum bandwidth)**, điều này trong nhiều trường hợp là giải pháp mong muốn hơn so với việc loại bỏ hoàn toàn các lớp ưu tiên thấp bởi các lớp ưu tiên cao.

Do dữ liệu được chọn từ hàng đợi theo gói tin (**packets**) chứ không phải bit (**bits**), nên việc phân bổ băng thông thực tế giữa các lớp lưu lượng luôn có sự khác biệt nhỏ so với kế hoạch. Ví dụ, trong trường hợp trên, thay vì 10%, lớp lưu lượng đầu tiên có thể nhận được 9% hoặc 12% trong điều kiện tắc nghẽn. Thời gian chu kỳ càng lớn, sự tuân thủ yêu cầu về tỷ lệ giữa các lớp lưu lượng càng chính xác, vì mỗi hàng đợi sẽ được chọn nhiều gói hơn, làm trung bình kích thước của từng gói.

Tuy nhiên, một chu kỳ dài cũng dẫn đến độ trễ (**delay**) lớn trong việc truyền gói tin. Với chu kỳ một giây như trong ví dụ trên, độ trễ có thể đạt tới một hoặc vài giây — bởi bộ chọn (**arbiter**) không quay lại hàng đợi thường xuyên hơn một lần mỗi giây. Do đó, tại một thời điểm, có thể chọn không quá vài gói từ mỗi hàng đợi. Vì lý do này, chu kỳ ngắn hơn sẽ đảm bảo tốt hơn sự cân bằng giữa yêu cầu băng thông và mục tiêu giảm độ trễ.

Đối với ví dụ của chúng ta, thời gian chu kỳ hợp lý hơn sẽ là từ **$$1^{-6}$$ giây** (1 microsecond) hoặc **1000 ms**. Một mặt, thời gian này đảm bảo mức độ trễ hàng đợi (queue delay) thấp hơn, vì các hàng đợi (queues) được kiểm tra thường xuyên hơn, ví dụ như mỗi chu kỳ một giây. Mặt khác, khoảng thời gian này đủ để chọn một vài gói tin (packets) từ mỗi hàng đợi, ví dụ: trong hàng đợi đầu tiên của chúng ta, sẽ cần **100 ms** để truyền dữ liệu, chẳng hạn như để truyền mười gói tin qua kênh ra (output channel) với tốc độ Gigabit Ethernet.

Mức độ trễ gói tin (packet delay) và các biến thể của một lớp lưu lượng (traffic class) cụ thể khi sử dụng cân bằng trọng số (Weighted Fair Queuing - WFQ) phụ thuộc lớn vào hệ số tải tương đối (relative load coefficient). Trong trường hợp này, hệ số này được tính bằng tỷ lệ giữa cường độ lưu lượng đầu vào (incoming traffic intensity) của một lớp lưu lượng cụ thể và năng lực xử lý (processing capacity) được cấp phát cho lớp đó tương ứng với trọng số của nó. Ví dụ, nếu giao diện có băng thông (bandwidth) **100 Mbit/s**, và một lớp cụ thể chỉ chiếm **10%**, thì cường độ lưu lượng trung bình (average traffic intensity) của nó là **10 Mbit/s**. Nếu lưu lượng đến thuộc lớp này trung bình là **30 Mbit/s**, thì hệ số tải tương đối sẽ là **30/10 = 3**. Chất lượng hành vi của hàng đợi (queue quality behavior), và do đó, độ trễ hàng đợi (queue delay), trong các hàng đợi kiểu FIFO sẽ càng thấp nếu hệ số tải thấp hơn, chiều dài hàng đợi (queue length) ngắn hơn, và độ trễ giảm đi.

Một trong những cơ chế công bằng là cân bằng công bằng trọng số (Weighted Fair Queuing - WFQ). Trong trường hợp tải đầy đủ (full load), năng lực xử lý của tài nguyên (resource processing capacity) được chia đều giữa các luồng (flows), tức là một cách "công bằng". Cân bằng công bằng trọng số chỉ đảm bảo trạng thái cân bằng trong các chu kỳ (periods) của quá tải (overload), khi tất cả các hàng đợi được lấp đầy liên tục. Nếu bất kỳ hàng đợi nào trống (idle), thì lưu lượng thuộc chu kỳ đó không bị xem xét trong thời gian cân bằng, và năng lực xử lý (processing capacity) sẽ được chia đều cho các hàng đợi còn lại theo trọng số của chúng.

---

###### Các thuật toán kết hợp trong xử lý hàng đợi

Mỗi phương pháp được mô tả đều có ưu điểm và nhược điểm riêng. Xử lý ưu tiên (priority scheduling), đảm bảo mức độ trễ tối thiểu (minimum delay) cho hàng đợi có mức ưu tiên cao nhất, nhưng không cung cấp bất kỳ sự đảm bảo nào liên quan đến thông lượng trung bình (average throughput) đối với lưu lượng của các hàng đợi có mức ưu tiên thấp hơn. Xử lý theo cân bằng trọng số (weighted scheduling) đảm bảo sự phân bổ thông lượng trung bình đã định (average throughput), nhưng không đảm bảo việc đáp ứng các yêu cầu về độ trễ (delay requirements).

Có các **thuật toán kết hợp trong xử lý hàng đợi**. Ví dụ, trong một thuật toán thuộc loại này, một hàng đợi ưu tiên (priority queue) được duy trì, trong khi các hàng đợi khác được xử lý theo một thuật toán cân bằng trọng số (weighted algorithm). Thông thường, hàng đợi ưu tiên được sử dụng để xử lý lưu lượng nhạy cảm với độ trễ (delay-sensitive traffic), trong khi các hàng đợi khác được dùng để xử lý lưu lượng co giãn (elastic traffic) của nhiều lớp. Mỗi lớp lưu lượng co giãn nhận được một lượng thông lượng tối thiểu (minimum throughput) trong các giai đoạn quá tải (overload). Lượng tối thiểu này thường được xác định như một phần của năng lực thông lượng (throughput capacity) còn lại sau khi xử lý lưu lượng ưu tiên. Rõ ràng, cần có giới hạn đối với lưu lượng ưu tiên, để nó không chiếm toàn bộ tài nguyên.

Thông thường, các cơ chế điều chỉnh lưu lượng (traffic conditioning mechanisms) được sử dụng để thực hiện điều này, và sẽ được thảo luận trong phần sau.

---

#### 5.7 Các cơ chế điều chỉnh lưu lượng (Traffic Conditioning Mechanisms)

Như chúng ta đã biết, ý tưởng chính của các phương pháp QoS (Quality of Service - Chất lượng dịch vụ) là phân bổ một phần năng lực truyền tải (bandwidth) cụ thể cho một luồng lưu lượng (traffic flow) nhất định, trong đó lượng tài nguyên được phân bổ cần đủ lớn để đảm bảo chất lượng dịch vụ của luồng lưu lượng đó ở mức thỏa đáng. Các hàng đợi (queues) với các thuật toán xử lý khác nhau chỉ thực hiện một phần ý tưởng này – chúng chỉ định một phần năng lực truyền tải cho một số luồng gói tin (packet flows) nhất định. Tuy nhiên, nếu cường độ của lưu lượng đầu vào (incoming traffic intensity) vì lý do nào đó vượt quá phần năng lực đã được phân bổ trong một số giai đoạn nhất định, ví dụ, dưới dạng các xung nhịp (burst), thì các tham số chất lượng dịch vụ được yêu cầu đối với luồng lưu lượng này (mức độ trễ, tỷ lệ mất gói, v.v.) sẽ không được đảm bảo.

Để tránh điều này, người ta khuyến nghị sử dụng các cơ chế **điều chỉnh lưu lượng (traffic conditioning)**, bao gồm:
- Phân loại (classification);
- Hồ sơ hóa (profiling);
- Làm phẳng lưu lượng (traffic smoothing).

Chúng ta đã gặp khái niệm **phân loại lưu lượng (traffic classification)** khi nghiên cứu các hàng đợi ưu tiên (priority queues) và cân bằng trọng số (weighted queues), trong đó giả định sự hiện diện của một cơ chế xác định gói tin cần được gửi vào hàng đợi này hay hàng đợi khác. Trong trường hợp điều chỉnh lưu lượng, các cơ chế phân loại lưu lượng thực hiện một nhiệm vụ lớn hơn – chúng thực hiện phân tích động các luồng lưu lượng đi qua mạng, nhằm phân loại chúng theo lớp (class). Mỗi lớp sẽ được phục vụ bởi mạng theo một cách cụ thể. Ví dụ, một lớp lưu lượng cần được phục vụ để giảm thiểu tối đa tỷ lệ mất gói (packet loss rate), một lớp khác – giảm thiểu độ trễ (delay), lớp thứ ba – giảm thiểu sự biến thiên độ trễ (jitter), và lớp thứ tư cần đảm bảo thông lượng (throughput). Để phân loại lưu lượng, người ta sử dụng các đặc điểm khác nhau của gói tin, ví dụ, địa chỉ nguồn (source address) và địa chỉ đích (destination address), giao thức tầng truyền tải (transport layer protocol) hoặc tầng ứng dụng (application layer protocol). Phân loại được thực hiện trên cơ sở các chính sách QoS.

**Hồ sơ hóa (Profiling)** là một loại tác động chủ động vào luồng lưu lượng, nhằm mục đích hạn chế các thông số của luồng gói tin. Hồ sơ hóa bao gồm việc xác định một tập hợp các thông số lưu lượng (traffic parameters), chẳng hạn như tốc độ dữ liệu trung bình (average data rate), tốc độ đỉnh (peak rate), và sự thay đổi (burstiness). Nếu các tham số này vượt quá giới hạn được chỉ định, cơ chế điều chỉnh lưu lượng sẽ thực hiện các biện pháp hạn chế, chẳng hạn như giảm tốc độ truyền tải của luồng.

Khi phần cứng mạng (network hardware) không thay đổi, tốc độ dòng gói tin (packet flow rate) chỉ có thể được giảm bằng hai cách: hoặc bắt ứng dụng nguồn (source application) giảm cường độ tạo gói tin (packet generation intensity) – **kiểm soát nguồn (source suppression)**, hoặc "định hình" luồng lưu lượng (traffic shaping). Thao tác thứ hai này có thể được thực hiện theo hai cách: hoặc **loại bỏ (discard)** một số gói tin khỏi luồng, hoặc **trì hoãn (delay)** chúng trong một thời gian trong bộ đệm (buffer). Loại bỏ gói tin và lưu giữ gói tin trong bộ đệm tạo thành bản chất của các phương pháp hồ sơ hóa (profiling) và làm phẳng lưu lượng (traffic smoothing) tương ứng, những phương pháp mà chúng ta đang xem xét ở đây (về kiểm soát nguồn, hãy tham khảo phần "Phản hồi để ngăn chặn tình trạng quá tải").

Hình 5.16 minh họa hoạt động của cơ chế hồ sơ hóa (profiling mechanism), hiển thị các giá trị tốc độ lưu lượng (traffic rate) được đo trên các khoảng thời gian đủ nhỏ trước và sau khi thực hiện hồ sơ hóa. Như minh họa trong hình, luồng lưu lượng ban đầu có các xung nhịp (bursts) với mức đỉnh cao hơn, vượt quá giới hạn cụ thể được đặt ra cho luồng đối với năng lực truyền tải (bandwidth capacity). Khi thực hiện hồ sơ hóa, một số gói tin trong các xung nhịp bị loại bỏ (discarded), dẫn đến việc duy trì tốc độ lưu lượng ở mức quy định ngay cả trong các khoảng thời gian xảy ra xung nhịp, đồng thời giữ nguyên tốc độ lưu lượng gốc ở các khoảng thời gian khác.

Lưu lượng, được điều chỉnh theo cách này, không phá vỡ các tính toán được lập kế hoạch cho tải mạng (network load). Tuy nhiên, đối với một số loại lưu lượng, việc loại bỏ gói tin có thể là vấn đề nghiêm trọng.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.16.png" alt ="Hình 5.16. Hiệu ứng phân tích - loại bỏ lưu lượng dư thừa" width="900">
</p>
<p align="center"><b>Hình 5.16. Hiệu ứng phân tích - loại bỏ lưu lượng dư thừa</b></p>

**Hồ sơ hóa (Profiling)** thường được sử dụng để hạn chế lưu lượng (traffic) đi vào hàng đợi ưu tiên (priority queue), vì chỉ bằng cách này mới có thể ngăn chặn lưu lượng ưu tiên chiếm toàn bộ tài nguyên, đẩy các lưu lượng khác ra khỏi hệ thống.

**Làm phẳng lưu lượng (Traffic Shaping)**, theo một nghĩa nào đó, tương tự với hồ sơ hóa, vì nó cũng có mục tiêu tương tự – điều chỉnh các tham số của luồng lưu lượng (traffic flow parameters) sao cho phù hợp với cấu hình tốc độ được chỉ định. Tuy nhiên, điều này đạt được theo cách khác. Thay vì loại bỏ (discard) các gói tin dư thừa, tức là các gói tin mà việc truyền tải có thể dẫn đến vượt quá giới hạn tốc độ, cơ chế làm phẳng lưu lượng sẽ **trì hoãn (delay)** các gói tin vi phạm trong một bộ đệm (buffer) đặc biệt, sao cho tốc độ luồng lưu lượng cuối cùng vẫn nằm trong giới hạn đã đặt ra.

Các gói tin cũng có thể **bị hạ cấp (downgrade)**, tức là được chuyển sang một lớp dịch vụ (service class) có mức ưu tiên thấp hơn, ví dụ, chuyển từ lớp ưu tiên (priority class) sang lớp tiêu chuẩn (standard class), nơi dịch vụ được cung cấp theo nguyên tắc "tốt nhất có thể" (best effort).

Hiệu quả của cơ chế làm phẳng lưu lượng được minh họa trong Hình 5.17. Đồ thị tốc độ làm phẳng được định hình bằng cách "cắt bớt" các đỉnh nhô ra (peaks) và lấp đầy các vùng trũng (valleys) bằng cách trì hoãn các gói tin vượt quá giới hạn tốc độ đỉnh, đồng thời chuyển chúng sang các khoảng thời gian khác, trong đó tốc độ thấp hơn mức giới hạn được đặt ra. Như có thể thấy, cơ chế này hoạt động như một phương pháp điều chỉnh lưu lượng (traffic conditioning mechanism) mềm hơn – các gói tin được trì hoãn nhưng không bị loại bỏ.

<p align="center">
  <img src="https://github.com/CHu292/SOC/blob/main/Networking/ITMO/Book_on_Networks_ITMO/img/5.17.png" alt ="Hình 5.17. Hiệu ứng làm mượt lưu lượng." width="900">
</p>
<p align="center"><b>Hình 5.17. Hiệu ứng làm mượt lưu lượng.</b></p>

Cả hồ sơ hóa (profiling) và làm phẳng lưu lượng (traffic shaping) đều loại bỏ các đỉnh tốc độ (speed peaks), **giảm tốc độ đỉnh (peak rate)** của luồng lưu lượng được điều chỉnh. Tuy nhiên, chúng có những ảnh hưởng khác nhau đến tốc độ trung bình (average rate) của luồng. Rõ ràng, do gói tin bị loại bỏ trong quá trình hồ sơ hóa, **tốc độ trung bình giảm (average rate decreases)**. Nhưng điều gì xảy ra với tốc độ trong quá trình làm phẳng lưu lượng? Vì trong trường hợp này, các gói tin tạo thành xung nhịp (burst) được giữ tạm thời trong bộ đệm (buffer) chứ không bị loại bỏ hoàn toàn khỏi luồng, nên **tốc độ trung bình không thay đổi (average rate remains unchanged)**.

Thông thường, hồ sơ hóa lưu lượng (traffic profiling) được thực hiện bởi bộ định tuyến của nhà cung cấp dịch vụ (provider router), nơi nhận lưu lượng từ mạng của người dùng. Điều này được thực hiện để bảo vệ mạng khỏi lưu lượng người dùng vượt quá các tham số (parameters) đã được thỏa thuận trong hợp đồng giữa nhà cung cấp dịch vụ và khách hàng. Hơn nữa, nếu không thực hiện hồ sơ hóa, mạng sẽ chịu tình trạng quá tải (overload), làm ảnh hưởng đến tất cả người dùng.

Làm phẳng lưu lượng (traffic shaping) được xem là nhiệm vụ của chính người dùng, và thường được thực hiện bởi bộ định tuyến biên (edge router) của người dùng, nơi gửi dữ liệu vào mạng của nhà cung cấp. Nếu cấu hình của làm phẳng lưu lượng trùng khớp với cấu hình của hồ sơ hóa, điều này đảm bảo rằng không có gói tin nào bị loại bỏ do vượt quá giới hạn.

Một thuật toán nổi tiếng được sử dụng cho cả làm phẳng lưu lượng và hồ sơ hóa là **thuật toán xô dấu (token bucket algorithm)**.

---


